{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { API } from '../../config/index';\nimport { isMobile } from '../../helpers/index';\nimport { TRAER_TODOS, TRAER_UNO, LOADING, ERROR, TRAER_PROMOCIONES, ORDENAR_PRODUCTOS, FILTRANDO, LOADING_MAS, TRAER_MAS, TRAER_OFERTAS, APLICAR_FILTRO_CATEGORIA, APLICAR_FILTRO_SUBCATEGORIA, APLICAR_FILTRO_MARCA, APLICAR_FILTRO_BUSCADOR, APLICAR_FILTRO_ORDEN, ELIMINAR_FILTRO_CATEGORIA, ELIMINAR_FILTRO_SUBCATEGORIA, ELIMINAR_FILTRO_MARCA, ELIMINAR_FILTRO_BUSCADOR, ELIMINAR_FILTRO_ORDEN, PRODUCTOS_RESTABLECER_FILTROS, PRODUCTOS_PAGINACION, PRODUCTOS_SIN_RESULTADO } from '../types/productosTypes';\nexport var traerProductos = function traerProductos() {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch, getState) {\n      var _getState$productosRe, filtrando, _getState$productosRe2, categoria, subcategoria, marca, search, orden, _getState$productosRe3, desde, limiteMobile, limiteDesktop, url;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n              _context.prev = 1;\n              //obtengo el estado actualizado de los filtros\n              _getState$productosRe = getState().productosReducer, filtrando = _getState$productosRe.filtrando, _getState$productosRe2 = _getState$productosRe.filtros, categoria = _getState$productosRe2.categoria, subcategoria = _getState$productosRe2.subcategoria, marca = _getState$productosRe2.marca, search = _getState$productosRe2.search, orden = _getState$productosRe2.orden, _getState$productosRe3 = _getState$productosRe.paginacion, desde = _getState$productosRe3.desde, limiteMobile = _getState$productosRe3.limiteMobile, limiteDesktop = _getState$productosRe3.limiteDesktop;\n              url = \"\".concat(API, \"/productos\");\n\n              if (filtrando) {\n                if (search.trim() !== \"\") {\n                  url += \"/buscar?busqueda=\".concat(search, \"&\");\n                } else {\n                  url += \"/filtro/filtrar?\";\n\n                  if (categoria) {\n                    url += \"categoria=\".concat(categoria, \"&\");\n                  }\n\n                  if (subcategoria) {\n                    url += \"subcategoria=\".concat(subcategoria, \"&\");\n                  }\n\n                  if (marca) {\n                    url += \"marca=\".concat(marca, \"&\");\n                  }\n                }\n              } else {\n                url += '?';\n              }\n\n              url += \"desde=\".concat(desde, \"&limite=\").concat(isMobile() ? limiteMobile : limiteDesktop);\n              console.log(url);\n              return _context.abrupt(\"return\", fetch(url).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                dispatch({\n                  type: TRAER_TODOS,\n                  payload: data.data\n                });\n              }));\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context.t0\n              });\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 10]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var traerMas = function traerMas() {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch, getState) {\n      var _getState$productosRe4, productos, filtrando, _getState$productosRe5, categoria, subcategoria, marca, search, orden, _getState$productosRe6, desde, limiteMobile, limiteDesktop, url;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dispatch({\n                type: LOADING_MAS\n              });\n              _context2.prev = 1;\n              //obtengo el estado actualizado de los filtros\n              _getState$productosRe4 = getState().productosReducer, productos = _getState$productosRe4.productos, filtrando = _getState$productosRe4.filtrando, _getState$productosRe5 = _getState$productosRe4.filtros, categoria = _getState$productosRe5.categoria, subcategoria = _getState$productosRe5.subcategoria, marca = _getState$productosRe5.marca, search = _getState$productosRe5.search, orden = _getState$productosRe5.orden, _getState$productosRe6 = _getState$productosRe4.paginacion, desde = _getState$productosRe6.desde, limiteMobile = _getState$productosRe6.limiteMobile, limiteDesktop = _getState$productosRe6.limiteDesktop;\n              url = \"\".concat(API, \"/productos\");\n\n              if (filtrando) {\n                if (search.trim() !== \"\") {\n                  url += \"/buscar?busqueda=\".concat(search, \"&\");\n                } else {\n                  url += \"/filtro/filtrar?\";\n\n                  if (categoria) {\n                    url += \"categoria=\".concat(categoria, \"&\");\n                  }\n\n                  if (subcategoria) {\n                    url += \"subcategoria=\".concat(subcategoria, \"&\");\n                  }\n\n                  if (marca) {\n                    url += \"marca=\".concat(marca, \"&\");\n                  }\n                }\n              } else {\n                url += '?';\n              }\n\n              url += \"desde=\".concat(desde, \"&limite=\").concat(isMobile() ? limiteMobile : limiteDesktop);\n              console.log(url);\n              return _context2.abrupt(\"return\", fetch(url).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                if (data.data.length === 0) {\n                  dispatch({\n                    type: PRODUCTOS_SIN_RESULTADO\n                  });\n                  return;\n                }\n\n                var updateproductos = [].concat(_toConsumableArray(productos), _toConsumableArray(data.data));\n                dispatch({\n                  type: TRAER_MAS,\n                  payload: updateproductos\n                });\n              }));\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context2.t0\n              });\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 10]]);\n    }));\n\n    return function (_x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var traerPorId = function traerPorId(id) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n              _context3.prev = 1;\n              return _context3.abrupt(\"return\", fetch(\"\".concat(API, \"/productos/\").concat(id)).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                dispatch({\n                  type: TRAER_UNO,\n                  payload: data\n                });\n              }));\n\n            case 5:\n              _context3.prev = 5;\n              _context3.t0 = _context3[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context3.t0\n              });\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 5]]);\n    }));\n\n    return function (_x5) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};\nexport var traerPromociones = function traerPromociones() {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch) {\n      var url;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n              _context4.prev = 1;\n              url = \"\".concat(API, \"/subproductos/ofertas?desde=0&limite=9\");\n\n              if (isMobile()) {\n                url = \"\".concat(API, \"/subproductos/ofertas?desde=0&limite=6\");\n              }\n\n              return _context4.abrupt(\"return\", fetch(url).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                dispatch({\n                  type: TRAER_OFERTAS,\n                  payload: data.data\n                });\n              }));\n\n            case 7:\n              _context4.prev = 7;\n              _context4.t0 = _context4[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context4.t0.message\n              });\n\n            case 10:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 7]]);\n    }));\n\n    return function (_x6) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};\nexport var ordenarProductos = function ordenarProductos(productosOrdenados) {\n  return /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n\n              try {\n                dispatch({\n                  type: ORDENAR_PRODUCTOS,\n                  payload: productosOrdenados\n                });\n              } catch (error) {\n                dispatch({\n                  type: ERROR,\n                  payload: error\n                });\n              }\n\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function (_x7) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n};\nexport var aplicarFiltro = function aplicarFiltro(tipo, valor) {\n  return function (dispatch) {\n    switch (tipo) {\n      case 'categoria':\n        dispatch({\n          type: APLICAR_FILTRO_CATEGORIA,\n          payload: valor\n        });\n        break;\n\n      case 'subcategoria':\n        dispatch({\n          type: APLICAR_FILTRO_SUBCATEGORIA,\n          payload: valor\n        });\n        break;\n\n      case 'marca':\n        dispatch({\n          type: APLICAR_FILTRO_MARCA,\n          payload: valor\n        });\n        break;\n\n      case 'search':\n        dispatch({\n          type: APLICAR_FILTRO_BUSCADOR,\n          payload: valor\n        });\n        break;\n\n      case 'orden':\n        dispatch({\n          type: APLICAR_FILTRO_ORDEN,\n          payload: valor\n        });\n        break;\n\n      default:\n        break;\n    }\n  };\n};\nexport var quitarFiltro = function quitarFiltro(tipo) {\n  return function (dispatch, getState) {\n    var _getState$productosRe7 = getState().productosReducer.filtros,\n        categoria = _getState$productosRe7.categoria,\n        subcategoria = _getState$productosRe7.subcategoria,\n        marca = _getState$productosRe7.marca,\n        search = _getState$productosRe7.search,\n        orden = _getState$productosRe7.orden;\n\n    switch (tipo) {\n      case 'categoria':\n        if (!subcategoria && !marca) {\n          dispatch({\n            type: PRODUCTOS_RESTABLECER_FILTROS\n          });\n        } else {\n          dispatch({\n            type: ELIMINAR_FILTRO_CATEGORIA\n          });\n        }\n\n        break;\n\n      case 'subcategoria':\n        if (!categoria && !marca) {\n          dispatch({\n            type: PRODUCTOS_RESTABLECER_FILTROS\n          });\n        } else {\n          dispatch({\n            type: ELIMINAR_FILTRO_SUBCATEGORIA\n          });\n        }\n\n        break;\n\n      case 'marca':\n        if (!categoria && !subcategoria) {\n          dispatch({\n            type: PRODUCTOS_RESTABLECER_FILTROS\n          });\n        } else {\n          dispatch({\n            type: ELIMINAR_FILTRO_MARCA\n          });\n        }\n\n        break;\n\n      case 'buscador':\n        dispatch({\n          type: ELIMINAR_FILTRO_BUSCADOR\n        });\n        break;\n\n      case 'orden':\n        dispatch({\n          type: ELIMINAR_FILTRO_ORDEN\n        });\n        break;\n\n      default:\n        break;\n    }\n  };\n};\nexport var restablecerFiltros = function restablecerFiltros() {\n  return function (dispatch) {\n    dispatch({\n      type: PRODUCTOS_RESTABLECER_FILTROS\n    });\n  };\n};\nexport var updatePaginacion = function updatePaginacion() {\n  return function (dispatch, getState) {\n    var paginacion = getState().productosReducer.paginacion;\n    var desdeUpdated = isMobile() ? paginacion.desde + paginacion.limiteMobile : paginacion.desde + paginacion.limiteDesktop;\n    dispatch({\n      type: PRODUCTOS_PAGINACION,\n      payload: desdeUpdated\n    });\n  };\n};","map":{"version":3,"sources":["/home/franco/desarrollo/oliver/oliver-sitio/store/actions/productosActions.js"],"names":["API","isMobile","TRAER_TODOS","TRAER_UNO","LOADING","ERROR","TRAER_PROMOCIONES","ORDENAR_PRODUCTOS","FILTRANDO","LOADING_MAS","TRAER_MAS","TRAER_OFERTAS","APLICAR_FILTRO_CATEGORIA","APLICAR_FILTRO_SUBCATEGORIA","APLICAR_FILTRO_MARCA","APLICAR_FILTRO_BUSCADOR","APLICAR_FILTRO_ORDEN","ELIMINAR_FILTRO_CATEGORIA","ELIMINAR_FILTRO_SUBCATEGORIA","ELIMINAR_FILTRO_MARCA","ELIMINAR_FILTRO_BUSCADOR","ELIMINAR_FILTRO_ORDEN","PRODUCTOS_RESTABLECER_FILTROS","PRODUCTOS_PAGINACION","PRODUCTOS_SIN_RESULTADO","traerProductos","dispatch","getState","type","productosReducer","filtrando","filtros","categoria","subcategoria","marca","search","orden","paginacion","desde","limiteMobile","limiteDesktop","url","trim","console","log","fetch","then","res","json","data","payload","traerMas","productos","length","updateproductos","traerPorId","id","traerPromociones","message","ordenarProductos","productosOrdenados","error","aplicarFiltro","tipo","valor","quitarFiltro","restablecerFiltros","updatePaginacion","desdeUpdated"],"mappings":"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","sourcesContent":["import {API} from '../../config/index';\nimport {isMobile} from '../../helpers/index';\nimport {TRAER_TODOS,TRAER_UNO,LOADING,ERROR,TRAER_PROMOCIONES,ORDENAR_PRODUCTOS,FILTRANDO,LOADING_MAS,TRAER_MAS, TRAER_OFERTAS, APLICAR_FILTRO_CATEGORIA, APLICAR_FILTRO_SUBCATEGORIA, APLICAR_FILTRO_MARCA, APLICAR_FILTRO_BUSCADOR, APLICAR_FILTRO_ORDEN, ELIMINAR_FILTRO_CATEGORIA, ELIMINAR_FILTRO_SUBCATEGORIA, ELIMINAR_FILTRO_MARCA, ELIMINAR_FILTRO_BUSCADOR, ELIMINAR_FILTRO_ORDEN, PRODUCTOS_RESTABLECER_FILTROS, PRODUCTOS_PAGINACION, PRODUCTOS_SIN_RESULTADO} from '../types/productosTypes';\n\nexport const traerProductos = ()=>async (dispatch,getState)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        //obtengo el estado actualizado de los filtros\n        const {filtrando,filtros:{categoria,subcategoria,marca,search,orden},paginacion:{desde,limiteMobile,limiteDesktop}} = getState().productosReducer;\n\n        let url = `${API}/productos`;\n        if(filtrando){\n            if(search.trim() !== \"\"){\n                url += `/buscar?busqueda=${search}&`;\n            }else{\n                url +=`/filtro/filtrar?`;\n                if(categoria) { url += `categoria=${categoria}&` }\n                if(subcategoria) { url += `subcategoria=${subcategoria}&` }\n                if(marca) { url += `marca=${marca}&`}\n            }\n        }else{\n            url += '?';\n        }\n\n        url += `desde=${desde}&limite=${isMobile() ? limiteMobile : limiteDesktop}`;\n\n        console.log(url);\n        \n        return fetch(url).then(res=>res.json()).then(data=>{\n            dispatch({\n                type:TRAER_TODOS,\n                payload:data.data\n            });\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const traerMas = ()=>async (dispatch,getState)=>{\n    dispatch({\n        type:LOADING_MAS\n    });\n    try {\n        //obtengo el estado actualizado de los filtros\n        const {productos,filtrando,filtros:{categoria,subcategoria,marca,search,orden},paginacion:{desde,limiteMobile,limiteDesktop}} = getState().productosReducer;\n\n        let url = `${API}/productos`;\n\n        if(filtrando){\n            if(search.trim() !== \"\"){\n                url += `/buscar?busqueda=${search}&`;\n            }else{\n                url +=`/filtro/filtrar?`;\n                if(categoria) { url += `categoria=${categoria}&` }\n                if(subcategoria) { url += `subcategoria=${subcategoria}&` }\n                if(marca) { url += `marca=${marca}&`}\n            }\n        }else{\n            url += '?';\n        }\n\n        url += `desde=${desde}&limite=${isMobile() ? limiteMobile : limiteDesktop}`;\n\n        console.log(url);\n\n        return fetch(url).then(res=>res.json()).then(data=>{\n            if(data.data.length===0){\n                dispatch({\n                    type:PRODUCTOS_SIN_RESULTADO\n                })\n                return;\n            }\n            let updateproductos = [...productos,...data.data];\n            dispatch({\n                type:TRAER_MAS,\n                payload:updateproductos\n            });\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const traerPorId = id=>async(dispatch)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        return fetch(`${API}/productos/${id}`).then(res=>res.json()).then(data=>{\n            dispatch({\n                type:TRAER_UNO,\n                payload:data\n            });\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const traerPromociones = ()=>async(dispatch)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        let url = `${API}/subproductos/ofertas?desde=0&limite=9`;\n        if(isMobile()){\n            url = `${API}/subproductos/ofertas?desde=0&limite=6`;\n        }\n        return fetch(url).then(res=>res.json()).then(data=>{\n            dispatch({\n                type:TRAER_OFERTAS,\n                payload:data.data\n            });\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error.message\n        })\n    }\n}\n\nexport const ordenarProductos = productosOrdenados=>async dispatch=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        dispatch({\n            type:ORDENAR_PRODUCTOS,\n            payload:productosOrdenados\n        });\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const aplicarFiltro = (tipo,valor)=>dispatch=>{\n    switch (tipo) {\n        case 'categoria':\n            dispatch({\n                type:APLICAR_FILTRO_CATEGORIA,\n                payload:valor\n            })\n            break;\n        case 'subcategoria':\n            dispatch({\n                type:APLICAR_FILTRO_SUBCATEGORIA,\n                payload:valor\n            })\n            break;\n        case 'marca':\n            dispatch({\n                type:APLICAR_FILTRO_MARCA,\n                payload:valor\n            })\n            break;\n        case 'search':\n            dispatch({\n                type:APLICAR_FILTRO_BUSCADOR,\n                payload:valor\n            })\n            break;\n        case 'orden':\n            dispatch({\n                type:APLICAR_FILTRO_ORDEN,\n                payload:valor\n            })\n            break;\n        default:\n            break;\n    }\n}\n\nexport const quitarFiltro = (tipo)=>(dispatch,getState)=>{\n    const {filtros:{categoria,subcategoria,marca,search,orden}} = getState().productosReducer;\n    switch (tipo) {\n        case 'categoria':\n            if(!subcategoria && !marca){\n                dispatch({\n                    type:PRODUCTOS_RESTABLECER_FILTROS\n                })\n            }else{\n                dispatch({\n                    type:ELIMINAR_FILTRO_CATEGORIA\n                })\n            }\n            break;\n        case 'subcategoria':\n            if(!categoria && !marca){\n                dispatch({\n                    type:PRODUCTOS_RESTABLECER_FILTROS\n                })\n            }else{\n                dispatch({\n                    type:ELIMINAR_FILTRO_SUBCATEGORIA\n                })\n            }\n            break;\n        case 'marca':\n            if(!categoria && !subcategoria){\n                dispatch({\n                    type:PRODUCTOS_RESTABLECER_FILTROS\n                })\n            }else{\n                dispatch({\n                    type:ELIMINAR_FILTRO_MARCA\n                })\n            }\n            break;\n        case 'buscador':\n            dispatch({\n                type:ELIMINAR_FILTRO_BUSCADOR\n            })\n            break;\n        case 'orden':\n            dispatch({\n                type:ELIMINAR_FILTRO_ORDEN\n            })\n            break;\n        default:\n            break;\n    }\n}\n\nexport const restablecerFiltros = ()=>dispatch=>{\n    dispatch({\n        type:PRODUCTOS_RESTABLECER_FILTROS\n    })\n}\n\nexport const updatePaginacion = ()=>(dispatch,getState)=>{\n    const {paginacion} = getState().productosReducer;\n    let desdeUpdated = isMobile() ? paginacion.desde + paginacion.limiteMobile : paginacion.desde + paginacion.limiteDesktop;\n    dispatch({\n        type:PRODUCTOS_PAGINACION,\n        payload:desdeUpdated\n    });\n}"]},"metadata":{},"sourceType":"module"}