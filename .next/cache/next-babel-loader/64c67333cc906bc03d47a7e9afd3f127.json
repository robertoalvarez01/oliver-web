{"ast":null,"code":"//import {API} from '../config/index';\nimport { TRAER_PRODUCTOS, AGREGAR_PRODUCTO, ELIMINAR_PRODUCTO, LOADING, ERROR } from '../types/carritoTypes';\nexport const traerProductos = () => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    const productos = JSON.parse(localStorage.getItem('carrito'));\n    let subtotal = 0;\n    productos.forEach(prd => {\n      subtotal += parseInt(prd.precioUnidad * prd.cantidad);\n    });\n    let payloadData = {\n      productos,\n      subtotal\n    };\n    dispatch({\n      type: TRAER_PRODUCTOS,\n      payload: payloadData\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const agregarProducto = producto => async (dispatch, getState) => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    //productos que hay en el reducer\n    let {\n      productos\n    } = getState().carritoReducer;\n    let listProductosUpgrade;\n    let productoRepetido = productos.filter(res => res.idSubProducto == producto.idSubProducto);\n\n    if (productoRepetido.length > 0) {\n      //si se intenta agregar de nuevo el mismo producto, se suma la cantidad, no todo el producto.\n      productoRepetido[0].cantidad = productoRepetido[0].cantidad + producto.cantidad;\n      let restantes = productos.filter(newRes => newRes.idSubProducto != productoRepetido[0].idSubProducto);\n\n      if (restantes.length > 0) {\n        listProductosUpgrade = [...restantes, productoRepetido[0]];\n      } else {\n        listProductosUpgrade = [productoRepetido[0]];\n      }\n    } else {\n      listProductosUpgrade = [...productos, producto];\n    } //actualizo localstorage\n\n\n    localStorage.setItem('carrito', JSON.stringify(listProductosUpgrade));\n    const prds = JSON.parse(localStorage.getItem('carrito'));\n    let subtotal = 0;\n    prds.forEach(prd => {\n      subtotal += parseInt(prd.precioUnidad * prd.cantidad);\n    });\n    let payloadData = {\n      listProductosUpgrade,\n      subtotal\n    };\n    setTimeout(() => {\n      dispatch({\n        type: AGREGAR_PRODUCTO,\n        payload: payloadData\n      });\n    }, 1500);\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const eliminarProducto = idSubProducto => async (dispatch, getState) => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    const {\n      productos\n    } = getState().carritoReducer; //filtro los productos que no tengan el idProducto que se recibió. entonces elimino ese producto y actualizo el reducer.\n\n    const newProductos = productos.filter(newArray => newArray.idSubProducto !== idSubProducto);\n    console.log(newProductos);\n    localStorage.setItem('carrito', JSON.stringify(newProductos));\n    dispatch({\n      type: ELIMINAR_PRODUCTO,\n      payload: newProductos\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};","map":{"version":3,"sources":["C:/Users/franc/Documents/oliver-2/sitio-desa/store/actions/carritoActions.js"],"names":["TRAER_PRODUCTOS","AGREGAR_PRODUCTO","ELIMINAR_PRODUCTO","LOADING","ERROR","traerProductos","dispatch","type","productos","JSON","parse","localStorage","getItem","subtotal","forEach","prd","parseInt","precioUnidad","cantidad","payloadData","payload","error","agregarProducto","producto","getState","carritoReducer","listProductosUpgrade","productoRepetido","filter","res","idSubProducto","length","restantes","newRes","setItem","stringify","prds","setTimeout","eliminarProducto","newProductos","newArray","console","log"],"mappings":"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","sourcesContent":["//import {API} from '../config/index';\r\nimport {TRAER_PRODUCTOS,AGREGAR_PRODUCTO,ELIMINAR_PRODUCTO,LOADING,ERROR} from '../types/carritoTypes';\r\n\r\nexport const traerProductos = ()=>async (dispatch)=>{\r\n    dispatch({\r\n        type:LOADING\r\n    });\r\n    try {\r\n        const productos = JSON.parse(localStorage.getItem('carrito'));\r\n        let subtotal = 0;\r\n        productos.forEach(prd => {\r\n            subtotal += parseInt(prd.precioUnidad * prd.cantidad);\r\n        });\r\n        let payloadData = {\r\n            productos,\r\n            subtotal\r\n        }\r\n        dispatch({\r\n            type:TRAER_PRODUCTOS,\r\n            payload:payloadData\r\n        });\r\n    } catch (error) {\r\n        dispatch({\r\n            type:ERROR,\r\n            payload:error\r\n        })\r\n    }\r\n}\r\n\r\nexport const agregarProducto = producto=>async (dispatch,getState)=>{\r\n    dispatch({\r\n        type:LOADING\r\n    });\r\n    try {\r\n        //productos que hay en el reducer\r\n        let {productos} = getState().carritoReducer;\r\n        let listProductosUpgrade;\r\n        let productoRepetido = productos.filter(res=>res.idSubProducto==producto.idSubProducto);\r\n        if(productoRepetido.length>0){//si se intenta agregar de nuevo el mismo producto, se suma la cantidad, no todo el producto.\r\n            productoRepetido[0].cantidad = productoRepetido[0].cantidad + producto.cantidad;\r\n            let restantes = productos.filter(newRes=>newRes.idSubProducto!=productoRepetido[0].idSubProducto);\r\n            if(restantes.length>0){\r\n                listProductosUpgrade = [\r\n                    ...restantes,\r\n                    productoRepetido[0]\r\n                ];\r\n            }else{\r\n                listProductosUpgrade = [\r\n                    productoRepetido[0]\r\n                ];\r\n            }\r\n        }else{\r\n            listProductosUpgrade = [\r\n                ...productos,\r\n                producto\r\n            ];\r\n        }\r\n        //actualizo localstorage\r\n        localStorage.setItem('carrito',JSON.stringify(listProductosUpgrade));\r\n        const prds = JSON.parse(localStorage.getItem('carrito'));\r\n        let subtotal = 0;\r\n        prds.forEach(prd => {\r\n            subtotal += parseInt(prd.precioUnidad * prd.cantidad);\r\n        });\r\n        let payloadData = {\r\n            listProductosUpgrade,\r\n            subtotal\r\n        }\r\n        setTimeout(() => {\r\n            dispatch({\r\n                type:AGREGAR_PRODUCTO,\r\n                payload:payloadData\r\n            })\r\n        }, 1500);\r\n    } catch (error) {\r\n       dispatch({\r\n            type:ERROR,\r\n            payload:error\r\n        }) \r\n    }\r\n}\r\n\r\nexport const eliminarProducto = idSubProducto=>async (dispatch,getState)=>{\r\n    dispatch({\r\n        type:LOADING\r\n    });\r\n    try {\r\n        const {productos} = getState().carritoReducer;\r\n        //filtro los productos que no tengan el idProducto que se recibió. entonces elimino ese producto y actualizo el reducer.\r\n        const newProductos = productos.filter(newArray=>newArray.idSubProducto !== idSubProducto);\r\n        console.log(newProductos);\r\n        localStorage.setItem('carrito',JSON.stringify(newProductos));\r\n        dispatch({\r\n            type:ELIMINAR_PRODUCTO,\r\n            payload:newProductos\r\n        });\r\n    } catch (error) {\r\n        dispatch({\r\n            type:ERROR,\r\n            payload:error\r\n        })    \r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}