{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\franc\\\\Documents\\\\oliver-2\\\\oliver-sitio\\\\src\\\\components\\\\Filtro\\\\index.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect } from 'react';\nimport FiltroStyle from './Filtro.module.css';\nimport Modal from '../Modal';\nimport ModalMarca from '../ModalMarca';\nimport { faTimes, faBroom, faChevronRight } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { connect } from 'react-redux';\nimport * as subproductosActions from '../../../store/actions/subproductosActions';\nimport * as marcasActions from '../../../store/actions/marcasActions';\nimport * as categoriasActions from '../../../store/actions/categoriasAction';\nimport * as subcategoriasActions from '../../../store/actions/subcategoriasAction';\nimport Loader from '../Loader';\nconst {\n  traerTodas: marcasTraerTodas\n} = marcasActions;\nconst {\n  filtrarProductos: subproductosFiltrarProductos,\n  traerTodos: subproductosTraerTodos\n} = subproductosActions;\nconst {\n  traerTodas: categoriasTraerTodas\n} = categoriasActions;\nconst {\n  traerTodas: subcategoriaTraerTodas\n} = subcategoriasActions;\n\nconst Filtro = props => {\n  //state for the filters\n  const {\n    0: estadoFiltro,\n    1: setEstadoFiltro\n  } = useState({\n    filtrando: false,\n    categoria: '',\n    subcategoria: '',\n    marca: '',\n    buscador: ''\n  }); //manejo de Modal marcas\n\n  const {\n    0: modalIsOpen,\n    1: setModalIsOpen\n  } = useState(false);\n\n  const onCloseModal = () => {\n    document.getElementsByTagName('body')[0].style.overflowY = 'scroll';\n    setModalIsOpen(false);\n  }; //loop de efecto para ejecutar solo una vez cuando el componente se monte en el caso de que se este filtrando directo desde la url\n\n\n  useEffect(() => {\n    getData();\n  }, []);\n\n  const getData = async () => {\n    if (props.marcasReducer.marcas.length === 0) {\n      await props.marcasTraerTodas();\n    }\n\n    if (props.categoriasReducer.categorias.length === 0) {\n      await props.categoriasTraerTodas();\n    }\n\n    if (props.subcategoriaReducer.subcategorias.length === 0) {\n      await props.subcategoriaTraerTodas();\n    }\n\n    if (props.location !== '/productos') {\n      activarFiltroPorUrl();\n    }\n  }; //loop de efecto para hacer render cada vez que se agrega o elimina un filtro\n\n\n  useEffect(() => {\n    switchItemActive();\n  }, [estadoFiltro]);\n\n  const activarFiltroPorUrl = () => {\n    return activarFiltro(props.query.type, props.query.index[1]);\n  };\n\n  const activarFiltro = (tipoFiltro, key) => {\n    switch (tipoFiltro) {\n      case 'categoria':\n        setEstadoFiltro(_objectSpread(_objectSpread({}, estadoFiltro), {}, {\n          categoria: key,\n          buscador: '',\n          filtrando: true\n        }));\n        break;\n\n      case 'subcategoria':\n        setEstadoFiltro(_objectSpread(_objectSpread({}, estadoFiltro), {}, {\n          subcategoria: key,\n          buscador: '',\n          filtrando: true\n        }));\n        break;\n\n      case 'marca':\n        setEstadoFiltro(_objectSpread(_objectSpread({}, estadoFiltro), {}, {\n          marca: key,\n          buscador: '',\n          filtrando: true\n        }));\n        break;\n\n      case 'buscador':\n        setEstadoFiltro(_objectSpread(_objectSpread({}, estadoFiltro), {}, {\n          buscador: key,\n          filtrando: true\n        }));\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const switchItemActive = () => {\n    // console.log(estadoFiltro);\n    for (let index = 0; index < document.getElementsByClassName(FiltroStyle.item_filtro).length; index++) {\n      const element = document.getElementsByClassName(FiltroStyle.item_filtro)[index];\n      element.classList.remove(FiltroStyle.active);\n      document.getElementsByClassName(FiltroStyle.icon_close_filtro)[index].classList.add('d-none');\n    }\n\n    ;\n    if (!estadoFiltro.filtrando) return; //si no hay nada en buscador, puedo setear un active en algun elemento de la lista\n\n    if (estadoFiltro.buscador.trim() === '') {\n      //recorro el state para obtener las claves y agregar active el elemento correspondiente\n      for (const key in estadoFiltro) {\n        if (estadoFiltro[key] && estadoFiltro[key] !== '' && estadoFiltro[key] !== true) {\n          //console.log(key);\n          //console.log(estadoFiltro[key]);\n          if (document.getElementsByName(`${key}-${estadoFiltro[key]}`)[0]) {\n            //pregunto si existe el elemento con el name del filtro para agregarle el active, si no existe lo creo. (si no existe es porque viene desde modal de marcas)\n            document.getElementsByName(`${key}-${estadoFiltro[key]}`)[0].classList.add(FiltroStyle.active);\n            document.getElementById(`close-${key}-${estadoFiltro[key]}`).classList.remove('d-none');\n          } else {\n            if (estadoFiltro.marca !== '') {\n              //creo los elementos del item\n              let newItemMarca = document.createElement('li');\n              let divItemMarca = document.createElement('div');\n              let spanItemMarca = document.createElement('span');\n              let iconClose = document.createElement('svg');\n              let marcaName = props.marcasReducer.marcas.filter(res => res.idMarca == estadoFiltro.marca);\n              console.log(marcaName); //asigno las clases, atributos y eventos necesarios.\n\n              divItemMarca.className = `${FiltroStyle.item_filtro} ${FiltroStyle.active}`;\n              divItemMarca.setAttribute('name', `marca-${estadoFiltro.marca}`);\n              divItemMarca.addEventListener('click', () => activarFiltro('marca', estadoFiltro.marca));\n              spanItemMarca.className = 'text-muted';\n              spanItemMarca.innerHTML = estadoFiltro.marca;\n              iconClose.innerHTML = `\n                                <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"times\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 352 512\" class=\"svg-inline--fa fa-times fa-w-11 Filtro_icon_close_filtro__1xlv5\" id=\"close-marca-${estadoFiltro.marca}\">\n                                    <path fill=\"currentColor\" d=\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\"></path>\n                                </svg>\n                            `; //voy ubicando los elementos dentro de cada padre\n\n              divItemMarca.appendChild(spanItemMarca);\n              newItemMarca.appendChild(divItemMarca);\n              newItemMarca.appendChild(iconClose); //Obtengo el primer item de la lista y lo elimino, para tener siempre la misma cantidad de marcas en la lista.\n\n              if (document.querySelector(`#listaMarca`)) {\n                let firstItemMarca = document.querySelector(`#listaMarca`).children[0];\n                let listaMarcas = document.querySelector(`#listaMarca`);\n                listaMarcas.removeChild(firstItemMarca); //ahora agrego el item creado a la lista\n\n                listaMarcas.appendChild(newItemMarca);\n              }\n\n              ;\n            }\n\n            ;\n          }\n        }\n      }\n    } //la primera vez que se carga el componente, filtrando es false, por eso pregunto para que no se ejecuta la funcion de ir a filtrar apenas se monte el componente. Sino que se ejecute cuando de verdad se quiera filtrar.\n\n\n    if (estadoFiltro.filtrando) {\n      let urlFiltro = armarUrlFiltro(); //armo la url que mando a la api para traer los resultados de lo filtrado.\n\n      props.subproductosFiltrarProductos(urlFiltro);\n    }\n\n    ;\n  };\n\n  const limpiarFiltro = tipo => {\n    switch (tipo) {\n      case 'categoria':\n        setEstadoFiltro(_objectSpread(_objectSpread({}, estadoFiltro), {}, {\n          categoria: ''\n        }));\n        break;\n\n      case 'subcategoria':\n        setEstadoFiltro(_objectSpread(_objectSpread({}, estadoFiltro), {}, {\n          subcategoria: ''\n        }));\n        break;\n\n      case 'marca':\n        setEstadoFiltro(_objectSpread(_objectSpread({}, estadoFiltro), {}, {\n          marca: ''\n        }));\n        break;\n\n      default:\n        props.subproductosTraerTodos();\n        setEstadoFiltro({\n          filtrando: false,\n          categoria: '',\n          subcategoria: '',\n          marca: '',\n          buscador: ''\n        });\n        break;\n    }\n  };\n\n  const closeFiltrosMobile = () => {\n    document.getElementsByClassName(FiltroStyle.filtros__contanier)[0].classList.remove(FiltroStyle.show_filtros);\n  };\n\n  const armarUrlFiltro = () => {\n    let url = 'filtrar'; //si buscador viene true, es porque viene desde el buscador del menu o modal de buscador(mobile).\n\n    if (estadoFiltro.buscador !== '') return url += `?buscar=${estadoFiltro.buscador}`;\n    let categoria = estadoFiltro.categoria,\n        subcategoria = estadoFiltro.subcategoria,\n        marca = estadoFiltro.marca;\n\n    if (categoria && categoria !== '') {\n      url += `?categoria=${estadoFiltro.categoria}`;\n    }\n\n    if (estadoFiltro.subcategoria && estadoFiltro.subcategoria !== '') {\n      if (categoria !== '') {\n        url += `&subcategoria=${estadoFiltro.subcategoria}`;\n      } else {\n        url += `?subcategoria=${estadoFiltro.subcategoria}`;\n      }\n    }\n\n    if (marca && marca !== '') {\n      if (categoria !== '' && subcategoria !== '') {\n        url += `?marca=${estadoFiltro.marca}`;\n      } else {\n        url += `&marca=${estadoFiltro.marca}`;\n      }\n    }\n\n    return url;\n  };\n\n  const showFiltros = () => {\n    let element = document.getElementsByClassName(FiltroStyle.filtros__contanier)[0];\n    element.classList.toggle(FiltroStyle.show);\n    document.getElementById('iconFiltroContainer').classList.toggle(FiltroStyle.rotar);\n  };\n\n  return __jsx(\"div\", {\n    className: FiltroStyle.filtros__contanier,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 9\n    }\n  }, __jsx(\"button\", {\n    className: FiltroStyle.btn_close_filtro,\n    onClick: showFiltros,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 13\n    }\n  }, __jsx(FontAwesomeIcon, {\n    id: \"iconFiltroContainer\",\n    icon: faChevronRight,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 17\n    }\n  })), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 13\n    }\n  }, props.categoriasReducer.categorias.length == 0 || props.subcategoriaReducer.subcategorias.length == 0 || props.marcasReducer.marcas.length == 0 ? __jsx(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 158\n    }\n  }) : __jsx(React.Fragment, null, estadoFiltro.filtrando ? __jsx(\"button\", {\n    className: \"boton bg-yellow mb-3\",\n    onClick: limpiarFiltro,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 51\n    }\n  }, __jsx(FontAwesomeIcon, {\n    icon: faBroom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 29\n    }\n  }), \" Limpiar Filtros\") : null, __jsx(FontAwesomeIcon, {\n    icon: faTimes,\n    className: FiltroStyle.cerrar_filtro_mobile,\n    onClick: closeFiltrosMobile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 25\n    }\n  }), __jsx(\"h4\", {\n    className: FiltroStyle.titulo_filtros,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 25\n    }\n  }, \"Mascota\"), __jsx(\"ul\", {\n    className: FiltroStyle.lista,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 25\n    }\n  }, props.categoriasReducer.categorias.map(cat => __jsx(\"li\", {\n    key: cat.idCategoria,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 37\n    }\n  }, __jsx(\"div\", {\n    className: FiltroStyle.item_filtro,\n    name: `categoria-${cat.idCategoria}`,\n    onClick: () => activarFiltro('categoria', `${cat.idCategoria}`),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 41\n    }\n  }, __jsx(\"span\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 45\n    }\n  }, cat.categoria)), __jsx(FontAwesomeIcon, {\n    icon: faTimes,\n    className: FiltroStyle.icon_close_filtro + ' ' + `d-none`,\n    onClick: () => limpiarFiltro('categoria'),\n    id: `close-categoria-${cat.idCategoria}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 41\n    }\n  })))), __jsx(\"h4\", {\n    className: FiltroStyle.titulo_filtros,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 25\n    }\n  }, \"Alimentos\"), __jsx(\"ul\", {\n    className: FiltroStyle.lista,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 25\n    }\n  }, props.subcategoriaReducer.subcategorias.map(sc => __jsx(\"li\", {\n    key: sc.idSubCategoria,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 37\n    }\n  }, __jsx(\"div\", {\n    className: FiltroStyle.item_filtro,\n    name: `subcategoria-${sc.idSubCategoria}`,\n    onClick: () => activarFiltro('subcategoria', `${sc.idSubCategoria}`),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 41\n    }\n  }, __jsx(\"span\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 45\n    }\n  }, sc.subcategoria)), __jsx(FontAwesomeIcon, {\n    icon: faTimes,\n    className: FiltroStyle.icon_close_filtro + ' ' + `d-none`,\n    onClick: () => limpiarFiltro('subcategoria'),\n    id: `close-${`subcategoria-${sc.idSubCategoria}`}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 41\n    }\n  })))), __jsx(\"h4\", {\n    className: FiltroStyle.titulo_filtros,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 25\n    }\n  }, \"Marca\"), __jsx(\"ul\", {\n    id: \"listaMarca\",\n    className: FiltroStyle.sinBorderBottom + ' ' + FiltroStyle.lista,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 25\n    }\n  }, props.marcasReducer.marcas.map((marca, key) => key > 3 ? false : __jsx(\"li\", {\n    key: marca.idMarca,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 37\n    }\n  }, __jsx(\"div\", {\n    className: FiltroStyle.item_filtro,\n    name: `marca-${marca.idMarca}`,\n    onClick: () => activarFiltro('marca', `${marca.idMarca}`),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 41\n    }\n  }, __jsx(\"span\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 45\n    }\n  }, marca.marca)), __jsx(FontAwesomeIcon, {\n    icon: faTimes,\n    className: FiltroStyle.icon_close_filtro + ' ' + `d-none`,\n    onClick: () => limpiarFiltro('marca'),\n    id: `close-marca-${marca.idMarca}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 41\n    }\n  })))), __jsx(\"button\", {\n    onClick: () => setModalIsOpen(true),\n    className: \"boton bg-gris\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 25\n    }\n  }, \"Ver todas\"))), !modalIsOpen ? null : __jsx(Modal, {\n    closeModal: onCloseModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 17\n    }\n  }, __jsx(ModalMarca, {\n    closeModal: onCloseModal,\n    activarFiltro: activarFiltro,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 21\n    }\n  })));\n};\n\nconst mapStateToProps = ({\n  marcasReducer,\n  subproductosReducer,\n  categoriasReducer,\n  subcategoriaReducer\n}) => {\n  return {\n    marcasReducer,\n    subproductosReducer,\n    categoriasReducer,\n    subcategoriaReducer\n  };\n};\n\nconst mapDispatchToProps = {\n  marcasTraerTodas,\n  subproductosFiltrarProductos,\n  subproductosTraerTodos,\n  categoriasTraerTodas,\n  subcategoriaTraerTodas\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Filtro);","map":{"version":3,"sources":["C:/Users/franc/Documents/oliver-2/oliver-sitio/src/components/Filtro/index.js"],"names":["React","useState","useEffect","FiltroStyle","Modal","ModalMarca","faTimes","faBroom","faChevronRight","FontAwesomeIcon","connect","subproductosActions","marcasActions","categoriasActions","subcategoriasActions","Loader","traerTodas","marcasTraerTodas","filtrarProductos","subproductosFiltrarProductos","traerTodos","subproductosTraerTodos","categoriasTraerTodas","subcategoriaTraerTodas","Filtro","props","estadoFiltro","setEstadoFiltro","filtrando","categoria","subcategoria","marca","buscador","modalIsOpen","setModalIsOpen","onCloseModal","document","getElementsByTagName","style","overflowY","getData","marcasReducer","marcas","length","categoriasReducer","categorias","subcategoriaReducer","subcategorias","location","activarFiltroPorUrl","switchItemActive","activarFiltro","query","type","index","tipoFiltro","key","getElementsByClassName","item_filtro","element","classList","remove","active","icon_close_filtro","add","trim","getElementsByName","getElementById","newItemMarca","createElement","divItemMarca","spanItemMarca","iconClose","marcaName","filter","res","idMarca","console","log","className","setAttribute","addEventListener","innerHTML","appendChild","querySelector","firstItemMarca","children","listaMarcas","removeChild","urlFiltro","armarUrlFiltro","limpiarFiltro","tipo","closeFiltrosMobile","filtros__contanier","show_filtros","url","showFiltros","toggle","show","rotar","btn_close_filtro","cerrar_filtro_mobile","titulo_filtros","lista","map","cat","idCategoria","sc","idSubCategoria","sinBorderBottom","mapStateToProps","subproductosReducer","mapDispatchToProps"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAAyBC,SAAzB,QAA0C,OAA1C;AACA,OAAOC,WAAP,MAAwB,qBAAxB;AACA,OAAOC,KAAP,MAAkB,UAAlB;AACA,OAAOC,UAAP,MAAuB,eAAvB;AACA,SAASC,OAAT,EAAiBC,OAAjB,EAAyBC,cAAzB,QAA+C,mCAA/C;AACA,SAASC,eAAT,QAAgC,gCAAhC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,KAAKC,mBAAZ,MAAqC,4CAArC;AACA,OAAO,KAAKC,aAAZ,MAA+B,sCAA/B;AACA,OAAO,KAAKC,iBAAZ,MAAmC,yCAAnC;AACA,OAAO,KAAKC,oBAAZ,MAAsC,4CAAtC;AACA,OAAOC,MAAP,MAAmB,WAAnB;AAEA,MAAM;AAACC,EAAAA,UAAU,EAACC;AAAZ,IAAgCL,aAAtC;AACA,MAAM;AAACM,EAAAA,gBAAgB,EAACC,4BAAlB;AAA+CC,EAAAA,UAAU,EAACC;AAA1D,IAAoFV,mBAA1F;AACA,MAAM;AAACK,EAAAA,UAAU,EAACM;AAAZ,IAAoCT,iBAA1C;AACA,MAAM;AAACG,EAAAA,UAAU,EAACO;AAAZ,IAAsCT,oBAA5C;;AAEA,MAAMU,MAAM,GAAIC,KAAD,IAAW;AAEtB;AACA,QAAM;AAAA,OAACC,YAAD;AAAA,OAAeC;AAAf,MAAkC1B,QAAQ,CAAC;AAC7C2B,IAAAA,SAAS,EAAC,KADmC;AAE7CC,IAAAA,SAAS,EAAC,EAFmC;AAG7CC,IAAAA,YAAY,EAAC,EAHgC;AAI7CC,IAAAA,KAAK,EAAC,EAJuC;AAK7CC,IAAAA,QAAQ,EAAC;AALoC,GAAD,CAAhD,CAHsB,CAWtB;;AACA,QAAM;AAAA,OAACC,WAAD;AAAA,OAAcC;AAAd,MAAgCjC,QAAQ,CAAC,KAAD,CAA9C;;AACA,QAAMkC,YAAY,GAAG,MAAI;AACrBC,IAAAA,QAAQ,CAACC,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyCC,KAAzC,CAA+CC,SAA/C,GAA2D,QAA3D;AACAL,IAAAA,cAAc,CAAC,KAAD,CAAd;AACH,GAHD,CAbsB,CAkBtB;;;AACAhC,EAAAA,SAAS,CAAC,MAAM;AACZsC,IAAAA,OAAO;AACV,GAFQ,EAEP,EAFO,CAAT;;AAIA,QAAMA,OAAO,GAAG,YAAS;AACrB,QAAGf,KAAK,CAACgB,aAAN,CAAoBC,MAApB,CAA2BC,MAA3B,KAAoC,CAAvC,EAAyC;AACrC,YAAMlB,KAAK,CAACR,gBAAN,EAAN;AACH;;AACD,QAAGQ,KAAK,CAACmB,iBAAN,CAAwBC,UAAxB,CAAmCF,MAAnC,KAA4C,CAA/C,EAAiD;AAC7C,YAAMlB,KAAK,CAACH,oBAAN,EAAN;AACH;;AACD,QAAGG,KAAK,CAACqB,mBAAN,CAA0BC,aAA1B,CAAwCJ,MAAxC,KAAiD,CAApD,EAAsD;AAClD,YAAMlB,KAAK,CAACF,sBAAN,EAAN;AACH;;AACD,QAAGE,KAAK,CAACuB,QAAN,KAAmB,YAAtB,EAAmC;AAC/BC,MAAAA,mBAAmB;AACtB;AACJ,GAbD,CAvBsB,CAsCtB;;;AACA/C,EAAAA,SAAS,CAAC,MAAM;AACZgD,IAAAA,gBAAgB;AACnB,GAFQ,EAEN,CAACxB,YAAD,CAFM,CAAT;;AAIA,QAAMuB,mBAAmB,GAAG,MAAI;AAC5B,WAAOE,aAAa,CAAC1B,KAAK,CAAC2B,KAAN,CAAYC,IAAb,EAAkB5B,KAAK,CAAC2B,KAAN,CAAYE,KAAZ,CAAkB,CAAlB,CAAlB,CAApB;AACH,GAFD;;AAIA,QAAMH,aAAa,GAAG,CAACI,UAAD,EAAYC,GAAZ,KAAkB;AACpC,YAAQD,UAAR;AACI,WAAK,WAAL;AACI5B,QAAAA,eAAe,iCACRD,YADQ;AAEXG,UAAAA,SAAS,EAAC2B,GAFC;AAGXxB,UAAAA,QAAQ,EAAC,EAHE;AAIXJ,UAAAA,SAAS,EAAC;AAJC,WAAf;AAMA;;AACJ,WAAK,cAAL;AACID,QAAAA,eAAe,iCACRD,YADQ;AAEXI,UAAAA,YAAY,EAAC0B,GAFF;AAGXxB,UAAAA,QAAQ,EAAC,EAHE;AAIXJ,UAAAA,SAAS,EAAC;AAJC,WAAf;AAMA;;AACJ,WAAK,OAAL;AACID,QAAAA,eAAe,iCACRD,YADQ;AAEXK,UAAAA,KAAK,EAACyB,GAFK;AAGXxB,UAAAA,QAAQ,EAAC,EAHE;AAIXJ,UAAAA,SAAS,EAAC;AAJC,WAAf;AAMA;;AACJ,WAAK,UAAL;AACID,QAAAA,eAAe,iCACRD,YADQ;AAEXM,UAAAA,QAAQ,EAACwB,GAFE;AAGX5B,UAAAA,SAAS,EAAC;AAHC,WAAf;AAKA;;AACJ;AACI;AAjCR;AAmCH,GApCD;;AAsCA,QAAMsB,gBAAgB,GAAG,MAAI;AACzB;AAEA,SAAK,IAAII,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGlB,QAAQ,CAACqB,sBAAT,CAAgCtD,WAAW,CAACuD,WAA5C,EAAyDf,MAArF,EAA6FW,KAAK,EAAlG,EAAsG;AAClG,YAAMK,OAAO,GAAGvB,QAAQ,CAACqB,sBAAT,CAAgCtD,WAAW,CAACuD,WAA5C,EAAyDJ,KAAzD,CAAhB;AACAK,MAAAA,OAAO,CAACC,SAAR,CAAkBC,MAAlB,CAAyB1D,WAAW,CAAC2D,MAArC;AACA1B,MAAAA,QAAQ,CAACqB,sBAAT,CAAgCtD,WAAW,CAAC4D,iBAA5C,EAA+DT,KAA/D,EAAsEM,SAAtE,CAAgFI,GAAhF,CAAoF,QAApF;AACH;;AAAA;AACD,QAAG,CAACtC,YAAY,CAACE,SAAjB,EAA4B,OARH,CASzB;;AACA,QAAGF,YAAY,CAACM,QAAb,CAAsBiC,IAAtB,OAA+B,EAAlC,EAAqC;AACjC;AACA,WAAK,MAAMT,GAAX,IAAkB9B,YAAlB,EAAgC;AAC5B,YAAGA,YAAY,CAAC8B,GAAD,CAAZ,IAAqB9B,YAAY,CAAC8B,GAAD,CAAZ,KAAoB,EAAzC,IAA+C9B,YAAY,CAAC8B,GAAD,CAAZ,KAAoB,IAAtE,EAA2E;AACvE;AACA;AACA,cAAGpB,QAAQ,CAAC8B,iBAAT,CAA4B,GAAEV,GAAI,IAAG9B,YAAY,CAAC8B,GAAD,CAAM,EAAvD,EAA0D,CAA1D,CAAH,EAAgE;AAAC;AAC7DpB,YAAAA,QAAQ,CAAC8B,iBAAT,CAA4B,GAAEV,GAAI,IAAG9B,YAAY,CAAC8B,GAAD,CAAM,EAAvD,EAA0D,CAA1D,EAA6DI,SAA7D,CAAuEI,GAAvE,CAA2E7D,WAAW,CAAC2D,MAAvF;AACA1B,YAAAA,QAAQ,CAAC+B,cAAT,CAAyB,SAAQX,GAAI,IAAG9B,YAAY,CAAC8B,GAAD,CAAM,EAA1D,EAA6DI,SAA7D,CAAuEC,MAAvE,CAA8E,QAA9E;AACH,WAHD,MAGK;AACD,gBAAGnC,YAAY,CAACK,KAAb,KAAqB,EAAxB,EAA2B;AACvB;AACA,kBAAIqC,YAAY,GAAGhC,QAAQ,CAACiC,aAAT,CAAuB,IAAvB,CAAnB;AACA,kBAAIC,YAAY,GAAGlC,QAAQ,CAACiC,aAAT,CAAuB,KAAvB,CAAnB;AACA,kBAAIE,aAAa,GAAGnC,QAAQ,CAACiC,aAAT,CAAuB,MAAvB,CAApB;AACA,kBAAIG,SAAS,GAAGpC,QAAQ,CAACiC,aAAT,CAAuB,KAAvB,CAAhB;AAEA,kBAAII,SAAS,GAAGhD,KAAK,CAACgB,aAAN,CAAoBC,MAApB,CAA2BgC,MAA3B,CAAkCC,GAAG,IAAEA,GAAG,CAACC,OAAJ,IAAelD,YAAY,CAACK,KAAnE,CAAhB;AACA8C,cAAAA,OAAO,CAACC,GAAR,CAAYL,SAAZ,EARuB,CASvB;;AACAH,cAAAA,YAAY,CAACS,SAAb,GAAyB,GAAE5E,WAAW,CAACuD,WAAY,IAAGvD,WAAW,CAAC2D,MAAO,EAAzE;AACAQ,cAAAA,YAAY,CAACU,YAAb,CAA0B,MAA1B,EAAkC,SAAQtD,YAAY,CAACK,KAAM,EAA7D;AACAuC,cAAAA,YAAY,CAACW,gBAAb,CAA8B,OAA9B,EAAsC,MAAI9B,aAAa,CAAC,OAAD,EAASzB,YAAY,CAACK,KAAtB,CAAvD;AACAwC,cAAAA,aAAa,CAACQ,SAAd,GAA0B,YAA1B;AACAR,cAAAA,aAAa,CAACW,SAAd,GAA0BxD,YAAY,CAACK,KAAvC;AAEAyC,cAAAA,SAAS,CAACU,SAAV,GAAuB;4QACyNxD,YAAY,CAACK,KAAM;;;6BADnQ,CAhBuB,CAsBvB;;AACAuC,cAAAA,YAAY,CAACa,WAAb,CAAyBZ,aAAzB;AACAH,cAAAA,YAAY,CAACe,WAAb,CAAyBb,YAAzB;AACAF,cAAAA,YAAY,CAACe,WAAb,CAAyBX,SAAzB,EAzBuB,CA2BvB;;AACA,kBAAGpC,QAAQ,CAACgD,aAAT,CAAwB,aAAxB,CAAH,EAAyC;AACrC,oBAAIC,cAAc,GAAGjD,QAAQ,CAACgD,aAAT,CAAwB,aAAxB,EAAsCE,QAAtC,CAA+C,CAA/C,CAArB;AACA,oBAAIC,WAAW,GAAGnD,QAAQ,CAACgD,aAAT,CAAwB,aAAxB,CAAlB;AACAG,gBAAAA,WAAW,CAACC,WAAZ,CAAwBH,cAAxB,EAHqC,CAIrC;;AACAE,gBAAAA,WAAW,CAACJ,WAAZ,CAAwBf,YAAxB;AACH;;AAAA;AACJ;;AAAA;AACJ;AACJ;AACJ;AACJ,KA3DwB,CA4DzB;;;AACA,QAAG1C,YAAY,CAACE,SAAhB,EAA0B;AACtB,UAAI6D,SAAS,GAAGC,cAAc,EAA9B,CADsB,CACW;;AACjCjE,MAAAA,KAAK,CAACN,4BAAN,CAAmCsE,SAAnC;AACH;;AAAA;AAEJ,GAlED;;AAoEA,QAAME,aAAa,GAAGC,IAAI,IAAE;AACxB,YAAQA,IAAR;AACI,WAAK,WAAL;AACIjE,QAAAA,eAAe,iCACRD,YADQ;AAEXG,UAAAA,SAAS,EAAC;AAFC,WAAf;AAIA;;AACJ,WAAK,cAAL;AACIF,QAAAA,eAAe,iCACRD,YADQ;AAEXI,UAAAA,YAAY,EAAC;AAFF,WAAf;AAIA;;AACJ,WAAK,OAAL;AACIH,QAAAA,eAAe,iCACRD,YADQ;AAEXK,UAAAA,KAAK,EAAC;AAFK,WAAf;AAIA;;AACJ;AACIN,QAAAA,KAAK,CAACJ,sBAAN;AACAM,QAAAA,eAAe,CAAC;AACZC,UAAAA,SAAS,EAAC,KADE;AAEZC,UAAAA,SAAS,EAAC,EAFE;AAGZC,UAAAA,YAAY,EAAC,EAHD;AAIZC,UAAAA,KAAK,EAAC,EAJM;AAKZC,UAAAA,QAAQ,EAAC;AALG,SAAD,CAAf;AAOJ;AA5BJ;AA8BH,GA/BD;;AAiCA,QAAM6D,kBAAkB,GAAG,MAAI;AAC3BzD,IAAAA,QAAQ,CAACqB,sBAAT,CAAgCtD,WAAW,CAAC2F,kBAA5C,EAAgE,CAAhE,EAAmElC,SAAnE,CAA6EC,MAA7E,CAAoF1D,WAAW,CAAC4F,YAAhG;AACH,GAFD;;AAIA,QAAML,cAAc,GAAG,MAAI;AACvB,QAAIM,GAAG,GAAG,SAAV,CADuB,CAEvB;;AACA,QAAGtE,YAAY,CAACM,QAAb,KAAwB,EAA3B,EAA+B,OAAOgE,GAAG,IAAK,WAAUtE,YAAY,CAACM,QAAS,EAA/C;AAE/B,QAAIH,SAAS,GAAGH,YAAY,CAACG,SAA7B;AAAA,QACIC,YAAY,GAAGJ,YAAY,CAACI,YADhC;AAAA,QAEIC,KAAK,GAAGL,YAAY,CAACK,KAFzB;;AAIA,QAAGF,SAAS,IAAIA,SAAS,KAAK,EAA9B,EAAiC;AAC7BmE,MAAAA,GAAG,IAAK,cAAatE,YAAY,CAACG,SAAU,EAA5C;AACH;;AACD,QAAGH,YAAY,CAACI,YAAb,IAA6BJ,YAAY,CAACI,YAAb,KAA8B,EAA9D,EAAiE;AAC7D,UAAGD,SAAS,KAAI,EAAhB,EAAmB;AACfmE,QAAAA,GAAG,IAAK,iBAAgBtE,YAAY,CAACI,YAAa,EAAlD;AACH,OAFD,MAEK;AACDkE,QAAAA,GAAG,IAAK,iBAAgBtE,YAAY,CAACI,YAAa,EAAlD;AACH;AACJ;;AACD,QAAGC,KAAK,IAAIA,KAAK,KAAK,EAAtB,EAAyB;AACrB,UAAGF,SAAS,KAAK,EAAd,IAAoBC,YAAY,KAAK,EAAxC,EAA2C;AACvCkE,QAAAA,GAAG,IAAK,UAAStE,YAAY,CAACK,KAAM,EAApC;AACH,OAFD,MAEK;AACDiE,QAAAA,GAAG,IAAK,UAAStE,YAAY,CAACK,KAAM,EAApC;AACH;AACJ;;AACD,WAAOiE,GAAP;AACH,GA3BD;;AA6BA,QAAMC,WAAW,GAAG,MAAI;AACpB,QAAItC,OAAO,GAAGvB,QAAQ,CAACqB,sBAAT,CAAgCtD,WAAW,CAAC2F,kBAA5C,EAAgE,CAAhE,CAAd;AACAnC,IAAAA,OAAO,CAACC,SAAR,CAAkBsC,MAAlB,CAAyB/F,WAAW,CAACgG,IAArC;AACA/D,IAAAA,QAAQ,CAAC+B,cAAT,CAAwB,qBAAxB,EAA+CP,SAA/C,CAAyDsC,MAAzD,CAAgE/F,WAAW,CAACiG,KAA5E;AACH,GAJD;;AAMA,SACI;AAAK,IAAA,SAAS,EAAEjG,WAAW,CAAC2F,kBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAQ,IAAA,SAAS,EAAE3F,WAAW,CAACkG,gBAA/B;AAAiD,IAAA,OAAO,EAAEJ,WAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,eAAD;AAAiB,IAAA,EAAE,EAAC,qBAApB;AAA0C,IAAA,IAAI,EAAEzF,cAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADJ,EAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACMiB,KAAK,CAACmB,iBAAN,CAAwBC,UAAxB,CAAmCF,MAAnC,IAA2C,CAA3C,IAAgDlB,KAAK,CAACqB,mBAAN,CAA0BC,aAA1B,CAAwCJ,MAAxC,IAAgD,CAAhG,IAAqGlB,KAAK,CAACgB,aAAN,CAAoBC,MAApB,CAA2BC,MAA3B,IAAmC,CAAzI,GAA4I,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAA5I,GACG,4BACMjB,YAAY,CAACE,SAAd,GAAyB;AAAQ,IAAA,SAAS,EAAC,sBAAlB;AAAyC,IAAA,OAAO,EAAE+D,aAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACtB,MAAC,eAAD;AAAiB,IAAA,IAAI,EAAEpF,OAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADsB,qBAAzB,GAES,IAHd,EAII,MAAC,eAAD;AAAiB,IAAA,IAAI,EAAED,OAAvB;AAAgC,IAAA,SAAS,EAAEH,WAAW,CAACmG,oBAAvD;AAA6E,IAAA,OAAO,EAAET,kBAAtF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJJ,EAKI;AAAI,IAAA,SAAS,EAAE1F,WAAW,CAACoG,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eALJ,EAMI;AAAI,IAAA,SAAS,EAAEpG,WAAW,CAACqG,KAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQ/E,KAAK,CAACmB,iBAAN,CAAwBC,UAAxB,CAAmC4D,GAAnC,CAAuCC,GAAG,IACtC;AAAI,IAAA,GAAG,EAAEA,GAAG,CAACC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAExG,WAAW,CAACuD,WAA5B;AAAyC,IAAA,IAAI,EAAG,aAAYgD,GAAG,CAACC,WAAY,EAA5E;AAA+E,IAAA,OAAO,EAAE,MAAIxD,aAAa,CAAC,WAAD,EAAc,GAAEuD,GAAG,CAACC,WAAY,EAAhC,CAAzG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAM,IAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA8BD,GAAG,CAAC7E,SAAlC,CADJ,CADJ,EAII,MAAC,eAAD;AAAiB,IAAA,IAAI,EAAEvB,OAAvB;AAAgC,IAAA,SAAS,EAAEH,WAAW,CAAC4D,iBAAZ,GAAgC,GAAhC,GAAuC,QAAlF;AAA2F,IAAA,OAAO,EAAE,MAAI4B,aAAa,CAAC,WAAD,CAArH;AAAoI,IAAA,EAAE,EAAG,mBAAkBe,GAAG,CAACC,WAAY,EAA3K;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJJ,CADJ,CAFR,CANJ,EAoBI;AAAI,IAAA,SAAS,EAAExG,WAAW,CAACoG,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBApBJ,EAqBI;AAAI,IAAA,SAAS,EAAEpG,WAAW,CAACqG,KAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQ/E,KAAK,CAACqB,mBAAN,CAA0BC,aAA1B,CAAwC0D,GAAxC,CAA4CG,EAAE,IAC1C;AAAI,IAAA,GAAG,EAAEA,EAAE,CAACC,cAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAE1G,WAAW,CAACuD,WAA5B;AAAyC,IAAA,IAAI,EAAG,gBAAekD,EAAE,CAACC,cAAe,EAAjF;AAAoF,IAAA,OAAO,EAAE,MAAI1D,aAAa,CAAC,cAAD,EAAiB,GAAEyD,EAAE,CAACC,cAAe,EAArC,CAA9G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAM,IAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA8BD,EAAE,CAAC9E,YAAjC,CADJ,CADJ,EAII,MAAC,eAAD;AAAiB,IAAA,IAAI,EAAExB,OAAvB;AAAgC,IAAA,SAAS,EAAEH,WAAW,CAAC4D,iBAAZ,GAAgC,GAAhC,GAAuC,QAAlF;AAA2F,IAAA,OAAO,EAAE,MAAI4B,aAAa,CAAC,cAAD,CAArH;AAAuI,IAAA,EAAE,EAAG,SAAS,gBAAeiB,EAAE,CAACC,cAAe,EAAE,EAAxL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJJ,CADJ,CAFR,CArBJ,EAkCI;AAAI,IAAA,SAAS,EAAE1G,WAAW,CAACoG,cAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAlCJ,EAmCI;AAAI,IAAA,EAAE,EAAC,YAAP;AAAoB,IAAA,SAAS,EAAEpG,WAAW,CAAC2G,eAAZ,GAA6B,GAA7B,GAAmC3G,WAAW,CAACqG,KAA9E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQ/E,KAAK,CAACgB,aAAN,CAAoBC,MAApB,CAA2B+D,GAA3B,CAA+B,CAAC1E,KAAD,EAAOyB,GAAP,KAC1BA,GAAG,GAAC,CAAL,GAAQ,KAAR,GACA;AAAI,IAAA,GAAG,EAAEzB,KAAK,CAAC6C,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,SAAS,EAAEzE,WAAW,CAACuD,WAA5B;AAAyC,IAAA,IAAI,EAAG,SAAQ3B,KAAK,CAAC6C,OAAQ,EAAtE;AAAyE,IAAA,OAAO,EAAE,MAAIzB,aAAa,CAAC,OAAD,EAAU,GAAEpB,KAAK,CAAC6C,OAAQ,EAA1B,CAAnG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAM,IAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA8B7C,KAAK,CAACA,KAApC,CADJ,CADJ,EAII,MAAC,eAAD;AAAiB,IAAA,IAAI,EAAEzB,OAAvB;AAAgC,IAAA,SAAS,EAAEH,WAAW,CAAC4D,iBAAZ,GAAgC,GAAhC,GAAuC,QAAlF;AAA2F,IAAA,OAAO,EAAE,MAAI4B,aAAa,CAAC,OAAD,CAArH;AAAgI,IAAA,EAAE,EAAG,eAAc5D,KAAK,CAAC6C,OAAQ,EAAjK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJJ,CAFJ,CAFR,CAnCJ,EAgDI;AAAQ,IAAA,OAAO,EAAE,MAAI1C,cAAc,CAAC,IAAD,CAAnC;AAA2C,IAAA,SAAS,EAAC,eAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAhDJ,CAFR,CAJJ,EA0DM,CAACD,WAAF,GAAe,IAAf,GACG,MAAC,KAAD;AAAO,IAAA,UAAU,EAAEE,YAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,UAAD;AAAY,IAAA,UAAU,EAAEA,YAAxB;AAAsC,IAAA,aAAa,EAAEgB,aAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CA3DR,CADJ;AAkEH,CAnSD;;AAqSA,MAAM4D,eAAe,GAAG,CAAC;AAACtE,EAAAA,aAAD;AAAeuE,EAAAA,mBAAf;AAAmCpE,EAAAA,iBAAnC;AAAqDE,EAAAA;AAArD,CAAD,KAA6E;AACjG,SAAO;AACHL,IAAAA,aADG;AAEHuE,IAAAA,mBAFG;AAGHpE,IAAAA,iBAHG;AAIHE,IAAAA;AAJG,GAAP;AAMH,CAPD;;AASA,MAAMmE,kBAAkB,GAAG;AACvBhG,EAAAA,gBADuB;AAEvBE,EAAAA,4BAFuB;AAGvBE,EAAAA,sBAHuB;AAIvBC,EAAAA,oBAJuB;AAKvBC,EAAAA;AALuB,CAA3B;AAQA,eAAeb,OAAO,CAACqG,eAAD,EAAiBE,kBAAjB,CAAP,CAA4CzF,MAA5C,CAAf","sourcesContent":["import React, { useState,useEffect } from 'react';\r\nimport FiltroStyle from './Filtro.module.css';\r\nimport Modal from '../Modal';\r\nimport ModalMarca from '../ModalMarca';\r\nimport { faTimes,faBroom,faChevronRight } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { connect } from 'react-redux';\r\nimport * as subproductosActions from '../../../store/actions/subproductosActions';\r\nimport * as marcasActions from '../../../store/actions/marcasActions';\r\nimport * as categoriasActions from '../../../store/actions/categoriasAction';\r\nimport * as subcategoriasActions from '../../../store/actions/subcategoriasAction';\r\nimport Loader from '../Loader';\r\n\r\nconst {traerTodas:marcasTraerTodas} = marcasActions;\r\nconst {filtrarProductos:subproductosFiltrarProductos,traerTodos:subproductosTraerTodos} = subproductosActions;\r\nconst {traerTodas:categoriasTraerTodas} = categoriasActions;\r\nconst {traerTodas:subcategoriaTraerTodas} = subcategoriasActions;\r\n\r\nconst Filtro = (props) => {\r\n\r\n    //state for the filters\r\n    const [estadoFiltro, setEstadoFiltro] = useState({\r\n        filtrando:false,\r\n        categoria:'',\r\n        subcategoria:'',\r\n        marca:'',\r\n        buscador:''\r\n    });\r\n\r\n    //manejo de Modal marcas\r\n    const [modalIsOpen, setModalIsOpen] = useState(false);\r\n    const onCloseModal = ()=>{\r\n        document.getElementsByTagName('body')[0].style.overflowY = 'scroll';\r\n        setModalIsOpen(false);\r\n    }\r\n\r\n    //loop de efecto para ejecutar solo una vez cuando el componente se monte en el caso de que se este filtrando directo desde la url\r\n    useEffect(() => {\r\n        getData();\r\n    },[]);\r\n        \r\n    const getData = async()=>{\r\n        if(props.marcasReducer.marcas.length===0){\r\n            await props.marcasTraerTodas();\r\n        }\r\n        if(props.categoriasReducer.categorias.length===0){\r\n            await props.categoriasTraerTodas();\r\n        }\r\n        if(props.subcategoriaReducer.subcategorias.length===0){\r\n            await props.subcategoriaTraerTodas();\r\n        }\r\n        if(props.location !== '/productos'){\r\n            activarFiltroPorUrl();\r\n        }\r\n    }\r\n\r\n    //loop de efecto para hacer render cada vez que se agrega o elimina un filtro\r\n    useEffect(() => {\r\n        switchItemActive();\r\n    }, [estadoFiltro]);\r\n\r\n    const activarFiltroPorUrl = ()=>{\r\n        return activarFiltro(props.query.type,props.query.index[1]);\r\n    }\r\n\r\n    const activarFiltro = (tipoFiltro,key)=>{\r\n        switch (tipoFiltro) {\r\n            case 'categoria':\r\n                setEstadoFiltro({\r\n                    ...estadoFiltro,\r\n                    categoria:key,\r\n                    buscador:'',\r\n                    filtrando:true\r\n                });\r\n                break;\r\n            case 'subcategoria':\r\n                setEstadoFiltro({\r\n                    ...estadoFiltro,\r\n                    subcategoria:key,\r\n                    buscador:'',\r\n                    filtrando:true\r\n                })\r\n                break;\r\n            case 'marca':\r\n                setEstadoFiltro({\r\n                    ...estadoFiltro,\r\n                    marca:key,\r\n                    buscador:'',\r\n                    filtrando:true\r\n                })\r\n                break;\r\n            case 'buscador':\r\n                setEstadoFiltro({\r\n                    ...estadoFiltro,\r\n                    buscador:key,\r\n                    filtrando:true\r\n                });\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    const switchItemActive = ()=>{\r\n        // console.log(estadoFiltro);\r\n\r\n        for (let index = 0; index < document.getElementsByClassName(FiltroStyle.item_filtro).length; index++) {\r\n            const element = document.getElementsByClassName(FiltroStyle.item_filtro)[index];\r\n            element.classList.remove(FiltroStyle.active);\r\n            document.getElementsByClassName(FiltroStyle.icon_close_filtro)[index].classList.add('d-none');\r\n        };\r\n        if(!estadoFiltro.filtrando) return;\r\n        //si no hay nada en buscador, puedo setear un active en algun elemento de la lista\r\n        if(estadoFiltro.buscador.trim()===''){\r\n            //recorro el state para obtener las claves y agregar active el elemento correspondiente\r\n            for (const key in estadoFiltro) {\r\n                if(estadoFiltro[key] && estadoFiltro[key]!=='' && estadoFiltro[key]!==true){\r\n                    //console.log(key);\r\n                    //console.log(estadoFiltro[key]);\r\n                    if(document.getElementsByName(`${key}-${estadoFiltro[key]}`)[0]){//pregunto si existe el elemento con el name del filtro para agregarle el active, si no existe lo creo. (si no existe es porque viene desde modal de marcas)\r\n                        document.getElementsByName(`${key}-${estadoFiltro[key]}`)[0].classList.add(FiltroStyle.active);\r\n                        document.getElementById(`close-${key}-${estadoFiltro[key]}`).classList.remove('d-none');\r\n                    }else{\r\n                        if(estadoFiltro.marca!==''){\r\n                            //creo los elementos del item\r\n                            let newItemMarca = document.createElement('li');\r\n                            let divItemMarca = document.createElement('div');\r\n                            let spanItemMarca = document.createElement('span');\r\n                            let iconClose = document.createElement('svg');\r\n\r\n                            let marcaName = props.marcasReducer.marcas.filter(res=>res.idMarca == estadoFiltro.marca);\r\n                            console.log(marcaName);\r\n                            //asigno las clases, atributos y eventos necesarios.\r\n                            divItemMarca.className =`${FiltroStyle.item_filtro} ${FiltroStyle.active}`;\r\n                            divItemMarca.setAttribute('name',`marca-${estadoFiltro.marca}`);\r\n                            divItemMarca.addEventListener('click',()=>activarFiltro('marca',estadoFiltro.marca));\r\n                            spanItemMarca.className = 'text-muted';\r\n                            spanItemMarca.innerHTML = estadoFiltro.marca;\r\n    \r\n                            iconClose.innerHTML = `\r\n                                <svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"times\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewbox=\"0 0 352 512\" class=\"svg-inline--fa fa-times fa-w-11 Filtro_icon_close_filtro__1xlv5\" id=\"close-marca-${estadoFiltro.marca}\">\r\n                                    <path fill=\"currentColor\" d=\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\"></path>\r\n                                </svg>\r\n                            `;\r\n\r\n                            //voy ubicando los elementos dentro de cada padre\r\n                            divItemMarca.appendChild(spanItemMarca);\r\n                            newItemMarca.appendChild(divItemMarca);\r\n                            newItemMarca.appendChild(iconClose);\r\n                            \r\n                            //Obtengo el primer item de la lista y lo elimino, para tener siempre la misma cantidad de marcas en la lista.\r\n                            if(document.querySelector(`#listaMarca`)){\r\n                                let firstItemMarca = document.querySelector(`#listaMarca`).children[0];\r\n                                let listaMarcas = document.querySelector(`#listaMarca`);\r\n                                listaMarcas.removeChild(firstItemMarca);\r\n                                //ahora agrego el item creado a la lista\r\n                                listaMarcas.appendChild(newItemMarca);\r\n                            };\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        //la primera vez que se carga el componente, filtrando es false, por eso pregunto para que no se ejecuta la funcion de ir a filtrar apenas se monte el componente. Sino que se ejecute cuando de verdad se quiera filtrar.\r\n        if(estadoFiltro.filtrando){\r\n            let urlFiltro = armarUrlFiltro();//armo la url que mando a la api para traer los resultados de lo filtrado.\r\n            props.subproductosFiltrarProductos(urlFiltro);\r\n        };\r\n        \r\n    }\r\n\r\n    const limpiarFiltro = tipo=>{\r\n        switch (tipo) {\r\n            case 'categoria':\r\n                setEstadoFiltro({\r\n                    ...estadoFiltro,\r\n                    categoria:''\r\n                });\r\n                break;\r\n            case 'subcategoria':\r\n                setEstadoFiltro({\r\n                    ...estadoFiltro,\r\n                    subcategoria:''\r\n                });\r\n                break;\r\n            case 'marca':\r\n                setEstadoFiltro({\r\n                    ...estadoFiltro,\r\n                    marca:''\r\n                });\r\n                break;\r\n            default:\r\n                props.subproductosTraerTodos();\r\n                setEstadoFiltro({\r\n                    filtrando:false,\r\n                    categoria:'',\r\n                    subcategoria:'',\r\n                    marca:'',\r\n                    buscador:''\r\n                });\r\n            break;\r\n        }\r\n    }\r\n\r\n    const closeFiltrosMobile = ()=>{\r\n        document.getElementsByClassName(FiltroStyle.filtros__contanier)[0].classList.remove(FiltroStyle.show_filtros);\r\n    }\r\n\r\n    const armarUrlFiltro = ()=>{\r\n        let url = 'filtrar';\r\n        //si buscador viene true, es porque viene desde el buscador del menu o modal de buscador(mobile).\r\n        if(estadoFiltro.buscador!=='') return url += `?buscar=${estadoFiltro.buscador}`;\r\n\r\n        let categoria = estadoFiltro.categoria,\r\n            subcategoria = estadoFiltro.subcategoria,\r\n            marca = estadoFiltro.marca;\r\n        \r\n        if(categoria && categoria !== ''){\r\n            url += `?categoria=${estadoFiltro.categoria}`;\r\n        }\r\n        if(estadoFiltro.subcategoria && estadoFiltro.subcategoria !== ''){\r\n            if(categoria!== ''){\r\n                url += `&subcategoria=${estadoFiltro.subcategoria}`; \r\n            }else{\r\n                url += `?subcategoria=${estadoFiltro.subcategoria}`;\r\n            }\r\n        }\r\n        if(marca && marca !== ''){\r\n            if(categoria !== '' && subcategoria !== ''){\r\n                url += `?marca=${estadoFiltro.marca}`;\r\n            }else{\r\n                url += `&marca=${estadoFiltro.marca}`;\r\n            }\r\n        }\r\n        return url;\r\n    }\r\n\r\n    const showFiltros = ()=>{\r\n        let element = document.getElementsByClassName(FiltroStyle.filtros__contanier)[0];\r\n        element.classList.toggle(FiltroStyle.show);\r\n        document.getElementById('iconFiltroContainer').classList.toggle(FiltroStyle.rotar);\r\n    }\r\n\r\n    return (\r\n        <div className={FiltroStyle.filtros__contanier}>\r\n            <button className={FiltroStyle.btn_close_filtro} onClick={showFiltros}>\r\n                <FontAwesomeIcon id=\"iconFiltroContainer\" icon={faChevronRight}/>\r\n            </button>\r\n            <div>\r\n                {(props.categoriasReducer.categorias.length==0 || props.subcategoriaReducer.subcategorias.length==0 || props.marcasReducer.marcas.length==0)?<Loader/>:\r\n                    <>  \r\n                        {(estadoFiltro.filtrando)?<button className=\"boton bg-yellow mb-3\" onClick={limpiarFiltro}>\r\n                            <FontAwesomeIcon icon={faBroom}/> Limpiar Filtros\r\n                        </button>:null}\r\n                        <FontAwesomeIcon icon={faTimes} className={FiltroStyle.cerrar_filtro_mobile} onClick={closeFiltrosMobile}/>\r\n                        <h4 className={FiltroStyle.titulo_filtros}>Mascota</h4>\r\n                        <ul className={FiltroStyle.lista}>\r\n                            {\r\n                                props.categoriasReducer.categorias.map(cat=>(\r\n                                    <li key={cat.idCategoria}>\r\n                                        <div className={FiltroStyle.item_filtro} name={`categoria-${cat.idCategoria}`} onClick={()=>activarFiltro('categoria',`${cat.idCategoria}`)}>\r\n                                            <span className=\"text-muted\">{cat.categoria}</span>\r\n                                        </div>\r\n                                        <FontAwesomeIcon icon={faTimes} className={FiltroStyle.icon_close_filtro + ' ' + `d-none`} onClick={()=>limpiarFiltro('categoria')} id={`close-categoria-${cat.idCategoria}`}/>\r\n                                    </li>\r\n                                ))\r\n                            }\r\n                        </ul>\r\n\r\n\r\n                        <h4 className={FiltroStyle.titulo_filtros}>Alimentos</h4>\r\n                        <ul className={FiltroStyle.lista}>\r\n                            {\r\n                                props.subcategoriaReducer.subcategorias.map(sc=>(\r\n                                    <li key={sc.idSubCategoria}>\r\n                                        <div className={FiltroStyle.item_filtro} name={`subcategoria-${sc.idSubCategoria}`} onClick={()=>activarFiltro('subcategoria',`${sc.idSubCategoria}`)}>\r\n                                            <span className=\"text-muted\">{sc.subcategoria}</span>\r\n                                        </div>\r\n                                        <FontAwesomeIcon icon={faTimes} className={FiltroStyle.icon_close_filtro + ' ' + `d-none`} onClick={()=>limpiarFiltro('subcategoria')} id={`close-${`subcategoria-${sc.idSubCategoria}`}`}/>\r\n                                    </li>\r\n                                ))\r\n                            }\r\n                        </ul>\r\n\r\n                        <h4 className={FiltroStyle.titulo_filtros}>Marca</h4>\r\n                        <ul id=\"listaMarca\" className={FiltroStyle.sinBorderBottom+ ' ' + FiltroStyle.lista}>\r\n                            {\r\n                                props.marcasReducer.marcas.map((marca,key)=>(\r\n                                    (key>3)?false:\r\n                                    <li key={marca.idMarca}>\r\n                                        <div className={FiltroStyle.item_filtro} name={`marca-${marca.idMarca}`} onClick={()=>activarFiltro('marca',`${marca.idMarca}`)}>\r\n                                            <span className=\"text-muted\">{marca.marca}</span>\r\n                                        </div>\r\n                                        <FontAwesomeIcon icon={faTimes} className={FiltroStyle.icon_close_filtro + ' ' + `d-none`} onClick={()=>limpiarFiltro('marca')} id={`close-marca-${marca.idMarca}`}/>\r\n                                    </li>\r\n                                ))\r\n                            }\r\n                        </ul>\r\n                        <button onClick={()=>setModalIsOpen(true)} className=\"boton bg-gris\">Ver todas</button>\r\n                    </>\r\n                }\r\n            </div>\r\n            {(!modalIsOpen)?null:\r\n                <Modal closeModal={onCloseModal}>\r\n                    <ModalMarca closeModal={onCloseModal} activarFiltro={activarFiltro}/>\r\n                </Modal>\r\n            }\r\n        </div>\r\n    );\r\n}\r\n\r\nconst mapStateToProps = ({marcasReducer,subproductosReducer,categoriasReducer,subcategoriaReducer})=>{\r\n    return {\r\n        marcasReducer,\r\n        subproductosReducer,\r\n        categoriasReducer,\r\n        subcategoriaReducer\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    marcasTraerTodas,\r\n    subproductosFiltrarProductos,\r\n    subproductosTraerTodos,\r\n    categoriasTraerTodas,\r\n    subcategoriaTraerTodas\r\n}\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(Filtro);"]},"metadata":{},"sourceType":"module"}