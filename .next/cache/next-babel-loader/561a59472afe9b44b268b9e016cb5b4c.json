{"ast":null,"code":"import { API, PUBLIC_URL } from '../../config/index';\nimport { VERIFICAR_SESION, LOGIN, LOGOUT, LOADING, ERROR, UPDATE_USER, UPDATE_PASSWORD, UPDATE_VENTAS } from '../types/usuarioTypes';\nexport const login = data => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    if (data.email.trim() === '' || data.password.trim() === '') {\n      return dispatch({\n        type: ERROR,\n        payload: 'Es necesario completar todos los campos'\n      });\n    }\n\n    let headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    return fetch(`${API}/login`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers\n    }).then(res => res.json()).then(response => {\n      if (response.ok) {\n        let objUsuario = {\n          nombre: response.usuario.nombre,\n          email: response.usuario.email,\n          foto: response.usuario.foto,\n          token: response.token,\n          address: response.usuario.ubicacion,\n          idUsuario: response.usuario.idUsuario,\n          lat: response.usuario.lat,\n          lon: response.usuario.lon,\n          telefono: response.usuario.telefono\n        };\n        localStorage.setItem('oliverpetshop_usuario', JSON.stringify(objUsuario));\n        dispatch({\n          type: LOGIN,\n          payload: localStorage.getItem('oliverpetshop_usuario')\n        });\n      } else {\n        return dispatch({\n          type: ERROR,\n          payload: response.info\n        });\n      }\n    });\n  } catch (error) {\n    console.log(error);\n    return dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const logout = () => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    localStorage.removeItem('oliverpetshop_usuario');\n    return dispatch({\n      type: LOGOUT\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const verificarSesion = (token = null) => async dispatch => {\n  try {\n    let dataUsuario = JSON.parse(localStorage.getItem('oliverpetshop_usuario'));\n\n    if (dataUsuario || token) {\n      // request para verificar que el token corresponda a una sesion activa\n      let headers = new Headers();\n      let tokenSend = token ? token : dataUsuario.token;\n      headers.append('token', tokenSend);\n      const request = await fetch(`${API}/verify-sesion`, {\n        method: 'GET',\n        headers\n      });\n\n      if (request.status != 200) {\n        return dispatch({\n          type: VERIFICAR_SESION,\n          payload: {\n            data: null,\n            logueado: false\n          }\n        });\n      }\n\n      return dispatch({\n        type: VERIFICAR_SESION,\n        payload: {\n          data: dataUsuario,\n          logueado: true\n        }\n      });\n    }\n\n    return dispatch({\n      type: VERIFICAR_SESION,\n      payload: {\n        data: null,\n        logueado: false\n      }\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const register = data => dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    let headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    return fetch(`${API}/register`, {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers\n    }).then(res => res.json()).then(response => {\n      if (response.ok) {\n        let objUsuario = {\n          nombre: response.usuario.nombre,\n          email: response.usuario.email,\n          foto: response.usuario.foto,\n          token: response.token,\n          address: response.usuario.address,\n          idUsuario: response.usuario.idUsuario\n        };\n        localStorage.setItem('oliverpetshop_usuario', JSON.stringify(objUsuario));\n        dispatch({\n          type: LOGIN,\n          payload: localStorage.getItem('oliverpetshop_usuario')\n        });\n      } else {\n        dispatch({\n          type: ERROR,\n          payload: response.info\n        });\n      }\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const singInWithGoogle = tokenId => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    let headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    return fetch(`${API}/google/tokensignin`, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify({\n        token: tokenId\n      })\n    }).then(res => res.json()).then(response => {\n      if (!response.ok) {\n        return dispatch({\n          type: ERROR,\n          payload: response.info\n        });\n      }\n\n      ;\n      let objUsuario = {\n        nombre: response.usuario.nombre,\n        email: response.usuario.email,\n        foto: response.usuario.foto,\n        token: response.token,\n        address: response.usuario.address,\n        idUsuario: response.usuario.idUsuario,\n        lat: response.usuario.lat,\n        lon: response.usuario.lon,\n        telefono: response.usuario.telefono\n      };\n      localStorage.setItem('oliverpetshop_usuario', JSON.stringify(objUsuario));\n      dispatch({\n        type: LOGIN,\n        payload: localStorage.getItem('oliverpetshop_usuario')\n      });\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const actualizarFoto = (data, id) => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    let headers = new Headers();\n    let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n    headers.append(\"token\", token);\n    const request = await fetch(`${API}/actualizarFotoUsuarioDesdeWeb/${id}`, {\n      method: 'PUT',\n      headers,\n      body: data\n    });\n    const dataRequest = await request.json();\n\n    if (dataRequest.ok) {\n      localStorage.setItem('oliverpetshop_usuario', JSON.stringify(dataRequest.user));\n      dispatch({\n        type: UPDATE_USER,\n        payload: dataRequest.user\n      });\n    }\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const actualizarUsuario = (data, id) => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    let headers = new Headers();\n    let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n    if (!token) return dispatch({\n      type: ERROR,\n      payload: 'Token incorrecto'\n    });\n    headers.append('token', token);\n    headers.append(\"Content-Type\", \"application/json\");\n    const request = await fetch(`${API}/actualizarUsuarioDesdeWeb/${id}`, {\n      method: 'PUT',\n      headers,\n      body: JSON.stringify(data)\n    });\n    if (request.status != 200) return dispatch({\n      type: ERROR,\n      payload: 'Ocurrio un error, ¡intentelo más tarde!'\n    });\n    const dataRequest = await request.json();\n\n    if (dataRequest.ok) {\n      localStorage.setItem('oliverpetshop_usuario', JSON.stringify(dataRequest.user));\n      return dispatch({\n        type: UPDATE_USER,\n        payload: dataRequest.user\n      });\n    }\n\n    return dispatch({\n      type: ERROR,\n      payload: dataRequest.info\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error.message\n    });\n  }\n};\nexport const actualizarAddress = (data, id) => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    let headers = new Headers();\n    let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n    if (!token) return dispatch({\n      type: ERROR,\n      payload: 'Token incorrecto'\n    });\n    headers.append('token', token);\n    headers.append(\"Content-Type\", \"application/json\");\n    const request = await fetch(`${API}/actualizarDireccion/${id}`, {\n      method: 'PUT',\n      headers,\n      body: JSON.stringify(data)\n    });\n    if (request.status != 200) return dispatch({\n      type: ERROR,\n      payload: 'Ocurrio un error, ¡intentelo más tarde!'\n    });\n    const dataRequest = await request.json();\n\n    if (dataRequest.ok) {\n      localStorage.setItem('oliverpetshop_usuario', JSON.stringify(dataRequest.usuario));\n      return dispatch({\n        type: UPDATE_USER,\n        payload: dataRequest.usuario\n      });\n    }\n\n    return dispatch({\n      type: ERROR,\n      payload: dataRequest.info\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: error.message\n    });\n  }\n};\nexport const sendEmailForResetPassword = idUsuario => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    let headers = new Headers();\n    let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n    if (!token) return dispatch({\n      type: ERROR,\n      payload: 'Token incorrecto'\n    });\n    headers.append('token', token);\n    headers.append(\"Content-Type\", \"application/json\");\n    const request = await fetch(`${API}/resetPassword`, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify({\n        idUsuario\n      })\n    });\n    if (request.status != 200) return dispatch({\n      type: ERROR,\n      payload: 'Ocurrio un error, ¡intentelo más tarde!'\n    });\n    const dataRequest = await request.json();\n\n    if (dataRequest.ok) {\n      return console.log(dataRequest);\n    }\n\n    return dispatch({\n      type: ERROR,\n      payload: dataRequest.info\n    });\n  } catch (error) {\n    dispatch({\n      type: ERROR,\n      payload: dataRequest.info\n    });\n  }\n};\nexport const updatePassword = (data, token) => async dispatch => {\n  dispatch({\n    type: LOADING\n  });\n\n  try {\n    if (data.confirmNewPassword === '' || data.newPassword === '') {\n      return dispatch({\n        type: ERROR,\n        payload: 'Los dos campos son obligarios.'\n      });\n    }\n\n    if (data.confirmNewPassword != data.newPassword) {\n      return dispatch({\n        type: ERROR,\n        payload: 'Las contraseñas no coinciden.'\n      });\n    }\n\n    let headers = new Headers();\n    headers.append('refresh-token', token);\n    headers.append(\"Content-Type\", \"application/json\");\n    const request = await fetch(`${API}/new-password`, {\n      method: 'PUT',\n      headers,\n      body: JSON.stringify(data)\n    });\n    if (request.status != 200) return dispatch({\n      type: ERROR,\n      payload: 'Ups, algo ha salido mal...'\n    });\n    dispatch({\n      type: UPDATE_PASSWORD\n    });\n    return setTimeout(() => {\n      window.location.assign(`${PUBLIC_URL}`);\n    }, 5000);\n  } catch (error) {\n    return dispatch({\n      type: ERROR,\n      payload: error\n    });\n  }\n};\nexport const traerVentas = () => async (dispatch, getState) => {\n  dispatch({\n    type: LOADING\n  });\n  let {\n    idUsuario,\n    token\n  } = getState().usuarioReducer.usuario;\n  let headers = new Headers();\n  headers.append('token', token);\n  const req = await fetch(`${API}/ventas/usuario/${idUsuario}`, {\n    headers\n  });\n  const response = await req.json();\n\n  if (req.status === 200) {\n    return dispatch({\n      type: UPDATE_VENTAS,\n      payload: response.info\n    });\n  }\n\n  return dispatch({\n    type: ERROR,\n    payload: response\n  });\n};","map":{"version":3,"sources":["/home/franco/desarrollo/proyecto_oliver/oliver-sitio/store/actions/usuarioActions.js"],"names":["API","PUBLIC_URL","VERIFICAR_SESION","LOGIN","LOGOUT","LOADING","ERROR","UPDATE_USER","UPDATE_PASSWORD","UPDATE_VENTAS","login","data","dispatch","type","email","trim","password","payload","headers","Headers","append","fetch","method","body","JSON","stringify","then","res","json","response","ok","objUsuario","nombre","usuario","foto","token","address","ubicacion","idUsuario","lat","lon","telefono","localStorage","setItem","getItem","info","error","console","log","logout","removeItem","verificarSesion","dataUsuario","parse","tokenSend","request","status","logueado","register","singInWithGoogle","tokenId","actualizarFoto","id","dataRequest","user","actualizarUsuario","message","actualizarAddress","sendEmailForResetPassword","updatePassword","confirmNewPassword","newPassword","setTimeout","window","location","assign","traerVentas","getState","usuarioReducer","req"],"mappings":"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","sourcesContent":["import {API,PUBLIC_URL} from '../../config/index';\nimport {VERIFICAR_SESION,LOGIN,LOGOUT,LOADING,ERROR,UPDATE_USER,UPDATE_PASSWORD, UPDATE_VENTAS} from '../types/usuarioTypes';\n\nexport const login = (data)=>async(dispatch)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        if(data.email.trim() === '' || data.password.trim() === ''){\n            return dispatch({\n                type:ERROR,\n                payload:'Es necesario completar todos los campos'\n            })\n        }\n        let headers = new Headers();\n        headers.append(\"Content-Type\", \"application/json\");\n        return fetch(`${API}/login`,{\n            method:'POST',\n            body:JSON.stringify(data),\n            headers\n        }).then(res=>res.json()).then(response=>{\n            if(response.ok){\n                let objUsuario = {\n                    nombre:response.usuario.nombre,\n                    email:response.usuario.email,\n                    foto:response.usuario.foto,\n                    token:response.token,\n                    address:response.usuario.ubicacion,\n                    idUsuario:response.usuario.idUsuario,\n                    lat:response.usuario.lat,\n                    lon:response.usuario.lon,\n                    telefono:response.usuario.telefono\n                }\n                localStorage.setItem('oliverpetshop_usuario',JSON.stringify(objUsuario));\n                dispatch({\n                    type:LOGIN,\n                    payload:localStorage.getItem('oliverpetshop_usuario')\n                })\n            }else{\n                return dispatch({\n                    type:ERROR,\n                    payload:response.info\n                })\n            }\n        })\n    } catch (error) {\n        console.log(error);\n        return dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const logout = ()=>async(dispatch)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        localStorage.removeItem('oliverpetshop_usuario');\n        return dispatch({\n            type:LOGOUT\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const verificarSesion=(token=null)=>async(dispatch)=>{\n    try {\n        let dataUsuario = JSON.parse(localStorage.getItem('oliverpetshop_usuario'));\n        if(dataUsuario || token){\n            // request para verificar que el token corresponda a una sesion activa\n            let headers = new Headers();\n            let tokenSend = (token)?token:dataUsuario.token;\n            headers.append('token',tokenSend);\n            const request = await fetch(`${API}/verify-sesion`,{\n                method:'GET',\n                headers\n            });\n            if(request.status!=200){\n                return dispatch({\n                    type:VERIFICAR_SESION,\n                    payload:{data:null,logueado:false}\n                })\n            }\n            return dispatch({\n                type:VERIFICAR_SESION,\n                payload:{data:dataUsuario,logueado:true}\n            })\n        }\n        return dispatch({\n            type:VERIFICAR_SESION,\n            payload:{data:null,logueado:false}\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const register=(data)=>(dispatch)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        let headers = new Headers();\n        headers.append(\"Content-Type\", \"application/json\");\n        return fetch(`${API}/register`,{\n            method:'POST',\n            body:JSON.stringify(data),\n            headers\n        }).then(res=>res.json()).then(response=>{\n            if(response.ok){\n                let objUsuario = {\n                    nombre:response.usuario.nombre,\n                    email:response.usuario.email,\n                    foto:response.usuario.foto,\n                    token:response.token,\n                    address:response.usuario.address,\n                    idUsuario:response.usuario.idUsuario\n                }\n                localStorage.setItem('oliverpetshop_usuario',JSON.stringify(objUsuario));\n                dispatch({\n                    type:LOGIN,\n                    payload:localStorage.getItem('oliverpetshop_usuario')\n                });\n            }else{\n                dispatch({\n                    type:ERROR,\n                    payload:response.info\n                })\n            }\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const singInWithGoogle = tokenId => async(dispatch)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        let headers = new Headers();\n        headers.append(\"Content-Type\", \"application/json\");\n        return fetch(`${API}/google/tokensignin`,{\n            method:'POST',\n            headers,\n            body:JSON.stringify({token:tokenId})\n        }).then(res=>res.json()).then(response=>{\n            if(!response.ok){\n                return dispatch({\n                    type:ERROR,\n                    payload:response.info\n                })\n            };\n            let objUsuario = {\n                nombre:response.usuario.nombre,\n                email:response.usuario.email,\n                foto:response.usuario.foto,\n                token:response.token,\n                address:response.usuario.address,\n                idUsuario:response.usuario.idUsuario,\n                lat:response.usuario.lat,\n                lon:response.usuario.lon,\n                telefono:response.usuario.telefono\n            }\n            localStorage.setItem('oliverpetshop_usuario',JSON.stringify(objUsuario));\n            dispatch({\n                type:LOGIN,\n                payload:localStorage.getItem('oliverpetshop_usuario')\n            });\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const actualizarFoto = (data,id) =>async(dispatch)=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        let headers = new Headers();\n        let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n        headers.append(\"token\", token);\n        const request = await fetch(`${API}/actualizarFotoUsuarioDesdeWeb/${id}`,{\n            method:'PUT',\n            headers,\n            body:data\n        });\n        const dataRequest = await request.json();\n        if(dataRequest.ok){\n            localStorage.setItem('oliverpetshop_usuario',JSON.stringify(dataRequest.user));\n            dispatch({\n                type:UPDATE_USER,\n                payload:dataRequest.user\n            })\n        }\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error\n        })\n    }\n}\n\nexport const actualizarUsuario = (data,id)=>async dispatch=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        let headers = new Headers();\n        let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n        if(!token) return dispatch({type:ERROR,payload:'Token incorrecto'});\n        headers.append('token',token);\n        headers.append(\"Content-Type\", \"application/json\");\n        const request = await fetch(`${API}/actualizarUsuarioDesdeWeb/${id}`,{\n            method:'PUT',\n            headers,\n            body:JSON.stringify(data)\n        });\n        if(request.status!=200) return dispatch({type:ERROR,payload:'Ocurrio un error, ¡intentelo más tarde!'})\n        const dataRequest = await request.json();\n        if(dataRequest.ok){\n            localStorage.setItem('oliverpetshop_usuario',JSON.stringify(dataRequest.user));\n            return dispatch({\n                type:UPDATE_USER,\n                payload:dataRequest.user\n            })\n        }\n        return dispatch({\n            type:ERROR,\n            payload:dataRequest.info\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error.message\n        })\n    }\n}\n\nexport const actualizarAddress = (data,id)=>async dispatch=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        let headers = new Headers();\n        let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n        if(!token) return dispatch({type:ERROR,payload:'Token incorrecto'});\n        headers.append('token',token);\n        headers.append(\"Content-Type\", \"application/json\");\n        const request = await fetch(`${API}/actualizarDireccion/${id}`,{\n            method:'PUT',\n            headers,\n            body:JSON.stringify(data)\n        });\n        if(request.status!=200) return dispatch({type:ERROR,payload:'Ocurrio un error, ¡intentelo más tarde!'})\n        const dataRequest = await request.json();\n        if(dataRequest.ok){\n            localStorage.setItem('oliverpetshop_usuario',JSON.stringify(dataRequest.usuario));\n            return dispatch({\n                type:UPDATE_USER,\n                payload:dataRequest.usuario\n            })\n        }\n        return dispatch({\n            type:ERROR,\n            payload:dataRequest.info\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:error.message\n        }) \n    }\n}\n\nexport const sendEmailForResetPassword = idUsuario=> async dispatch=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        let headers = new Headers();\n        let token = JSON.parse(localStorage.getItem('oliverpetshop_usuario')).token;\n        if(!token) return dispatch({type:ERROR,payload:'Token incorrecto'});\n        headers.append('token',token);\n        headers.append(\"Content-Type\", \"application/json\");\n        const request = await fetch(`${API}/resetPassword`,{\n            method:'POST',\n            headers,\n            body:JSON.stringify({idUsuario})\n        });\n        if(request.status!=200) return dispatch({type:ERROR,payload:'Ocurrio un error, ¡intentelo más tarde!'})\n        const dataRequest = await request.json();\n        if(dataRequest.ok){\n            return console.log(dataRequest);\n        }\n        return dispatch({\n            type:ERROR,\n            payload:dataRequest.info\n        })\n    } catch (error) {\n        dispatch({\n            type:ERROR,\n            payload:dataRequest.info\n        })\n    }\n}\n\nexport const updatePassword = (data,token) => async dispatch=>{\n    dispatch({\n        type:LOADING\n    });\n    try {\n        if(data.confirmNewPassword === '' || data.newPassword ===''){\n            return dispatch({\n                type:ERROR,\n                payload:'Los dos campos son obligarios.'\n            });\n        }\n        if(data.confirmNewPassword != data.newPassword){\n            return dispatch({\n                type:ERROR,\n                payload:'Las contraseñas no coinciden.'\n            });\n        }\n        let headers = new Headers();\n        headers.append('refresh-token',token);\n        headers.append(\"Content-Type\", \"application/json\");\n        const request = await fetch(`${API}/new-password`,{\n            method:'PUT',\n            headers,\n            body:JSON.stringify(data)\n        });\n        if(request.status!=200) return dispatch({\n            type:ERROR,\n            payload:'Ups, algo ha salido mal...'\n        });\n        dispatch({\n            type:UPDATE_PASSWORD\n        });\n        return setTimeout(() => {\n            window.location.assign(`${PUBLIC_URL}`);\n        }, 5000);\n    } catch (error) {\n        return dispatch({\n            type:ERROR,\n            payload:error\n        });\n    }\n}\n\nexport const traerVentas = () => async (dispatch,getState) =>{\n    dispatch({\n        type:LOADING\n    });\n    let {idUsuario,token} = getState().usuarioReducer.usuario;\n    let headers = new Headers();\n    headers.append('token',token);\n    const req = await fetch(`${API}/ventas/usuario/${idUsuario}`,{headers});\n    const response = await req.json();\n    if(req.status === 200){\n        return dispatch({\n            type:UPDATE_VENTAS,\n            payload:response.info\n        })\n    }\n    return dispatch({\n        type:ERROR,\n        payload:response\n    })\n}"]},"metadata":{},"sourceType":"module"}