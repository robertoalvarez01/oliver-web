{"ast":null,"code":"var _jsxFileName = \"/home/franco/desarrollo/proyecto_oliver/oliver-sitio/pages/checkout/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport CardUbicacion from '../../src/components/CardUbicacion/index';\nimport OpcionesEnvio from '../../src/components/OpcionesEnvio';\nimport ZonaEnvio from '../../src/components/ZonaEnvio';\nimport Head from '../../src/components/Head';\nimport DetalleProductos from '../../src/components/DetalleProductos';\nimport Error from '../../src/components/Error';\nimport { connect } from 'react-redux';\nimport * as usuarioActions from '../../store/actions/usuarioActions';\nimport { API } from '../../config/index';\nimport Loader from '../../src/components/Loader/index';\nimport MediosDePago from '../../src/components/MediosDePago';\nimport Router from 'next/router';\nimport Modal from '../../src/components/Modal'; //import FormVenta from '../../src/components/FormVenta';\n\nconst Swal = require('sweetalert2');\n\nconst {\n  verificarSesion\n} = usuarioActions;\n\nconst Checkout = props => {\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: modalIsOpen,\n    1: setModalIsOpen\n  } = useState(false); //modal para mostrar el form de datos de tarjeta\n\n  useEffect(() => {\n    props.verificarSesion();\n    document.getElementsByTagName('body')[0].style.overflowY = 'scroll';\n  }, []);\n\n  const handleClick = () => {\n    const {\n      usuario\n    } = props.usuarioReducer;\n    const {\n      tipos: envio\n    } = props.enviosReducer;\n    const {\n      zona\n    } = props.zonasReducer;\n    const {\n      tipoEnvio,\n      idZona,\n      idMedioPago,\n      total,\n      subtotal,\n      productos,\n      porcentaje_descuento,\n      descuento,\n      totalEnvio\n    } = props.ventaReducer;\n\n    if (!envio.local) {\n      if (!usuario.address || usuario.address === '') return setError('Es obligatorio completar tu ubicación.');\n      if (!zona) return setError('En caso de no retirarlo por nuestro local, es obligatorio completar la zona de envío.');\n    }\n\n    setError(false);\n    setLoading(true);\n    const {\n      idUsuario,\n      token,\n      nombre,\n      email,\n      telefono,\n      address\n    } = usuario;\n    let f = new Date();\n    let mes = f.getMonth() < 10 ? `0${f.getMonth() + 1}` : `${f.getMonth()}`;\n    let dia = f.getDate() < 10 ? `0${f.getDate()}` : `${f.getDate()}`;\n    let fecha = `${f.getFullYear()}-${mes}-${dia}`;\n    let dataToRequest = {\n      envio: {\n        idZona,\n        tipo: tipoEnvio\n      },\n      venta: {\n        subtotal,\n        porcentaje_descuento,\n        descuento,\n        total,\n        idUsuario,\n        productos,\n        fecha,\n        operacion_id: null,\n        idMedioPago,\n        totalEnvio\n      },\n      usuario: {\n        nombre,\n        email,\n        telefono,\n        address\n      }\n    };\n\n    if (idMedioPago == '1') {\n      //guardo data de envio para luego de hacer el checkout de mercado pago, envio los datos al servidor para registrar la venta con el envio correspondiente.\n      //localStorage.setItem('dataEnvio',JSON.stringify({tipo:tipoEnvio,zona:idZona}));\n      let headers = new Headers();\n      headers.append('Authorization', `Bearer APP_USR-2687910292298842-062215-dedefffbf200c367904e03c489d2cbdc-779530591`);\n      headers.append(\"Content-Type\", \"application/json\"); // fetch(`${API}/mercadopago`,{\n      //     method:'POST',\n      //     headers,\n      //     body:JSON.stringify(dataToRequest)\n      // }).then(res=>res.json()).then(datamp=>{\n      //     // console.log(datamp);\n      //     const {response} = datamp.info;\n      //     setLoading(false);\n      //     window.location.assign(response.init_point);\n      // }).catch(err=>{\n      //     console.log(err);\n      //     setLoading(false);\n      //     setError(err.message);\n      // })\n      // console.log(dataToRequest);\n\n      let preference = {\n        items: [{\n          id: \"1976\",\n          category_id: \"\",\n          currency_id: \"ARS\",\n          description: \"Complete Cachorros Razas Pequeñas (Cachorro Pequeño)\",\n          picture_url: \"https://storage.googleapis.com/web-oliver/cachorros-raza-pequena.jpg\",\n          title: \"COMPLETE JUNIOR razas pequeñas x 1,5 kg\",\n          quantity: 1,\n          unit_price: 123\n        }],\n        payer: {\n          name: \"Ricardo\",\n          surname: \"Alvarez\",\n          email: \"ralvarez@email.com\",\n          phone: {\n            area_code: \"11\",\n            number: \"22223333\"\n          },\n          identification: {\n            type: \"DNI\",\n            number: \"12345678\"\n          },\n          address: {\n            street_name: \"Calle\",\n            street_number: 123,\n            zip_code: \"1111\"\n          }\n        },\n        back_urls: {\n          success: \"https://developers.oliverpetshop.com.ar\",\n          failure: \"https://developers.oliverpetshop.com.ar\",\n          pending: \"https://developers.oliverpetshop.com.ar\"\n        },\n        payment_methods: {\n          excluded_payment_types: [{\n            id: \"ticket\"\n          }],\n          installments: 6\n        },\n        notification_url: \"https://hookb.in/7ZZKJPB89aFa99D3y3eo\",\n        statement_descriptor: \"OLIVER_PETSHOP\",\n        external_reference: \"59\",\n        shipments: {\n          mode: \"not_specified\",\n          cost: 150,\n          receiver_address: {\n            zip_code: \"6703\",\n            street_name: \"Avenida jardin\",\n            city_name: \"Parada Robles\",\n            state_name: \"Exaltacion de la Cruz\",\n            street_number: 142\n          }\n        }\n      };\n      fetch('https://api.mercadopago.com/checkout/preferences', {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(preference)\n      }).then(res => res.json()).then(data => {\n        console.log(data);\n      });\n      return;\n    }\n\n    return registrarVenta(dataToRequest, token);\n  };\n\n  const registrarVenta = async (data, token) => {\n    try {\n      const headers = new Headers();\n      headers.append('token', token);\n      headers.append(\"Content-Type\", \"application/json\");\n      let url = `${API}/registrarVenta?mercadoPago=false`;\n      const reqVenta = await fetch(url, {\n        headers,\n        method: 'POST',\n        body: JSON.stringify(data)\n      });\n\n      if (reqVenta.status == 200) {\n        localStorage.removeItem('dataEnvio');\n        localStorage.removeItem('carrito');\n        Swal.fire('Listo', 'Su compra se ha registrado con éxito, solo resta que se dirija a nuestro local para hacerse con su producto.', 'success').then(() => window.location.assign('/'));\n      } else {\n        setLoading(false);\n        Swal.fire('Error', 'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde', 'error');\n      }\n    } catch (error) {\n      setLoading(false);\n      Swal.fire('Error', 'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde', 'error');\n      console.log(error.message);\n    }\n  };\n\n  if (error) {\n    Swal.fire('Atención', error, 'warning').then(() => setError(false));\n  }\n\n  const habilitarModal = () => {\n    setModalIsOpen(!modalIsOpen);\n  };\n\n  return !props.usuarioReducer.logueado ? __jsx(\"div\", {\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 42\n    }\n  }, __jsx(Error, {\n    message: \"No puedes realizar una compra sin tener una sesi\\xF3n activa.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 64\n    }\n  })) : __jsx(React.Fragment, null, loading ? __jsx(\"div\", {\n    className: \"container-loader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 24\n    }\n  }, __jsx(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 58\n    }\n  })) : null, __jsx(Head, {\n    title: \"Oliver Pet Shop\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"container mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"col-12 col-md-8 pt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 21\n    }\n  }, __jsx(\"h2\", {\n    className: \"jsx-2581472546\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 25\n    }\n  }, \"\\xDAltimos pasos para terminar tu compra\"), __jsx(CardUbicacion, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 25\n    }\n  }), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"alert alert-warning mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 25\n    }\n  }, __jsx(\"b\", {\n    className: \"jsx-2581472546\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 67\n    }\n  }, \"Atenci\\xF3n:\"), \" S\\xED desea retirar su compra en nuestro local, no es necesario que seleccione una zona de env\\xEDo\"), __jsx(ZonaEnvio, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 25\n    }\n  }), __jsx(\"h2\", {\n    className: \"jsx-2581472546\" + \" \" + \"mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 25\n    }\n  }, \"Opciones de env\\xEDo\"), __jsx(OpcionesEnvio, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 25\n    }\n  }), __jsx(\"h2\", {\n    className: \"jsx-2581472546\" + \" \" + \"mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 25\n    }\n  }, \"Selecciona un medio de pago\"), __jsx(MediosDePago, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 25\n    }\n  }), __jsx(\"button\", {\n    type: \"button\",\n    onClick: handleClick,\n    id: \"btn-continuar\",\n    className: \"jsx-2581472546\" + \" \" + \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 25\n    }\n  }, \"Continuar\"), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"divTotalMobile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 25\n    }\n  }, __jsx(\"span\", {\n    id: \"total\",\n    className: \"jsx-2581472546\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 29\n    }\n  }, \"$\", props.ventaReducer.total), __jsx(\"button\", {\n    type: \"button\",\n    onClick: handleClick,\n    className: \"jsx-2581472546\" + \" \" + \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 29\n    }\n  }, \"Continuar\"))), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"col-12 col-md-4 detalleProductos\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 21\n    }\n  }, __jsx(DetalleProductos, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 25\n    }\n  }))), __jsx(_JSXStyle, {\n    id: \"2581472546\",\n    __self: this\n  }, \"h2.jsx-2581472546{font-size:25px;}button#btn-continuar.jsx-2581472546{float:right;margin-top:20px;}.divTotalMobile.jsx-2581472546{display:none;}@media(max-width:768px){#btn-continuar.jsx-2581472546{display:none;}.divTotalMobile.jsx-2581472546{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;position:fixed;left:0;right:0px;bottom:0px;background-color:#f7f7f7;padding:16px;box-shadow:0 -2px 8px 2px rgba(0,0,0,.15);border-width:0 1px 1px;font-family:'Quicksand',sans-serif;}.detalleProductos.jsx-2581472546{display:none;}}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2ZyYW5jby9kZXNhcnJvbGxvL3Byb3llY3RvX29saXZlci9vbGl2ZXItc2l0aW8vcGFnZXMvY2hlY2tvdXQvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBb1A0QixBQUVvQyxBQUVBLEFBR1csQUFFRyxBQUVULEFBY2pCLFlBbkJKLENBQzRCLEFBRUcsQUFnQjFCLEVBdkJZLGFBSWhCLDhDQU1xQyxtSEFDZCxlQUNULE9BQ0csVUFDRSxXQUNjLHlCQUNaLGFBQzZCLDBDQUNuQix1QkFDYSxtQ0FDeEMiLCJmaWxlIjoiL2hvbWUvZnJhbmNvL2Rlc2Fycm9sbG8vcHJveWVjdG9fb2xpdmVyL29saXZlci1zaXRpby9wYWdlcy9jaGVja291dC9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgQ2FyZFViaWNhY2lvbiBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9DYXJkVWJpY2FjaW9uL2luZGV4JzsgXG5pbXBvcnQgT3BjaW9uZXNFbnZpbyBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9PcGNpb25lc0VudmlvJztcbmltcG9ydCBab25hRW52aW8gZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvWm9uYUVudmlvJztcbmltcG9ydCBIZWFkIGZyb20gJy4uLy4uL3NyYy9jb21wb25lbnRzL0hlYWQnO1xuaW1wb3J0IERldGFsbGVQcm9kdWN0b3MgZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvRGV0YWxsZVByb2R1Y3Rvcyc7XG5pbXBvcnQgRXJyb3IgZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvRXJyb3InO1xuaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JztcbmltcG9ydCAqIGFzIHVzdWFyaW9BY3Rpb25zIGZyb20gJy4uLy4uL3N0b3JlL2FjdGlvbnMvdXN1YXJpb0FjdGlvbnMnO1xuaW1wb3J0IHtBUEl9IGZyb20gJy4uLy4uL2NvbmZpZy9pbmRleCc7XG5pbXBvcnQgTG9hZGVyIGZyb20gJy4uLy4uL3NyYy9jb21wb25lbnRzL0xvYWRlci9pbmRleCc7XG5pbXBvcnQgTWVkaW9zRGVQYWdvIGZyb20gJy4uLy4uL3NyYy9jb21wb25lbnRzL01lZGlvc0RlUGFnbyc7XG5pbXBvcnQgUm91dGVyIGZyb20gJ25leHQvcm91dGVyJztcbmltcG9ydCBNb2RhbCBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9Nb2RhbCc7XG4vL2ltcG9ydCBGb3JtVmVudGEgZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvRm9ybVZlbnRhJztcbmNvbnN0IFN3YWwgPSByZXF1aXJlKCdzd2VldGFsZXJ0MicpO1xuXG5jb25zdCB7dmVyaWZpY2FyU2VzaW9ufSA9IHVzdWFyaW9BY3Rpb25zO1xuXG5jb25zdCBDaGVja291dCA9IChwcm9wcykgPT4ge1xuICAgIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbbW9kYWxJc09wZW4sIHNldE1vZGFsSXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTsvL21vZGFsIHBhcmEgbW9zdHJhciBlbCBmb3JtIGRlIGRhdG9zIGRlIHRhcmpldGFcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHByb3BzLnZlcmlmaWNhclNlc2lvbigpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdLnN0eWxlLm92ZXJmbG93WSA9ICdzY3JvbGwnO1xuICAgIH0sIFtdKTtcblxuICAgIGNvbnN0IGhhbmRsZUNsaWNrID0gKCk9PntcbiAgICAgICAgY29uc3Qge3VzdWFyaW99ID0gcHJvcHMudXN1YXJpb1JlZHVjZXI7XG4gICAgICAgIGNvbnN0IHt0aXBvczplbnZpb30gPSBwcm9wcy5lbnZpb3NSZWR1Y2VyO1xuICAgICAgICBjb25zdCB7em9uYX0gPSBwcm9wcy56b25hc1JlZHVjZXI7XG4gICAgICAgIGNvbnN0IHt0aXBvRW52aW8saWRab25hLGlkTWVkaW9QYWdvLHRvdGFsLHN1YnRvdGFsLHByb2R1Y3Rvcyxwb3JjZW50YWplX2Rlc2N1ZW50byxkZXNjdWVudG8sdG90YWxFbnZpb30gPSBwcm9wcy52ZW50YVJlZHVjZXI7XG5cbiAgICAgICAgaWYoIWVudmlvLmxvY2FsKXtcbiAgICAgICAgICAgIGlmKCF1c3VhcmlvLmFkZHJlc3MgfHwgdXN1YXJpby5hZGRyZXNzPT09JycpIHJldHVybiBzZXRFcnJvcignRXMgb2JsaWdhdG9yaW8gY29tcGxldGFyIHR1IHViaWNhY2nDs24uJyk7XG4gICAgICAgICAgICBpZighem9uYSkgcmV0dXJuIHNldEVycm9yKCdFbiBjYXNvIGRlIG5vIHJldGlyYXJsbyBwb3IgbnVlc3RybyBsb2NhbCwgZXMgb2JsaWdhdG9yaW8gY29tcGxldGFyIGxhIHpvbmEgZGUgZW52w61vLicpO1xuICAgICAgICB9XG4gICAgICAgIHNldEVycm9yKGZhbHNlKTtcbiAgICAgICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICAgICAgY29uc3Qge2lkVXN1YXJpbyx0b2tlbixub21icmUsZW1haWwsdGVsZWZvbm8sYWRkcmVzc30gPSB1c3VhcmlvO1xuICAgICAgICBsZXQgZiA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGxldCBtZXMgPSAoKGYuZ2V0TW9udGgoKSk8MTApP2AwJHtmLmdldE1vbnRoKCkrMX1gOmAke2YuZ2V0TW9udGgoKX1gO1xuICAgICAgICBsZXQgZGlhID0gKChmLmdldERhdGUoKSk8MTApP2AwJHtmLmdldERhdGUoKX1gOmAke2YuZ2V0RGF0ZSgpfWA7XG4gICAgICAgIGxldCBmZWNoYSA9IGAke2YuZ2V0RnVsbFllYXIoKX0tJHttZXN9LSR7ZGlhfWA7XG4gICAgICAgIGxldCBkYXRhVG9SZXF1ZXN0ID0ge1xuICAgICAgICAgICAgZW52aW86e1xuICAgICAgICAgICAgICAgIGlkWm9uYSxcbiAgICAgICAgICAgICAgICB0aXBvOnRpcG9FbnZpb1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZlbnRhOntcbiAgICAgICAgICAgICAgICBzdWJ0b3RhbCxcbiAgICAgICAgICAgICAgICBwb3JjZW50YWplX2Rlc2N1ZW50byxcbiAgICAgICAgICAgICAgICBkZXNjdWVudG8sXG4gICAgICAgICAgICAgICAgdG90YWwsXG4gICAgICAgICAgICAgICAgaWRVc3VhcmlvLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RvcyxcbiAgICAgICAgICAgICAgICBmZWNoYSxcbiAgICAgICAgICAgICAgICBvcGVyYWNpb25faWQ6bnVsbCxcbiAgICAgICAgICAgICAgICBpZE1lZGlvUGFnbyxcbiAgICAgICAgICAgICAgICB0b3RhbEVudmlvXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXN1YXJpbzp7XG4gICAgICAgICAgICAgICAgbm9tYnJlLFxuICAgICAgICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgICAgICAgIHRlbGVmb25vLFxuICAgICAgICAgICAgICAgIGFkZHJlc3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihpZE1lZGlvUGFnbyA9PSAnMScpe1xuICAgICAgICAgICAgLy9ndWFyZG8gZGF0YSBkZSBlbnZpbyBwYXJhIGx1ZWdvIGRlIGhhY2VyIGVsIGNoZWNrb3V0IGRlIG1lcmNhZG8gcGFnbywgZW52aW8gbG9zIGRhdG9zIGFsIHNlcnZpZG9yIHBhcmEgcmVnaXN0cmFyIGxhIHZlbnRhIGNvbiBlbCBlbnZpbyBjb3JyZXNwb25kaWVudGUuXG4gICAgICAgICAgICAvL2xvY2FsU3RvcmFnZS5zZXRJdGVtKCdkYXRhRW52aW8nLEpTT04uc3RyaW5naWZ5KHt0aXBvOnRpcG9FbnZpbyx6b25hOmlkWm9uYX0pKTtcbiAgICAgICAgICAgIGxldCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKCdBdXRob3JpemF0aW9uJyxgQmVhcmVyIEFQUF9VU1ItMjY4NzkxMDI5MjI5ODg0Mi0wNjIyMTUtZGVkZWZmZmJmMjAwYzM2NzkwNGUwM2M0ODlkMmNiZGMtNzc5NTMwNTkxYCk7XG4gICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XG4gICAgICAgICAgICAvLyBmZXRjaChgJHtBUEl9L21lcmNhZG9wYWdvYCx7XG4gICAgICAgICAgICAvLyAgICAgbWV0aG9kOidQT1NUJyxcbiAgICAgICAgICAgIC8vICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgLy8gICAgIGJvZHk6SlNPTi5zdHJpbmdpZnkoZGF0YVRvUmVxdWVzdClcbiAgICAgICAgICAgIC8vIH0pLnRoZW4ocmVzPT5yZXMuanNvbigpKS50aGVuKGRhdGFtcD0+e1xuICAgICAgICAgICAgLy8gICAgIC8vIGNvbnNvbGUubG9nKGRhdGFtcCk7XG4gICAgICAgICAgICAvLyAgICAgY29uc3Qge3Jlc3BvbnNlfSA9IGRhdGFtcC5pbmZvO1xuICAgICAgICAgICAgLy8gICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgLy8gICAgIHdpbmRvdy5sb2NhdGlvbi5hc3NpZ24ocmVzcG9uc2UuaW5pdF9wb2ludCk7XG4gICAgICAgICAgICAvLyB9KS5jYXRjaChlcnI9PntcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgLy8gICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgLy8gICAgIHNldEVycm9yKGVyci5tZXNzYWdlKTtcbiAgICAgICAgICAgIC8vIH0pXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkYXRhVG9SZXF1ZXN0KTtcbiAgICAgICAgICAgIGxldCBwcmVmZXJlbmNlID0ge1xuICAgICAgICAgICAgICAgIGl0ZW1zOltcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IFwiMTk3NlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnlfaWQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW5jeV9pZDogXCJBUlNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkNvbXBsZXRlIENhY2hvcnJvcyBSYXphcyBQZXF1ZcOxYXMgKENhY2hvcnJvIFBlcXVlw7FvKVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGljdHVyZV91cmw6IFwiaHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3dlYi1vbGl2ZXIvY2FjaG9ycm9zLXJhemEtcGVxdWVuYS5qcGdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkNPTVBMRVRFIEpVTklPUiByYXphcyBwZXF1ZcOxYXMgeCAxLDUga2dcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdF9wcmljZTogMTIzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIHBheWVyOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiUmljYXJkb1wiLFxuICAgICAgICAgICAgICAgICAgICBzdXJuYW1lOiBcIkFsdmFyZXpcIixcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IFwicmFsdmFyZXpAZW1haWwuY29tXCIsXG4gICAgICAgICAgICAgICAgICAgIHBob25lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmVhX2NvZGU6IFwiMTFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogXCIyMjIyMzMzM1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGlkZW50aWZpY2F0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkROSVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiBcIjEyMzQ1Njc4XCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWRkcmVzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWV0X25hbWU6IFwiQ2FsbGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVldF9udW1iZXI6IDEyMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHppcF9jb2RlOiBcIjExMTFcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBiYWNrX3VybHM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogXCJodHRwczovL2RldmVsb3BlcnMub2xpdmVycGV0c2hvcC5jb20uYXJcIixcbiAgICAgICAgICAgICAgICAgICAgZmFpbHVyZTogXCJodHRwczovL2RldmVsb3BlcnMub2xpdmVycGV0c2hvcC5jb20uYXJcIixcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZzogXCJodHRwczovL2RldmVsb3BlcnMub2xpdmVycGV0c2hvcC5jb20uYXJcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGF5bWVudF9tZXRob2RzOiB7XG4gICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGVkX3BheW1lbnRfdHlwZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJ0aWNrZXRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICBpbnN0YWxsbWVudHM6IDZcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbl91cmw6IFwiaHR0cHM6Ly9ob29rYi5pbi83WlpLSlBCODlhRmE5OUQzeTNlb1wiLFxuICAgICAgICAgICAgICAgIHN0YXRlbWVudF9kZXNjcmlwdG9yOiBcIk9MSVZFUl9QRVRTSE9QXCIsXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcmVmZXJlbmNlOiBcIjU5XCIsXG4gICAgICAgICAgICAgICAgc2hpcG1lbnRzOntcbiAgICAgICAgICAgICAgICAgICAgbW9kZTpcIm5vdF9zcGVjaWZpZWRcIixcbiAgICAgICAgICAgICAgICAgICAgY29zdDoxNTAsXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyX2FkZHJlc3M6e1xuICAgICAgICAgICAgICAgICAgICAgICAgemlwX2NvZGU6XCI2NzAzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJlZXRfbmFtZTpcIkF2ZW5pZGEgamFyZGluXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjaXR5X25hbWU6XCJQYXJhZGEgUm9ibGVzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZV9uYW1lOlwiRXhhbHRhY2lvbiBkZSBsYSBDcnV6XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJlZXRfbnVtYmVyOjE0MlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmZXRjaCgnaHR0cHM6Ly9hcGkubWVyY2Fkb3BhZ28uY29tL2NoZWNrb3V0L3ByZWZlcmVuY2VzJyx7XG4gICAgICAgICAgICAgICAgbWV0aG9kOidQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6SlNPTi5zdHJpbmdpZnkocHJlZmVyZW5jZSlcbiAgICAgICAgICAgIH0pLnRoZW4ocmVzPT5yZXMuanNvbigpKS50aGVuKGRhdGE9PntcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlZ2lzdHJhclZlbnRhKGRhdGFUb1JlcXVlc3QsdG9rZW4pO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCByZWdpc3RyYXJWZW50YSA9IGFzeW5jIChkYXRhLHRva2VuKT0+e1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgICAgICBoZWFkZXJzLmFwcGVuZCgndG9rZW4nLHRva2VuKTtcbiAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcbiAgICAgICAgICAgIGxldCB1cmwgPSBgJHtBUEl9L3JlZ2lzdHJhclZlbnRhP21lcmNhZG9QYWdvPWZhbHNlYDtcbiAgICAgICAgICAgIGNvbnN0IHJlcVZlbnRhID0gYXdhaXQgZmV0Y2godXJsLHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIG1ldGhvZDonUE9TVCcsXG4gICAgICAgICAgICAgICAgYm9keTpKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZihyZXFWZW50YS5zdGF0dXMgPT0gMjAwKXtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnZGF0YUVudmlvJyk7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2NhcnJpdG8nKTtcbiAgICAgICAgICAgICAgICBTd2FsLmZpcmUoXG4gICAgICAgICAgICAgICAgICAgICdMaXN0bycsXG4gICAgICAgICAgICAgICAgICAgICdTdSBjb21wcmEgc2UgaGEgcmVnaXN0cmFkbyBjb24gw6l4aXRvLCBzb2xvIHJlc3RhIHF1ZSBzZSBkaXJpamEgYSBudWVzdHJvIGxvY2FsIHBhcmEgaGFjZXJzZSBjb24gc3UgcHJvZHVjdG8uJyxcbiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnXG4gICAgICAgICAgICAgICAgKS50aGVuKCgpPT53aW5kb3cubG9jYXRpb24uYXNzaWduKCcvJykpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgU3dhbC5maXJlKFxuICAgICAgICAgICAgICAgICAgICAnRXJyb3InLFxuICAgICAgICAgICAgICAgICAgICAnSGEgb2N1cnJpZG8gdW4gZXJyb3IgYWwgbW9tZW50byBkZSByZWdpc3RyYXIgbGEgdmVudGEsIGludGVudGFsbyBtw6FzIHRhcmRlJyxcbiAgICAgICAgICAgICAgICAgICAgJ2Vycm9yJ1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIFN3YWwuZmlyZShcbiAgICAgICAgICAgICAgICAnRXJyb3InLFxuICAgICAgICAgICAgICAgICdIYSBvY3VycmlkbyB1biBlcnJvciBhbCBtb21lbnRvIGRlIHJlZ2lzdHJhciBsYSB2ZW50YSwgaW50ZW50YWxvIG3DoXMgdGFyZGUnLFxuICAgICAgICAgICAgICAgICdlcnJvcidcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmKGVycm9yKXtcbiAgICAgICAgU3dhbC5maXJlKFxuICAgICAgICAgICAgJ0F0ZW5jacOzbicsXG4gICAgICAgICAgICBlcnJvcixcbiAgICAgICAgICAgICd3YXJuaW5nJ1xuICAgICAgICApLnRoZW4oKCk9PnNldEVycm9yKGZhbHNlKSlcbiAgICB9XG5cbiAgICBjb25zdCBoYWJpbGl0YXJNb2RhbCA9ICgpPT57XG4gICAgICAgIHNldE1vZGFsSXNPcGVuKCFtb2RhbElzT3Blbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgICAgKCFwcm9wcy51c3VhcmlvUmVkdWNlci5sb2d1ZWFkbyk/PGRpdiBjbGFzc05hbWU9XCJtdC0zXCI+PEVycm9yIG1lc3NhZ2U9XCJObyBwdWVkZXMgcmVhbGl6YXIgdW5hIGNvbXByYSBzaW4gdGVuZXIgdW5hIHNlc2nDs24gYWN0aXZhLlwiLz48L2Rpdj46XG4gICAgICAgIDw+XG4gICAgICAgICAgICB7KGxvYWRpbmcpPzxkaXYgY2xhc3NOYW1lPVwiY29udGFpbmVyLWxvYWRlclwiPjxMb2FkZXIvPjwvZGl2PjpudWxsfSAgIFxuICAgICAgICAgICAgPEhlYWQgdGl0bGU9XCJPbGl2ZXIgUGV0IFNob3BcIi8+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRhaW5lciBtYi00XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtMTIgY29sLW1kLTggcHQtNFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgyPsOabHRpbW9zIHBhc29zIHBhcmEgdGVybWluYXIgdHUgY29tcHJhPC9oMj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxDYXJkVWJpY2FjaW9uLz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGVydCBhbGVydC13YXJuaW5nIG10LTNcIj48Yj5BdGVuY2nDs246PC9iPiBTw60gZGVzZWEgcmV0aXJhciBzdSBjb21wcmEgZW4gbnVlc3RybyBsb2NhbCwgbm8gZXMgbmVjZXNhcmlvIHF1ZSBzZWxlY2Npb25lIHVuYSB6b25hIGRlIGVudsOtbzwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8Wm9uYUVudmlvLz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT1cIm10LTVcIj5PcGNpb25lcyBkZSBlbnbDrW88L2gyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPE9wY2lvbmVzRW52aW8vPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwibXQtNVwiPlNlbGVjY2lvbmEgdW4gbWVkaW8gZGUgcGFnbzwvaDI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8TWVkaW9zRGVQYWdvLz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3NOYW1lPVwiYnRuIGJ0bi1wcmltYXJ5XCIgb25DbGljaz17aGFuZGxlQ2xpY2t9IGlkPVwiYnRuLWNvbnRpbnVhclwiPkNvbnRpbnVhcjwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZUb3RhbE1vYmlsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGlkPVwidG90YWxcIj4ke3Byb3BzLnZlbnRhUmVkdWNlci50b3RhbH08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3NOYW1lPVwiYnRuIGJ0bi1wcmltYXJ5XCIgb25DbGljaz17aGFuZGxlQ2xpY2t9PkNvbnRpbnVhcjwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC0xMiBjb2wtbWQtNCBkZXRhbGxlUHJvZHVjdG9zXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8RGV0YWxsZVByb2R1Y3Rvcy8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgICAgICAgICAgICAgaDJ7Zm9udC1zaXplOjI1cHh9XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbiNidG4tY29udGludWFye1xuICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXQ6cmlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOjIwcHhcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAuZGl2VG90YWxNb2JpbGV7ZGlzcGxheTpub25lfVxuICAgICAgICAgICAgICAgICAgICBAbWVkaWEobWF4LXdpZHRoOjc2OHB4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICNidG4tY29udGludWFye2Rpc3BsYXk6bm9uZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5kaXZUb3RhbE1vYmlsZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6MDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodDowcHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAwcHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y3ZjdmNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxNnB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgLTJweCA4cHggMnB4IHJnYmEoMCwwLDAsLjE1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXItd2lkdGg6IDAgMXB4IDFweDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250LWZhbWlseTogJ1F1aWNrc2FuZCcsIHNhbnMtc2VyaWY7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICAgICAgLmRldGFsbGVQcm9kdWN0b3N7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTpub25lXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGB9PC9zdHlsZT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAge21vZGFsSXNPcGVuID8gPE1vZGFsIGNsb3NlTW9kYWw9e2hhYmlsaXRhck1vZGFsfT48Rm9ybVZlbnRhIGNsb3NlTW9kYWw9e2hhYmlsaXRhck1vZGFsfS8+PC9Nb2RhbD4gOiBudWxsfVxuICAgICAgICA8Lz5cbiAgICApO1xufVxuIFxuY29uc3QgbWFwU3RhdGVUb1Byb3BzID0gKHt1c3VhcmlvUmVkdWNlcixlbnZpb3NSZWR1Y2VyLHZlbnRhUmVkdWNlcix6b25hc1JlZHVjZXJ9KT0+e1xuICAgIHJldHVybiB7XG4gICAgICAgIHZlbnRhUmVkdWNlcixcbiAgICAgICAgdXN1YXJpb1JlZHVjZXIsXG4gICAgICAgIGVudmlvc1JlZHVjZXIsXG4gICAgICAgIHpvbmFzUmVkdWNlclxuICAgIH07XG59XG5cbmNvbnN0IG1hcERpc3BhdGNoVG9Qcm9wcyA9IHtcbiAgICB2ZXJpZmljYXJTZXNpb25cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLG1hcERpc3BhdGNoVG9Qcm9wcykoQ2hlY2tvdXQpOyJdfQ== */\\n/*@ sourceURL=/home/franco/desarrollo/proyecto_oliver/oliver-sitio/pages/checkout/index.js */\")), modalIsOpen ? __jsx(Modal, {\n    closeModal: habilitarModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 28\n    }\n  }, __jsx(FormVenta, {\n    closeModal: habilitarModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 63\n    }\n  })) : null);\n};\n\nconst mapStateToProps = ({\n  usuarioReducer,\n  enviosReducer,\n  ventaReducer,\n  zonasReducer\n}) => {\n  return {\n    ventaReducer,\n    usuarioReducer,\n    enviosReducer,\n    zonasReducer\n  };\n};\n\nconst mapDispatchToProps = {\n  verificarSesion\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Checkout);","map":{"version":3,"sources":["/home/franco/desarrollo/proyecto_oliver/oliver-sitio/pages/checkout/index.js"],"names":["useEffect","useState","CardUbicacion","OpcionesEnvio","ZonaEnvio","Head","DetalleProductos","Error","connect","usuarioActions","API","Loader","MediosDePago","Router","Modal","Swal","require","verificarSesion","Checkout","props","error","setError","loading","setLoading","modalIsOpen","setModalIsOpen","document","getElementsByTagName","style","overflowY","handleClick","usuario","usuarioReducer","tipos","envio","enviosReducer","zona","zonasReducer","tipoEnvio","idZona","idMedioPago","total","subtotal","productos","porcentaje_descuento","descuento","totalEnvio","ventaReducer","local","address","idUsuario","token","nombre","email","telefono","f","Date","mes","getMonth","dia","getDate","fecha","getFullYear","dataToRequest","tipo","venta","operacion_id","headers","Headers","append","preference","items","id","category_id","currency_id","description","picture_url","title","quantity","unit_price","payer","name","surname","phone","area_code","number","identification","type","street_name","street_number","zip_code","back_urls","success","failure","pending","payment_methods","excluded_payment_types","installments","notification_url","statement_descriptor","external_reference","shipments","mode","cost","receiver_address","city_name","state_name","fetch","method","body","JSON","stringify","then","res","json","data","console","log","registrarVenta","url","reqVenta","status","localStorage","removeItem","fire","window","location","assign","message","habilitarModal","logueado","mapStateToProps","mapDispatchToProps"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\nimport CardUbicacion from '../../src/components/CardUbicacion/index'; \nimport OpcionesEnvio from '../../src/components/OpcionesEnvio';\nimport ZonaEnvio from '../../src/components/ZonaEnvio';\nimport Head from '../../src/components/Head';\nimport DetalleProductos from '../../src/components/DetalleProductos';\nimport Error from '../../src/components/Error';\nimport { connect } from 'react-redux';\nimport * as usuarioActions from '../../store/actions/usuarioActions';\nimport {API} from '../../config/index';\nimport Loader from '../../src/components/Loader/index';\nimport MediosDePago from '../../src/components/MediosDePago';\nimport Router from 'next/router';\nimport Modal from '../../src/components/Modal';\n//import FormVenta from '../../src/components/FormVenta';\nconst Swal = require('sweetalert2');\n\nconst {verificarSesion} = usuarioActions;\n\nconst Checkout = (props) => {\n    const [error, setError] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [modalIsOpen, setModalIsOpen] = useState(false);//modal para mostrar el form de datos de tarjeta\n\n    useEffect(() => {\n        props.verificarSesion();\n        document.getElementsByTagName('body')[0].style.overflowY = 'scroll';\n    }, []);\n\n    const handleClick = ()=>{\n        const {usuario} = props.usuarioReducer;\n        const {tipos:envio} = props.enviosReducer;\n        const {zona} = props.zonasReducer;\n        const {tipoEnvio,idZona,idMedioPago,total,subtotal,productos,porcentaje_descuento,descuento,totalEnvio} = props.ventaReducer;\n\n        if(!envio.local){\n            if(!usuario.address || usuario.address==='') return setError('Es obligatorio completar tu ubicación.');\n            if(!zona) return setError('En caso de no retirarlo por nuestro local, es obligatorio completar la zona de envío.');\n        }\n        setError(false);\n        setLoading(true);\n        const {idUsuario,token,nombre,email,telefono,address} = usuario;\n        let f = new Date();\n        let mes = ((f.getMonth())<10)?`0${f.getMonth()+1}`:`${f.getMonth()}`;\n        let dia = ((f.getDate())<10)?`0${f.getDate()}`:`${f.getDate()}`;\n        let fecha = `${f.getFullYear()}-${mes}-${dia}`;\n        let dataToRequest = {\n            envio:{\n                idZona,\n                tipo:tipoEnvio\n            },\n            venta:{\n                subtotal,\n                porcentaje_descuento,\n                descuento,\n                total,\n                idUsuario,\n                productos,\n                fecha,\n                operacion_id:null,\n                idMedioPago,\n                totalEnvio\n            },\n            usuario:{\n                nombre,\n                email,\n                telefono,\n                address\n            }\n        }\n        if(idMedioPago == '1'){\n            //guardo data de envio para luego de hacer el checkout de mercado pago, envio los datos al servidor para registrar la venta con el envio correspondiente.\n            //localStorage.setItem('dataEnvio',JSON.stringify({tipo:tipoEnvio,zona:idZona}));\n            let headers = new Headers();\n            headers.append('Authorization',`Bearer APP_USR-2687910292298842-062215-dedefffbf200c367904e03c489d2cbdc-779530591`);\n            headers.append(\"Content-Type\", \"application/json\");\n            // fetch(`${API}/mercadopago`,{\n            //     method:'POST',\n            //     headers,\n            //     body:JSON.stringify(dataToRequest)\n            // }).then(res=>res.json()).then(datamp=>{\n            //     // console.log(datamp);\n            //     const {response} = datamp.info;\n            //     setLoading(false);\n            //     window.location.assign(response.init_point);\n            // }).catch(err=>{\n            //     console.log(err);\n            //     setLoading(false);\n            //     setError(err.message);\n            // })\n            // console.log(dataToRequest);\n            let preference = {\n                items:[\n                    {\n                        id: \"1976\",\n                        category_id: \"\",\n                        currency_id: \"ARS\",\n                        description: \"Complete Cachorros Razas Pequeñas (Cachorro Pequeño)\",\n                        picture_url: \"https://storage.googleapis.com/web-oliver/cachorros-raza-pequena.jpg\",\n                        title: \"COMPLETE JUNIOR razas pequeñas x 1,5 kg\",\n                        quantity: 1,\n                        unit_price: 123\n                    }\n                ],\n                payer: {\n                    name: \"Ricardo\",\n                    surname: \"Alvarez\",\n                    email: \"ralvarez@email.com\",\n                    phone: {\n                        area_code: \"11\",\n                        number: \"22223333\"\n                    },\n                    identification: {\n                        type: \"DNI\",\n                        number: \"12345678\"\n                    },\n                    address: {\n                        street_name: \"Calle\",\n                        street_number: 123,\n                        zip_code: \"1111\"\n                    }\n                },\n                back_urls: {\n                    success: \"https://developers.oliverpetshop.com.ar\",\n                    failure: \"https://developers.oliverpetshop.com.ar\",\n                    pending: \"https://developers.oliverpetshop.com.ar\"\n                },\n                payment_methods: {\n                    excluded_payment_types: [\n                        {\n                            id: \"ticket\"\n                        }\n                    ],\n                    installments: 6\n                },\n                notification_url: \"https://hookb.in/7ZZKJPB89aFa99D3y3eo\",\n                statement_descriptor: \"OLIVER_PETSHOP\",\n                external_reference: \"59\",\n                shipments:{\n                    mode:\"not_specified\",\n                    cost:150,\n                    receiver_address:{\n                        zip_code:\"6703\",\n                        street_name:\"Avenida jardin\",\n                        city_name:\"Parada Robles\",\n                        state_name:\"Exaltacion de la Cruz\",\n                        street_number:142\n                    }\n                }\n            }\n\n            fetch('https://api.mercadopago.com/checkout/preferences',{\n                method:'POST',\n                headers,\n                body:JSON.stringify(preference)\n            }).then(res=>res.json()).then(data=>{\n                console.log(data);\n            })\n            return;\n        }\n        return registrarVenta(dataToRequest,token);\n    }\n    \n    const registrarVenta = async (data,token)=>{\n        try {\n            const headers = new Headers();\n            headers.append('token',token);\n            headers.append(\"Content-Type\", \"application/json\");\n            let url = `${API}/registrarVenta?mercadoPago=false`;\n            const reqVenta = await fetch(url,{\n                headers,\n                method:'POST',\n                body:JSON.stringify(data)\n            });\n            if(reqVenta.status == 200){\n                localStorage.removeItem('dataEnvio');\n                localStorage.removeItem('carrito');\n                Swal.fire(\n                    'Listo',\n                    'Su compra se ha registrado con éxito, solo resta que se dirija a nuestro local para hacerse con su producto.',\n                    'success'\n                ).then(()=>window.location.assign('/'));\n            }else{\n                setLoading(false);\n                Swal.fire(\n                    'Error',\n                    'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde',\n                    'error'\n                );\n            }\n        } catch (error) {\n            setLoading(false);\n            Swal.fire(\n                'Error',\n                'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde',\n                'error'\n            );\n            console.log(error.message);\n        }\n    }\n\n    if(error){\n        Swal.fire(\n            'Atención',\n            error,\n            'warning'\n        ).then(()=>setError(false))\n    }\n\n    const habilitarModal = ()=>{\n        setModalIsOpen(!modalIsOpen);\n    }\n\n    return (\n        (!props.usuarioReducer.logueado)?<div className=\"mt-3\"><Error message=\"No puedes realizar una compra sin tener una sesión activa.\"/></div>:\n        <>\n            {(loading)?<div className=\"container-loader\"><Loader/></div>:null}   \n            <Head title=\"Oliver Pet Shop\"/>\n            <div className=\"container mb-4\">\n                <div className=\"row\">\n                    <div className=\"col-12 col-md-8 pt-4\">\n                        <h2>Últimos pasos para terminar tu compra</h2>\n                        <CardUbicacion/>\n\n                        <div className=\"alert alert-warning mt-3\"><b>Atención:</b> Sí desea retirar su compra en nuestro local, no es necesario que seleccione una zona de envío</div>\n\n                        <ZonaEnvio/>\n\n                        <h2 className=\"mt-5\">Opciones de envío</h2>\n                        <OpcionesEnvio/>\n\n                        <h2 className=\"mt-5\">Selecciona un medio de pago</h2>\n                        <MediosDePago/>\n\n                        <button type=\"button\" className=\"btn btn-primary\" onClick={handleClick} id=\"btn-continuar\">Continuar</button>\n                        <div className=\"divTotalMobile\">\n                            <span id=\"total\">${props.ventaReducer.total}</span>\n                            <button type=\"button\" className=\"btn btn-primary\" onClick={handleClick}>Continuar</button>\n                        </div>\n                    </div>\n                    <div className=\"col-12 col-md-4 detalleProductos\">\n                        <DetalleProductos/>\n                    </div>\n                </div>\n                <style jsx>{`\n                    h2{font-size:25px}\n                    button#btn-continuar{\n                        float:right;\n                        margin-top:20px\n                    }\n                    .divTotalMobile{display:none}\n                    @media(max-width:768px){\n                        #btn-continuar{display:none}\n                        .divTotalMobile{\n                            display:flex;\n                            justify-content:space-between;\n                            position: fixed;\n                            left:0;\n                            right:0px;\n                            bottom: 0px;\n                            background-color: #f7f7f7;\n                            padding: 16px;\n                            box-shadow: 0 -2px 8px 2px rgba(0,0,0,.15);\n                            border-width: 0 1px 1px;\n                            font-family: 'Quicksand', sans-serif;\n                        } \n                        .detalleProductos{\n                            display:none\n                        }           \n                    }\n                `}</style>\n            </div>\n            {modalIsOpen ? <Modal closeModal={habilitarModal}><FormVenta closeModal={habilitarModal}/></Modal> : null}\n        </>\n    );\n}\n \nconst mapStateToProps = ({usuarioReducer,enviosReducer,ventaReducer,zonasReducer})=>{\n    return {\n        ventaReducer,\n        usuarioReducer,\n        enviosReducer,\n        zonasReducer\n    };\n}\n\nconst mapDispatchToProps = {\n    verificarSesion\n};\n\nexport default connect(mapStateToProps,mapDispatchToProps)(Checkout);"]},"metadata":{},"sourceType":"module"}