{"ast":null,"code":"var _jsxFileName = \"/home/franco/desarrollo/oliver/oliver-sitio/pages/checkout/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport CardUbicacion from '../../src/components/CardUbicacion/index';\nimport OpcionesEnvio from '../../src/components/OpcionesEnvio';\nimport ZonaEnvio from '../../src/components/ZonaEnvio';\nimport Head from '../../src/components/Head';\nimport DetalleProductos from '../../src/components/DetalleProductos';\nimport Error from '../../src/components/Error';\nimport { connect } from 'react-redux';\nimport * as usuarioActions from '../../store/actions/usuarioActions';\nimport { API, MP_AC_TOKEN, URL_PROCESAR_VENTA } from '../../config/index';\nimport Loader from '../../src/components/Loader/index';\nimport MediosDePago from '../../src/components/MediosDePago';\nimport Modal from '../../src/components/Modal'; //import Router from 'next/router';\n//import FormVenta from '../../src/components/FormVenta';\n\nconst Swal = require('sweetalert2');\n\nconst {\n  verificarSesion\n} = usuarioActions;\n\nconst Checkout = props => {\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: modalIsOpen,\n    1: setModalIsOpen\n  } = useState(false); //modal para mostrar el form de datos de tarjeta\n\n  useEffect(() => {\n    props.verificarSesion();\n    document.getElementsByTagName('body')[0].style.overflowY = 'scroll';\n  }, []); //console.log(URL_PROCESAR_VENTA);\n\n  const handleClick = () => {\n    const {\n      usuario\n    } = props.usuarioReducer;\n    const {\n      tipos: envio\n    } = props.enviosReducer;\n    const {\n      zona\n    } = props.zonasReducer;\n    const {\n      tipoEnvio,\n      idZona,\n      idMedioPago,\n      total,\n      subtotal,\n      productos,\n      porcentaje_descuento,\n      descuento,\n      totalEnvio\n    } = props.ventaReducer;\n\n    if (!envio.local) {\n      if (!usuario.address || usuario.address === '') return setError('Es obligatorio completar tu ubicación.');\n      if (!zona) return setError('En caso de no retirarlo por nuestro local, es obligatorio completar la zona de envío.');\n    }\n\n    setError(false);\n    setLoading(true);\n    const {\n      idUsuario,\n      token,\n      nombre,\n      email,\n      telefono,\n      address\n    } = usuario;\n\n    if (idMedioPago == '1') {\n      //guardo data de envio para luego de hacer el checkout de mercado pago, envio los datos al servidor para registrar la venta con el envio correspondiente.\n      localStorage.setItem('dataEnvio', JSON.stringify({\n        tipo: tipoEnvio,\n        zona: idZona\n      }));\n      let headers = new Headers();\n      headers.append('Authorization', `Bearer ${MP_AC_TOKEN}`);\n      headers.append(\"Content-Type\", \"application/json\");\n      let items = [];\n      productos.map(prd => {\n        items.push({\n          id: prd.idSubProducto,\n          title: prd.subProducto,\n          currency_id: \"ARS\",\n          picture_url: prd.foto,\n          description: prd.producto + ' (' + prd.tamaño + ')',\n          quantity: prd.cantidad,\n          unit_price: prd.precio\n        });\n      });\n      let preference = {\n        items,\n        payer: {\n          name: nombre,\n          email: email,\n          phone: {\n            area_code: \"11\",\n            number: telefono\n          },\n          address: {\n            street_name: address\n          }\n        },\n        back_urls: {\n          success: URL_PROCESAR_VENTA,\n          failure: URL_PROCESAR_VENTA,\n          pending: URL_PROCESAR_VENTA\n        },\n        payment_methods: {\n          excluded_payment_types: [{\n            id: \"ticket\"\n          }],\n          installments: 1\n        },\n        // notification_url: \"https://hookb.in/7ZZKJPB89aFa99D3y3eo\",\n        statement_descriptor: \"OLIVER_PETSHOP\",\n        external_reference: \"\",\n        shipments: {\n          mode: \"not_specified\",\n          cost: totalEnvio,\n          receiver_address: {\n            street_name: address\n          }\n        }\n      };\n      fetch('https://api.mercadopago.com/checkout/preferences', {\n        method: 'POST',\n        headers,\n        body: JSON.stringify(preference)\n      }).then(res => res.json()).then(data => {\n        window.location.assign(data.init_point);\n      });\n      return;\n    }\n\n    let dataToRequest = {\n      envio: {\n        idZona,\n        tipo: tipoEnvio\n      },\n      venta: {\n        subtotal,\n        porcentaje_descuento,\n        descuento,\n        total,\n        idUsuario,\n        productos,\n        idMedioPago\n      }\n    };\n    return registrarVenta(dataToRequest, token);\n  };\n\n  const registrarVenta = async (data, token) => {\n    try {\n      const headers = new Headers();\n      headers.append('token', token);\n      headers.append(\"Content-Type\", \"application/json\");\n      let url = `${API}/ventas/registrarVenta`;\n      const reqVenta = await fetch(url, {\n        headers,\n        method: 'POST',\n        body: JSON.stringify(data)\n      });\n\n      if (reqVenta.status == 200) {\n        localStorage.removeItem('dataEnvio');\n        localStorage.removeItem('carrito');\n        Swal.fire('Listo', 'Su compra se ha registrado con éxito, solo resta que se dirija a nuestro local para hacerse con su producto.', 'success').then(() => window.location.assign('/'));\n      } else {\n        setLoading(false);\n        Swal.fire('Error', 'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde', 'error');\n      }\n    } catch (error) {\n      setLoading(false);\n      Swal.fire('Error', 'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde', 'error');\n      console.log(error.message);\n    }\n  };\n\n  if (error) {\n    Swal.fire('Atención', error, 'warning').then(() => setError(false));\n  }\n\n  const habilitarModal = () => {\n    setModalIsOpen(!modalIsOpen);\n  };\n\n  return !props.usuarioReducer.logueado ? __jsx(\"div\", {\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 42\n    }\n  }, __jsx(Error, {\n    message: \"No puedes realizar una compra sin tener una sesi\\xF3n activa.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 64\n    }\n  })) : __jsx(React.Fragment, null, loading ? __jsx(\"div\", {\n    className: \"container-loader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 24\n    }\n  }, __jsx(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 58\n    }\n  })) : null, __jsx(Head, {\n    title: \"Oliver Pet Shop\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"container mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"col-12 col-md-8 pt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }, __jsx(\"h2\", {\n    className: \"jsx-2581472546\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 25\n    }\n  }, \"\\xDAltimos pasos para terminar tu compra\"), __jsx(CardUbicacion, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 25\n    }\n  }), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"alert alert-warning mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 25\n    }\n  }, __jsx(\"b\", {\n    className: \"jsx-2581472546\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 67\n    }\n  }, \"Atenci\\xF3n:\"), \" S\\xED desea retirar su compra en nuestro local, no es necesario que seleccione una zona de env\\xEDo\"), __jsx(ZonaEnvio, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 25\n    }\n  }), __jsx(\"h2\", {\n    className: \"jsx-2581472546\" + \" \" + \"mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 25\n    }\n  }, \"Opciones de env\\xEDo\"), __jsx(OpcionesEnvio, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 25\n    }\n  }), __jsx(\"h2\", {\n    className: \"jsx-2581472546\" + \" \" + \"mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 25\n    }\n  }, \"Selecciona un medio de pago\"), __jsx(MediosDePago, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 25\n    }\n  }), __jsx(\"button\", {\n    type: \"button\",\n    onClick: handleClick,\n    id: \"btn-continuar\",\n    className: \"jsx-2581472546\" + \" \" + \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 25\n    }\n  }, \"Continuar\"), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"divTotalMobile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 25\n    }\n  }, __jsx(\"span\", {\n    id: \"total\",\n    className: \"jsx-2581472546\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 29\n    }\n  }, \"$\", props.ventaReducer.total), __jsx(\"button\", {\n    type: \"button\",\n    onClick: handleClick,\n    className: \"jsx-2581472546\" + \" \" + \"btn btn-primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 29\n    }\n  }, \"Continuar\"))), __jsx(\"div\", {\n    className: \"jsx-2581472546\" + \" \" + \"col-12 col-md-4 detalleProductos\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 21\n    }\n  }, __jsx(DetalleProductos, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 25\n    }\n  }))), __jsx(_JSXStyle, {\n    id: \"2581472546\",\n    __self: this\n  }, \"h2.jsx-2581472546{font-size:25px;}button#btn-continuar.jsx-2581472546{float:right;margin-top:20px;}.divTotalMobile.jsx-2581472546{display:none;}@media(max-width:768px){#btn-continuar.jsx-2581472546{display:none;}.divTotalMobile.jsx-2581472546{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;position:fixed;left:0;right:0px;bottom:0px;background-color:#f7f7f7;padding:16px;box-shadow:0 -2px 8px 2px rgba(0,0,0,.15);border-width:0 1px 1px;font-family:'Quicksand',sans-serif;}.detalleProductos.jsx-2581472546{display:none;}}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2ZyYW5jby9kZXNhcnJvbGxvL29saXZlci9vbGl2ZXItc2l0aW8vcGFnZXMvY2hlY2tvdXQvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBOE00QixBQUVvQyxBQUVBLEFBR1csQUFFRyxBQUVULEFBY2pCLFlBbkJKLENBQzRCLEFBRUcsQUFnQjFCLEVBdkJZLGFBSWhCLDhDQU1xQyxtSEFDZCxlQUNULE9BQ0csVUFDRSxXQUNjLHlCQUNaLGFBQzZCLDBDQUNuQix1QkFDYSxtQ0FDeEMiLCJmaWxlIjoiL2hvbWUvZnJhbmNvL2Rlc2Fycm9sbG8vb2xpdmVyL29saXZlci1zaXRpby9wYWdlcy9jaGVja291dC9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgQ2FyZFViaWNhY2lvbiBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9DYXJkVWJpY2FjaW9uL2luZGV4JzsgXG5pbXBvcnQgT3BjaW9uZXNFbnZpbyBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9PcGNpb25lc0VudmlvJztcbmltcG9ydCBab25hRW52aW8gZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvWm9uYUVudmlvJztcbmltcG9ydCBIZWFkIGZyb20gJy4uLy4uL3NyYy9jb21wb25lbnRzL0hlYWQnO1xuaW1wb3J0IERldGFsbGVQcm9kdWN0b3MgZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvRGV0YWxsZVByb2R1Y3Rvcyc7XG5pbXBvcnQgRXJyb3IgZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvRXJyb3InO1xuaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlYWN0LXJlZHV4JztcbmltcG9ydCAqIGFzIHVzdWFyaW9BY3Rpb25zIGZyb20gJy4uLy4uL3N0b3JlL2FjdGlvbnMvdXN1YXJpb0FjdGlvbnMnO1xuaW1wb3J0IHtBUEksTVBfQUNfVE9LRU4sVVJMX1BST0NFU0FSX1ZFTlRBfSBmcm9tICcuLi8uLi9jb25maWcvaW5kZXgnO1xuaW1wb3J0IExvYWRlciBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9Mb2FkZXIvaW5kZXgnO1xuaW1wb3J0IE1lZGlvc0RlUGFnbyBmcm9tICcuLi8uLi9zcmMvY29tcG9uZW50cy9NZWRpb3NEZVBhZ28nO1xuaW1wb3J0IE1vZGFsIGZyb20gJy4uLy4uL3NyYy9jb21wb25lbnRzL01vZGFsJztcbi8vaW1wb3J0IFJvdXRlciBmcm9tICduZXh0L3JvdXRlcic7XG4vL2ltcG9ydCBGb3JtVmVudGEgZnJvbSAnLi4vLi4vc3JjL2NvbXBvbmVudHMvRm9ybVZlbnRhJztcbmNvbnN0IFN3YWwgPSByZXF1aXJlKCdzd2VldGFsZXJ0MicpO1xuXG5jb25zdCB7dmVyaWZpY2FyU2VzaW9ufSA9IHVzdWFyaW9BY3Rpb25zO1xuXG5jb25zdCBDaGVja291dCA9IChwcm9wcykgPT4ge1xuICAgIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbbW9kYWxJc09wZW4sIHNldE1vZGFsSXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTsvL21vZGFsIHBhcmEgbW9zdHJhciBlbCBmb3JtIGRlIGRhdG9zIGRlIHRhcmpldGFcblxuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIHByb3BzLnZlcmlmaWNhclNlc2lvbigpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdLnN0eWxlLm92ZXJmbG93WSA9ICdzY3JvbGwnO1xuICAgIH0sIFtdKTtcblxuICAgIC8vY29uc29sZS5sb2coVVJMX1BST0NFU0FSX1ZFTlRBKTtcblxuICAgIGNvbnN0IGhhbmRsZUNsaWNrID0gKCk9PntcbiAgICAgICAgY29uc3Qge3VzdWFyaW99ID0gcHJvcHMudXN1YXJpb1JlZHVjZXI7XG4gICAgICAgIGNvbnN0IHt0aXBvczplbnZpb30gPSBwcm9wcy5lbnZpb3NSZWR1Y2VyO1xuICAgICAgICBjb25zdCB7em9uYX0gPSBwcm9wcy56b25hc1JlZHVjZXI7XG4gICAgICAgIGNvbnN0IHt0aXBvRW52aW8saWRab25hLGlkTWVkaW9QYWdvLHRvdGFsLHN1YnRvdGFsLHByb2R1Y3Rvcyxwb3JjZW50YWplX2Rlc2N1ZW50byxkZXNjdWVudG8sdG90YWxFbnZpb30gPSBwcm9wcy52ZW50YVJlZHVjZXI7XG5cbiAgICAgICAgaWYoIWVudmlvLmxvY2FsKXtcbiAgICAgICAgICAgIGlmKCF1c3VhcmlvLmFkZHJlc3MgfHwgdXN1YXJpby5hZGRyZXNzPT09JycpIHJldHVybiBzZXRFcnJvcignRXMgb2JsaWdhdG9yaW8gY29tcGxldGFyIHR1IHViaWNhY2nDs24uJyk7XG4gICAgICAgICAgICBpZighem9uYSkgcmV0dXJuIHNldEVycm9yKCdFbiBjYXNvIGRlIG5vIHJldGlyYXJsbyBwb3IgbnVlc3RybyBsb2NhbCwgZXMgb2JsaWdhdG9yaW8gY29tcGxldGFyIGxhIHpvbmEgZGUgZW52w61vLicpO1xuICAgICAgICB9XG4gICAgICAgIHNldEVycm9yKGZhbHNlKTtcbiAgICAgICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICAgICAgY29uc3Qge2lkVXN1YXJpbyx0b2tlbixub21icmUsZW1haWwsdGVsZWZvbm8sYWRkcmVzc30gPSB1c3VhcmlvO1xuICAgICAgICBpZihpZE1lZGlvUGFnbyA9PSAnMScpe1xuICAgICAgICAgICAgLy9ndWFyZG8gZGF0YSBkZSBlbnZpbyBwYXJhIGx1ZWdvIGRlIGhhY2VyIGVsIGNoZWNrb3V0IGRlIG1lcmNhZG8gcGFnbywgZW52aW8gbG9zIGRhdG9zIGFsIHNlcnZpZG9yIHBhcmEgcmVnaXN0cmFyIGxhIHZlbnRhIGNvbiBlbCBlbnZpbyBjb3JyZXNwb25kaWVudGUuXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGF0YUVudmlvJyxKU09OLnN0cmluZ2lmeSh7dGlwbzp0aXBvRW52aW8sem9uYTppZFpvbmF9KSk7XG4gICAgICAgICAgICBsZXQgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgICAgICBoZWFkZXJzLmFwcGVuZCgnQXV0aG9yaXphdGlvbicsYEJlYXJlciAke01QX0FDX1RPS0VOfWApO1xuICAgICAgICAgICAgaGVhZGVycy5hcHBlbmQoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgICAgICAgbGV0IGl0ZW1zID0gW107XG4gICAgICAgICAgICBwcm9kdWN0b3MubWFwKHByZD0+e1xuICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDpwcmQuaWRTdWJQcm9kdWN0byxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6cHJkLnN1YlByb2R1Y3RvLFxuICAgICAgICAgICAgICAgICAgICBjdXJyZW5jeV9pZDpcIkFSU1wiLFxuICAgICAgICAgICAgICAgICAgICBwaWN0dXJlX3VybDpwcmQuZm90byxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246cHJkLnByb2R1Y3RvICsgJyAoJysgcHJkLnRhbWHDsW8gKyAnKScsXG4gICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OnByZC5jYW50aWRhZCxcbiAgICAgICAgICAgICAgICAgICAgdW5pdF9wcmljZTpwcmQucHJlY2lvXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IHByZWZlcmVuY2UgPSB7XG4gICAgICAgICAgICAgICAgaXRlbXMsXG4gICAgICAgICAgICAgICAgcGF5ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbm9tYnJlLFxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogZW1haWwsXG4gICAgICAgICAgICAgICAgICAgIHBob25lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmVhX2NvZGU6IFwiMTFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcjogdGVsZWZvbm9cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWRkcmVzczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWV0X25hbWU6IGFkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYmFja191cmxzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IFVSTF9QUk9DRVNBUl9WRU5UQSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbHVyZTogVVJMX1BST0NFU0FSX1ZFTlRBLFxuICAgICAgICAgICAgICAgICAgICBwZW5kaW5nOiBVUkxfUFJPQ0VTQVJfVkVOVEFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kczoge1xuICAgICAgICAgICAgICAgICAgICBleGNsdWRlZF9wYXltZW50X3R5cGVzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGlkOiBcInRpY2tldFwiIH1cbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFsbG1lbnRzOiAxXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyBub3RpZmljYXRpb25fdXJsOiBcImh0dHBzOi8vaG9va2IuaW4vN1paS0pQQjg5YUZhOTlEM3kzZW9cIixcbiAgICAgICAgICAgICAgICBzdGF0ZW1lbnRfZGVzY3JpcHRvcjogXCJPTElWRVJfUEVUU0hPUFwiLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3JlZmVyZW5jZTogXCJcIixcbiAgICAgICAgICAgICAgICBzaGlwbWVudHM6e1xuICAgICAgICAgICAgICAgICAgICBtb2RlOlwibm90X3NwZWNpZmllZFwiLFxuICAgICAgICAgICAgICAgICAgICBjb3N0OnRvdGFsRW52aW8sXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyX2FkZHJlc3M6e1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWV0X25hbWU6YWRkcmVzc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmZXRjaCgnaHR0cHM6Ly9hcGkubWVyY2Fkb3BhZ28uY29tL2NoZWNrb3V0L3ByZWZlcmVuY2VzJyx7XG4gICAgICAgICAgICAgICAgbWV0aG9kOidQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6SlNPTi5zdHJpbmdpZnkocHJlZmVyZW5jZSlcbiAgICAgICAgICAgIH0pLnRoZW4ocmVzPT5yZXMuanNvbigpKS50aGVuKGRhdGE9PntcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uYXNzaWduKGRhdGEuaW5pdF9wb2ludCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBkYXRhVG9SZXF1ZXN0ID0ge1xuICAgICAgICAgICAgZW52aW86e1xuICAgICAgICAgICAgICAgIGlkWm9uYSxcbiAgICAgICAgICAgICAgICB0aXBvOnRpcG9FbnZpb1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHZlbnRhOntcbiAgICAgICAgICAgICAgICBzdWJ0b3RhbCxcbiAgICAgICAgICAgICAgICBwb3JjZW50YWplX2Rlc2N1ZW50byxcbiAgICAgICAgICAgICAgICBkZXNjdWVudG8sXG4gICAgICAgICAgICAgICAgdG90YWwsXG4gICAgICAgICAgICAgICAgaWRVc3VhcmlvLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RvcyxcbiAgICAgICAgICAgICAgICBpZE1lZGlvUGFnb1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWdpc3RyYXJWZW50YShkYXRhVG9SZXF1ZXN0LHRva2VuKTtcbiAgICB9XG5cbiAgICBjb25zdCByZWdpc3RyYXJWZW50YSA9IGFzeW5jIChkYXRhLHRva2VuKT0+e1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgICAgICAgICBoZWFkZXJzLmFwcGVuZCgndG9rZW4nLHRva2VuKTtcbiAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcbiAgICAgICAgICAgIGxldCB1cmwgPSBgJHtBUEl9L3ZlbnRhcy9yZWdpc3RyYXJWZW50YWA7XG4gICAgICAgICAgICBjb25zdCByZXFWZW50YSA9IGF3YWl0IGZldGNoKHVybCx7XG4gICAgICAgICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLFxuICAgICAgICAgICAgICAgIGJvZHk6SlNPTi5zdHJpbmdpZnkoZGF0YSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYocmVxVmVudGEuc3RhdHVzID09IDIwMCl7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2RhdGFFbnZpbycpO1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjYXJyaXRvJyk7XG4gICAgICAgICAgICAgICAgU3dhbC5maXJlKFxuICAgICAgICAgICAgICAgICAgICAnTGlzdG8nLFxuICAgICAgICAgICAgICAgICAgICAnU3UgY29tcHJhIHNlIGhhIHJlZ2lzdHJhZG8gY29uIMOpeGl0bywgc29sbyByZXN0YSBxdWUgc2UgZGlyaWphIGEgbnVlc3RybyBsb2NhbCBwYXJhIGhhY2Vyc2UgY29uIHN1IHByb2R1Y3RvLicsXG4gICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJ1xuICAgICAgICAgICAgICAgICkudGhlbigoKT0+d2luZG93LmxvY2F0aW9uLmFzc2lnbignLycpKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgICAgIFN3YWwuZmlyZShcbiAgICAgICAgICAgICAgICAgICAgJ0Vycm9yJyxcbiAgICAgICAgICAgICAgICAgICAgJ0hhIG9jdXJyaWRvIHVuIGVycm9yIGFsIG1vbWVudG8gZGUgcmVnaXN0cmFyIGxhIHZlbnRhLCBpbnRlbnRhbG8gbcOhcyB0YXJkZScsXG4gICAgICAgICAgICAgICAgICAgICdlcnJvcidcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICBTd2FsLmZpcmUoXG4gICAgICAgICAgICAgICAgJ0Vycm9yJyxcbiAgICAgICAgICAgICAgICAnSGEgb2N1cnJpZG8gdW4gZXJyb3IgYWwgbW9tZW50byBkZSByZWdpc3RyYXIgbGEgdmVudGEsIGludGVudGFsbyBtw6FzIHRhcmRlJyxcbiAgICAgICAgICAgICAgICAnZXJyb3InXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZihlcnJvcil7XG4gICAgICAgIFN3YWwuZmlyZShcbiAgICAgICAgICAgICdBdGVuY2nDs24nLFxuICAgICAgICAgICAgZXJyb3IsXG4gICAgICAgICAgICAnd2FybmluZydcbiAgICAgICAgKS50aGVuKCgpPT5zZXRFcnJvcihmYWxzZSkpXG4gICAgfVxuXG4gICAgY29uc3QgaGFiaWxpdGFyTW9kYWwgPSAoKT0+e1xuICAgICAgICBzZXRNb2RhbElzT3BlbighbW9kYWxJc09wZW4pO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICAgICghcHJvcHMudXN1YXJpb1JlZHVjZXIubG9ndWVhZG8pPzxkaXYgY2xhc3NOYW1lPVwibXQtM1wiPjxFcnJvciBtZXNzYWdlPVwiTm8gcHVlZGVzIHJlYWxpemFyIHVuYSBjb21wcmEgc2luIHRlbmVyIHVuYSBzZXNpw7NuIGFjdGl2YS5cIi8+PC9kaXY+OlxuICAgICAgICA8PlxuICAgICAgICAgICAgeyhsb2FkaW5nKT88ZGl2IGNsYXNzTmFtZT1cImNvbnRhaW5lci1sb2FkZXJcIj48TG9hZGVyLz48L2Rpdj46bnVsbH0gICBcbiAgICAgICAgICAgIDxIZWFkIHRpdGxlPVwiT2xpdmVyIFBldCBTaG9wXCIvPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250YWluZXIgbWItNFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm93XCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLTEyIGNvbC1tZC04IHB0LTRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxoMj7Dmmx0aW1vcyBwYXNvcyBwYXJhIHRlcm1pbmFyIHR1IGNvbXByYTwvaDI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Q2FyZFViaWNhY2lvbi8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxlcnQgYWxlcnQtd2FybmluZyBtdC0zXCI+PGI+QXRlbmNpw7NuOjwvYj4gU8OtIGRlc2VhIHJldGlyYXIgc3UgY29tcHJhIGVuIG51ZXN0cm8gbG9jYWwsIG5vIGVzIG5lY2VzYXJpbyBxdWUgc2VsZWNjaW9uZSB1bmEgem9uYSBkZSBlbnbDrW88L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPFpvbmFFbnZpby8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJtdC01XCI+T3BjaW9uZXMgZGUgZW52w61vPC9oMj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxPcGNpb25lc0VudmlvLz5cblxuICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT1cIm10LTVcIj5TZWxlY2Npb25hIHVuIG1lZGlvIGRlIHBhZ288L2gyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPE1lZGlvc0RlUGFnby8+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzTmFtZT1cImJ0biBidG4tcHJpbWFyeVwiIG9uQ2xpY2s9e2hhbmRsZUNsaWNrfSBpZD1cImJ0bi1jb250aW51YXJcIj5Db250aW51YXI8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZGl2VG90YWxNb2JpbGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBpZD1cInRvdGFsXCI+JHtwcm9wcy52ZW50YVJlZHVjZXIudG90YWx9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzTmFtZT1cImJ0biBidG4tcHJpbWFyeVwiIG9uQ2xpY2s9e2hhbmRsZUNsaWNrfT5Db250aW51YXI8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtMTIgY29sLW1kLTQgZGV0YWxsZVByb2R1Y3Rvc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPERldGFsbGVQcm9kdWN0b3MvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8c3R5bGUganN4PntgXG4gICAgICAgICAgICAgICAgICAgIGgye2ZvbnQtc2l6ZToyNXB4fVxuICAgICAgICAgICAgICAgICAgICBidXR0b24jYnRuLWNvbnRpbnVhcntcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0OnJpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXRvcDoyMHB4XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLmRpdlRvdGFsTW9iaWxle2Rpc3BsYXk6bm9uZX1cbiAgICAgICAgICAgICAgICAgICAgQG1lZGlhKG1heC13aWR0aDo3NjhweCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAjYnRuLWNvbnRpbnVhcntkaXNwbGF5Om5vbmV9XG4gICAgICAgICAgICAgICAgICAgICAgICAuZGl2VG90YWxNb2JpbGV7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OjA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6MHB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbTogMHB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmN2Y3Zjc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogMTZweDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIC0ycHggOHB4IDJweCByZ2JhKDAsMCwwLC4xNSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXdpZHRoOiAwIDFweCAxcHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdRdWlja3NhbmQnLCBzYW5zLXNlcmlmO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgIC5kZXRhbGxlUHJvZHVjdG9ze1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6bm9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBgfTwvc3R5bGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIHttb2RhbElzT3BlbiA/IDxNb2RhbCBjbG9zZU1vZGFsPXtoYWJpbGl0YXJNb2RhbH0+PEZvcm1WZW50YSBjbG9zZU1vZGFsPXtoYWJpbGl0YXJNb2RhbH0vPjwvTW9kYWw+IDogbnVsbH1cbiAgICAgICAgPC8+XG4gICAgKTtcbn1cbiBcbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9ICh7dXN1YXJpb1JlZHVjZXIsZW52aW9zUmVkdWNlcix2ZW50YVJlZHVjZXIsem9uYXNSZWR1Y2VyfSk9PntcbiAgICByZXR1cm4ge1xuICAgICAgICB2ZW50YVJlZHVjZXIsXG4gICAgICAgIHVzdWFyaW9SZWR1Y2VyLFxuICAgICAgICBlbnZpb3NSZWR1Y2VyLFxuICAgICAgICB6b25hc1JlZHVjZXJcbiAgICB9O1xufVxuXG5jb25zdCBtYXBEaXNwYXRjaFRvUHJvcHMgPSB7XG4gICAgdmVyaWZpY2FyU2VzaW9uXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcyxtYXBEaXNwYXRjaFRvUHJvcHMpKENoZWNrb3V0KTsiXX0= */\\n/*@ sourceURL=/home/franco/desarrollo/oliver/oliver-sitio/pages/checkout/index.js */\")), modalIsOpen ? __jsx(Modal, {\n    closeModal: habilitarModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 28\n    }\n  }, __jsx(FormVenta, {\n    closeModal: habilitarModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 63\n    }\n  })) : null);\n};\n\nconst mapStateToProps = ({\n  usuarioReducer,\n  enviosReducer,\n  ventaReducer,\n  zonasReducer\n}) => {\n  return {\n    ventaReducer,\n    usuarioReducer,\n    enviosReducer,\n    zonasReducer\n  };\n};\n\nconst mapDispatchToProps = {\n  verificarSesion\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Checkout);","map":{"version":3,"sources":["/home/franco/desarrollo/oliver/oliver-sitio/pages/checkout/index.js"],"names":["useEffect","useState","CardUbicacion","OpcionesEnvio","ZonaEnvio","Head","DetalleProductos","Error","connect","usuarioActions","API","MP_AC_TOKEN","URL_PROCESAR_VENTA","Loader","MediosDePago","Modal","Swal","require","verificarSesion","Checkout","props","error","setError","loading","setLoading","modalIsOpen","setModalIsOpen","document","getElementsByTagName","style","overflowY","handleClick","usuario","usuarioReducer","tipos","envio","enviosReducer","zona","zonasReducer","tipoEnvio","idZona","idMedioPago","total","subtotal","productos","porcentaje_descuento","descuento","totalEnvio","ventaReducer","local","address","idUsuario","token","nombre","email","telefono","localStorage","setItem","JSON","stringify","tipo","headers","Headers","append","items","map","prd","push","id","idSubProducto","title","subProducto","currency_id","picture_url","foto","description","producto","tamaño","quantity","cantidad","unit_price","precio","preference","payer","name","phone","area_code","number","street_name","back_urls","success","failure","pending","payment_methods","excluded_payment_types","installments","statement_descriptor","external_reference","shipments","mode","cost","receiver_address","fetch","method","body","then","res","json","data","window","location","assign","init_point","dataToRequest","venta","registrarVenta","url","reqVenta","status","removeItem","fire","console","log","message","habilitarModal","logueado","mapStateToProps","mapDispatchToProps"],"mappings":";;;;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,aAAP,MAA0B,0CAA1B;AACA,OAAOC,aAAP,MAA0B,oCAA1B;AACA,OAAOC,SAAP,MAAsB,gCAAtB;AACA,OAAOC,IAAP,MAAiB,2BAAjB;AACA,OAAOC,gBAAP,MAA6B,uCAA7B;AACA,OAAOC,KAAP,MAAkB,4BAAlB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,KAAKC,cAAZ,MAAgC,oCAAhC;AACA,SAAQC,GAAR,EAAYC,WAAZ,EAAwBC,kBAAxB,QAAiD,oBAAjD;AACA,OAAOC,MAAP,MAAmB,mCAAnB;AACA,OAAOC,YAAP,MAAyB,mCAAzB;AACA,OAAOC,KAAP,MAAkB,4BAAlB,C,CACA;AACA;;AACA,MAAMC,IAAI,GAAGC,OAAO,CAAC,aAAD,CAApB;;AAEA,MAAM;AAACC,EAAAA;AAAD,IAAoBT,cAA1B;;AAEA,MAAMU,QAAQ,GAAIC,KAAD,IAAW;AACxB,QAAM;AAAA,OAACC,KAAD;AAAA,OAAQC;AAAR,MAAoBrB,QAAQ,CAAC,KAAD,CAAlC;AACA,QAAM;AAAA,OAACsB,OAAD;AAAA,OAAUC;AAAV,MAAwBvB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM;AAAA,OAACwB,WAAD;AAAA,OAAcC;AAAd,MAAgCzB,QAAQ,CAAC,KAAD,CAA9C,CAHwB,CAG8B;;AAEtDD,EAAAA,SAAS,CAAC,MAAM;AACZoB,IAAAA,KAAK,CAACF,eAAN;AACAS,IAAAA,QAAQ,CAACC,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyCC,KAAzC,CAA+CC,SAA/C,GAA2D,QAA3D;AACH,GAHQ,EAGN,EAHM,CAAT,CALwB,CAUxB;;AAEA,QAAMC,WAAW,GAAG,MAAI;AACpB,UAAM;AAACC,MAAAA;AAAD,QAAYZ,KAAK,CAACa,cAAxB;AACA,UAAM;AAACC,MAAAA,KAAK,EAACC;AAAP,QAAgBf,KAAK,CAACgB,aAA5B;AACA,UAAM;AAACC,MAAAA;AAAD,QAASjB,KAAK,CAACkB,YAArB;AACA,UAAM;AAACC,MAAAA,SAAD;AAAWC,MAAAA,MAAX;AAAkBC,MAAAA,WAAlB;AAA8BC,MAAAA,KAA9B;AAAoCC,MAAAA,QAApC;AAA6CC,MAAAA,SAA7C;AAAuDC,MAAAA,oBAAvD;AAA4EC,MAAAA,SAA5E;AAAsFC,MAAAA;AAAtF,QAAoG3B,KAAK,CAAC4B,YAAhH;;AAEA,QAAG,CAACb,KAAK,CAACc,KAAV,EAAgB;AACZ,UAAG,CAACjB,OAAO,CAACkB,OAAT,IAAoBlB,OAAO,CAACkB,OAAR,KAAkB,EAAzC,EAA6C,OAAO5B,QAAQ,CAAC,wCAAD,CAAf;AAC7C,UAAG,CAACe,IAAJ,EAAU,OAAOf,QAAQ,CAAC,uFAAD,CAAf;AACb;;AACDA,IAAAA,QAAQ,CAAC,KAAD,CAAR;AACAE,IAAAA,UAAU,CAAC,IAAD,CAAV;AACA,UAAM;AAAC2B,MAAAA,SAAD;AAAWC,MAAAA,KAAX;AAAiBC,MAAAA,MAAjB;AAAwBC,MAAAA,KAAxB;AAA8BC,MAAAA,QAA9B;AAAuCL,MAAAA;AAAvC,QAAkDlB,OAAxD;;AACA,QAAGS,WAAW,IAAI,GAAlB,EAAsB;AAClB;AACAe,MAAAA,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAiCC,IAAI,CAACC,SAAL,CAAe;AAACC,QAAAA,IAAI,EAACrB,SAAN;AAAgBF,QAAAA,IAAI,EAACG;AAArB,OAAf,CAAjC;AACA,UAAIqB,OAAO,GAAG,IAAIC,OAAJ,EAAd;AACAD,MAAAA,OAAO,CAACE,MAAR,CAAe,eAAf,EAAgC,UAASpD,WAAY,EAArD;AACAkD,MAAAA,OAAO,CAACE,MAAR,CAAe,cAAf,EAA+B,kBAA/B;AACA,UAAIC,KAAK,GAAG,EAAZ;AACApB,MAAAA,SAAS,CAACqB,GAAV,CAAcC,GAAG,IAAE;AACfF,QAAAA,KAAK,CAACG,IAAN,CAAW;AACPC,UAAAA,EAAE,EAACF,GAAG,CAACG,aADA;AAEPC,UAAAA,KAAK,EAACJ,GAAG,CAACK,WAFH;AAGPC,UAAAA,WAAW,EAAC,KAHL;AAIPC,UAAAA,WAAW,EAACP,GAAG,CAACQ,IAJT;AAKPC,UAAAA,WAAW,EAACT,GAAG,CAACU,QAAJ,GAAe,IAAf,GAAqBV,GAAG,CAACW,MAAzB,GAAkC,GALvC;AAMPC,UAAAA,QAAQ,EAACZ,GAAG,CAACa,QANN;AAOPC,UAAAA,UAAU,EAACd,GAAG,CAACe;AAPR,SAAX;AASH,OAVD;AAWA,UAAIC,UAAU,GAAG;AACblB,QAAAA,KADa;AAEbmB,QAAAA,KAAK,EAAE;AACHC,UAAAA,IAAI,EAAE/B,MADH;AAEHC,UAAAA,KAAK,EAAEA,KAFJ;AAGH+B,UAAAA,KAAK,EAAE;AACHC,YAAAA,SAAS,EAAE,IADR;AAEHC,YAAAA,MAAM,EAAEhC;AAFL,WAHJ;AAOHL,UAAAA,OAAO,EAAE;AACLsC,YAAAA,WAAW,EAAEtC;AADR;AAPN,SAFM;AAabuC,QAAAA,SAAS,EAAE;AACPC,UAAAA,OAAO,EAAE9E,kBADF;AAEP+E,UAAAA,OAAO,EAAE/E,kBAFF;AAGPgF,UAAAA,OAAO,EAAEhF;AAHF,SAbE;AAkBbiF,QAAAA,eAAe,EAAE;AACbC,UAAAA,sBAAsB,EAAE,CACpB;AAAE1B,YAAAA,EAAE,EAAE;AAAN,WADoB,CADX;AAIb2B,UAAAA,YAAY,EAAE;AAJD,SAlBJ;AAwBb;AACAC,QAAAA,oBAAoB,EAAE,gBAzBT;AA0BbC,QAAAA,kBAAkB,EAAE,EA1BP;AA2BbC,QAAAA,SAAS,EAAC;AACNC,UAAAA,IAAI,EAAC,eADC;AAENC,UAAAA,IAAI,EAACrD,UAFC;AAGNsD,UAAAA,gBAAgB,EAAC;AACbb,YAAAA,WAAW,EAACtC;AADC;AAHX;AA3BG,OAAjB;AAoCAoD,MAAAA,KAAK,CAAC,kDAAD,EAAoD;AACrDC,QAAAA,MAAM,EAAC,MAD8C;AAErD1C,QAAAA,OAFqD;AAGrD2C,QAAAA,IAAI,EAAC9C,IAAI,CAACC,SAAL,CAAeuB,UAAf;AAHgD,OAApD,CAAL,CAIGuB,IAJH,CAIQC,GAAG,IAAEA,GAAG,CAACC,IAAJ,EAJb,EAIyBF,IAJzB,CAI8BG,IAAI,IAAE;AAChCC,QAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuBH,IAAI,CAACI,UAA5B;AACH,OAND;AAOA;AACH;;AACD,QAAIC,aAAa,GAAG;AAChB9E,MAAAA,KAAK,EAAC;AACFK,QAAAA,MADE;AAEFoB,QAAAA,IAAI,EAACrB;AAFH,OADU;AAKhB2E,MAAAA,KAAK,EAAC;AACFvE,QAAAA,QADE;AAEFE,QAAAA,oBAFE;AAGFC,QAAAA,SAHE;AAIFJ,QAAAA,KAJE;AAKFS,QAAAA,SALE;AAMFP,QAAAA,SANE;AAOFH,QAAAA;AAPE;AALU,KAApB;AAeA,WAAO0E,cAAc,CAACF,aAAD,EAAe7D,KAAf,CAArB;AACH,GA5FD;;AA8FA,QAAM+D,cAAc,GAAG,OAAOP,IAAP,EAAYxD,KAAZ,KAAoB;AACvC,QAAI;AACA,YAAMS,OAAO,GAAG,IAAIC,OAAJ,EAAhB;AACAD,MAAAA,OAAO,CAACE,MAAR,CAAe,OAAf,EAAuBX,KAAvB;AACAS,MAAAA,OAAO,CAACE,MAAR,CAAe,cAAf,EAA+B,kBAA/B;AACA,UAAIqD,GAAG,GAAI,GAAE1G,GAAI,wBAAjB;AACA,YAAM2G,QAAQ,GAAG,MAAMf,KAAK,CAACc,GAAD,EAAK;AAC7BvD,QAAAA,OAD6B;AAE7B0C,QAAAA,MAAM,EAAC,MAFsB;AAG7BC,QAAAA,IAAI,EAAC9C,IAAI,CAACC,SAAL,CAAeiD,IAAf;AAHwB,OAAL,CAA5B;;AAKA,UAAGS,QAAQ,CAACC,MAAT,IAAmB,GAAtB,EAA0B;AACtB9D,QAAAA,YAAY,CAAC+D,UAAb,CAAwB,WAAxB;AACA/D,QAAAA,YAAY,CAAC+D,UAAb,CAAwB,SAAxB;AACAvG,QAAAA,IAAI,CAACwG,IAAL,CACI,OADJ,EAEI,8GAFJ,EAGI,SAHJ,EAIEf,IAJF,CAIO,MAAII,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,GAAvB,CAJX;AAKH,OARD,MAQK;AACDvF,QAAAA,UAAU,CAAC,KAAD,CAAV;AACAR,QAAAA,IAAI,CAACwG,IAAL,CACI,OADJ,EAEI,4EAFJ,EAGI,OAHJ;AAKH;AACJ,KA1BD,CA0BE,OAAOnG,KAAP,EAAc;AACZG,MAAAA,UAAU,CAAC,KAAD,CAAV;AACAR,MAAAA,IAAI,CAACwG,IAAL,CACI,OADJ,EAEI,4EAFJ,EAGI,OAHJ;AAKAC,MAAAA,OAAO,CAACC,GAAR,CAAYrG,KAAK,CAACsG,OAAlB;AACH;AACJ,GApCD;;AAsCA,MAAGtG,KAAH,EAAS;AACLL,IAAAA,IAAI,CAACwG,IAAL,CACI,UADJ,EAEInG,KAFJ,EAGI,SAHJ,EAIEoF,IAJF,CAIO,MAAInF,QAAQ,CAAC,KAAD,CAJnB;AAKH;;AAED,QAAMsG,cAAc,GAAG,MAAI;AACvBlG,IAAAA,cAAc,CAAC,CAACD,WAAF,CAAd;AACH,GAFD;;AAIA,SACK,CAACL,KAAK,CAACa,cAAN,CAAqB4F,QAAvB,GAAiC;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAsB,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC,+DAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAtB,CAAjC,GACA,4BACMtG,OAAD,GAAU;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAkC,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAlC,CAAV,GAA4D,IADjE,EAEI,MAAC,IAAD;AAAM,IAAA,KAAK,EAAC,iBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAGI;AAAA,wCAAe,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA,wCAAe,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA,wCAAe,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gDADJ,EAEI,MAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAII;AAAA,wCAAe,0BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAA1C,yGAJJ,EAMI,MAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANJ,EAQI;AAAA,wCAAc,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BARJ,EASI,MAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IATJ,EAWI;AAAA,wCAAc,MAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAXJ,EAYI,MAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAZJ,EAcI;AAAQ,IAAA,IAAI,EAAC,QAAb;AAAkD,IAAA,OAAO,EAAEQ,WAA3D;AAAwE,IAAA,EAAE,EAAC,eAA3E;AAAA,wCAAgC,iBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAdJ,EAeI;AAAA,wCAAe,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAM,IAAA,EAAE,EAAC,OAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAmBX,KAAK,CAAC4B,YAAN,CAAmBN,KAAtC,CADJ,EAEI;AAAQ,IAAA,IAAI,EAAC,QAAb;AAAkD,IAAA,OAAO,EAAEX,WAA3D;AAAA,wCAAgC,iBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAFJ,CAfJ,CADJ,EAqBI;AAAA,wCAAe,kCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CArBJ,CADJ;AAAA;AAAA;AAAA,k9cAHJ,EAyDKN,WAAW,GAAG,MAAC,KAAD;AAAO,IAAA,UAAU,EAAEmG,cAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAmC,MAAC,SAAD;AAAW,IAAA,UAAU,EAAEA,cAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAnC,CAAH,GAAyF,IAzDzG,CAFJ;AA8DH,CA1ND;;AA4NA,MAAME,eAAe,GAAG,CAAC;AAAC7F,EAAAA,cAAD;AAAgBG,EAAAA,aAAhB;AAA8BY,EAAAA,YAA9B;AAA2CV,EAAAA;AAA3C,CAAD,KAA4D;AAChF,SAAO;AACHU,IAAAA,YADG;AAEHf,IAAAA,cAFG;AAGHG,IAAAA,aAHG;AAIHE,IAAAA;AAJG,GAAP;AAMH,CAPD;;AASA,MAAMyF,kBAAkB,GAAG;AACvB7G,EAAAA;AADuB,CAA3B;AAIA,eAAeV,OAAO,CAACsH,eAAD,EAAiBC,kBAAjB,CAAP,CAA4C5G,QAA5C,CAAf","sourcesContent":["import { useEffect, useState } from 'react';\nimport CardUbicacion from '../../src/components/CardUbicacion/index'; \nimport OpcionesEnvio from '../../src/components/OpcionesEnvio';\nimport ZonaEnvio from '../../src/components/ZonaEnvio';\nimport Head from '../../src/components/Head';\nimport DetalleProductos from '../../src/components/DetalleProductos';\nimport Error from '../../src/components/Error';\nimport { connect } from 'react-redux';\nimport * as usuarioActions from '../../store/actions/usuarioActions';\nimport {API,MP_AC_TOKEN,URL_PROCESAR_VENTA} from '../../config/index';\nimport Loader from '../../src/components/Loader/index';\nimport MediosDePago from '../../src/components/MediosDePago';\nimport Modal from '../../src/components/Modal';\n//import Router from 'next/router';\n//import FormVenta from '../../src/components/FormVenta';\nconst Swal = require('sweetalert2');\n\nconst {verificarSesion} = usuarioActions;\n\nconst Checkout = (props) => {\n    const [error, setError] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [modalIsOpen, setModalIsOpen] = useState(false);//modal para mostrar el form de datos de tarjeta\n\n    useEffect(() => {\n        props.verificarSesion();\n        document.getElementsByTagName('body')[0].style.overflowY = 'scroll';\n    }, []);\n\n    //console.log(URL_PROCESAR_VENTA);\n\n    const handleClick = ()=>{\n        const {usuario} = props.usuarioReducer;\n        const {tipos:envio} = props.enviosReducer;\n        const {zona} = props.zonasReducer;\n        const {tipoEnvio,idZona,idMedioPago,total,subtotal,productos,porcentaje_descuento,descuento,totalEnvio} = props.ventaReducer;\n\n        if(!envio.local){\n            if(!usuario.address || usuario.address==='') return setError('Es obligatorio completar tu ubicación.');\n            if(!zona) return setError('En caso de no retirarlo por nuestro local, es obligatorio completar la zona de envío.');\n        }\n        setError(false);\n        setLoading(true);\n        const {idUsuario,token,nombre,email,telefono,address} = usuario;\n        if(idMedioPago == '1'){\n            //guardo data de envio para luego de hacer el checkout de mercado pago, envio los datos al servidor para registrar la venta con el envio correspondiente.\n            localStorage.setItem('dataEnvio',JSON.stringify({tipo:tipoEnvio,zona:idZona}));\n            let headers = new Headers();\n            headers.append('Authorization',`Bearer ${MP_AC_TOKEN}`);\n            headers.append(\"Content-Type\", \"application/json\");\n            let items = [];\n            productos.map(prd=>{\n                items.push({\n                    id:prd.idSubProducto,\n                    title:prd.subProducto,\n                    currency_id:\"ARS\",\n                    picture_url:prd.foto,\n                    description:prd.producto + ' ('+ prd.tamaño + ')',\n                    quantity:prd.cantidad,\n                    unit_price:prd.precio\n                })\n            });\n            let preference = {\n                items,\n                payer: {\n                    name: nombre,\n                    email: email,\n                    phone: {\n                        area_code: \"11\",\n                        number: telefono\n                    },\n                    address: {\n                        street_name: address\n                    }\n                },\n                back_urls: {\n                    success: URL_PROCESAR_VENTA,\n                    failure: URL_PROCESAR_VENTA,\n                    pending: URL_PROCESAR_VENTA\n                },\n                payment_methods: {\n                    excluded_payment_types: [\n                        { id: \"ticket\" }\n                    ],\n                    installments: 1\n                },\n                // notification_url: \"https://hookb.in/7ZZKJPB89aFa99D3y3eo\",\n                statement_descriptor: \"OLIVER_PETSHOP\",\n                external_reference: \"\",\n                shipments:{\n                    mode:\"not_specified\",\n                    cost:totalEnvio,\n                    receiver_address:{\n                        street_name:address\n                    }\n                }\n            }\n\n            fetch('https://api.mercadopago.com/checkout/preferences',{\n                method:'POST',\n                headers,\n                body:JSON.stringify(preference)\n            }).then(res=>res.json()).then(data=>{\n                window.location.assign(data.init_point);\n            })\n            return;\n        }\n        let dataToRequest = {\n            envio:{\n                idZona,\n                tipo:tipoEnvio\n            },\n            venta:{\n                subtotal,\n                porcentaje_descuento,\n                descuento,\n                total,\n                idUsuario,\n                productos,\n                idMedioPago\n            }\n        }\n        return registrarVenta(dataToRequest,token);\n    }\n\n    const registrarVenta = async (data,token)=>{\n        try {\n            const headers = new Headers();\n            headers.append('token',token);\n            headers.append(\"Content-Type\", \"application/json\");\n            let url = `${API}/ventas/registrarVenta`;\n            const reqVenta = await fetch(url,{\n                headers,\n                method:'POST',\n                body:JSON.stringify(data)\n            });\n            if(reqVenta.status == 200){\n                localStorage.removeItem('dataEnvio');\n                localStorage.removeItem('carrito');\n                Swal.fire(\n                    'Listo',\n                    'Su compra se ha registrado con éxito, solo resta que se dirija a nuestro local para hacerse con su producto.',\n                    'success'\n                ).then(()=>window.location.assign('/'));\n            }else{\n                setLoading(false);\n                Swal.fire(\n                    'Error',\n                    'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde',\n                    'error'\n                );\n            }\n        } catch (error) {\n            setLoading(false);\n            Swal.fire(\n                'Error',\n                'Ha ocurrido un error al momento de registrar la venta, intentalo más tarde',\n                'error'\n            );\n            console.log(error.message);\n        }\n    }\n\n    if(error){\n        Swal.fire(\n            'Atención',\n            error,\n            'warning'\n        ).then(()=>setError(false))\n    }\n\n    const habilitarModal = ()=>{\n        setModalIsOpen(!modalIsOpen);\n    }\n\n    return (\n        (!props.usuarioReducer.logueado)?<div className=\"mt-3\"><Error message=\"No puedes realizar una compra sin tener una sesión activa.\"/></div>:\n        <>\n            {(loading)?<div className=\"container-loader\"><Loader/></div>:null}   \n            <Head title=\"Oliver Pet Shop\"/>\n            <div className=\"container mb-4\">\n                <div className=\"row\">\n                    <div className=\"col-12 col-md-8 pt-4\">\n                        <h2>Últimos pasos para terminar tu compra</h2>\n                        <CardUbicacion/>\n\n                        <div className=\"alert alert-warning mt-3\"><b>Atención:</b> Sí desea retirar su compra en nuestro local, no es necesario que seleccione una zona de envío</div>\n\n                        <ZonaEnvio/>\n\n                        <h2 className=\"mt-5\">Opciones de envío</h2>\n                        <OpcionesEnvio/>\n\n                        <h2 className=\"mt-5\">Selecciona un medio de pago</h2>\n                        <MediosDePago/>\n\n                        <button type=\"button\" className=\"btn btn-primary\" onClick={handleClick} id=\"btn-continuar\">Continuar</button>\n                        <div className=\"divTotalMobile\">\n                            <span id=\"total\">${props.ventaReducer.total}</span>\n                            <button type=\"button\" className=\"btn btn-primary\" onClick={handleClick}>Continuar</button>\n                        </div>\n                    </div>\n                    <div className=\"col-12 col-md-4 detalleProductos\">\n                        <DetalleProductos/>\n                    </div>\n                </div>\n                <style jsx>{`\n                    h2{font-size:25px}\n                    button#btn-continuar{\n                        float:right;\n                        margin-top:20px\n                    }\n                    .divTotalMobile{display:none}\n                    @media(max-width:768px){\n                        #btn-continuar{display:none}\n                        .divTotalMobile{\n                            display:flex;\n                            justify-content:space-between;\n                            position: fixed;\n                            left:0;\n                            right:0px;\n                            bottom: 0px;\n                            background-color: #f7f7f7;\n                            padding: 16px;\n                            box-shadow: 0 -2px 8px 2px rgba(0,0,0,.15);\n                            border-width: 0 1px 1px;\n                            font-family: 'Quicksand', sans-serif;\n                        } \n                        .detalleProductos{\n                            display:none\n                        }           \n                    }\n                `}</style>\n            </div>\n            {modalIsOpen ? <Modal closeModal={habilitarModal}><FormVenta closeModal={habilitarModal}/></Modal> : null}\n        </>\n    );\n}\n \nconst mapStateToProps = ({usuarioReducer,enviosReducer,ventaReducer,zonasReducer})=>{\n    return {\n        ventaReducer,\n        usuarioReducer,\n        enviosReducer,\n        zonasReducer\n    };\n}\n\nconst mapDispatchToProps = {\n    verificarSesion\n};\n\nexport default connect(mapStateToProps,mapDispatchToProps)(Checkout);"]},"metadata":{},"sourceType":"module"}