{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { API } from '../../config/index';\nimport { isMobile } from '../../helpers/index';\nimport { TRAER_TODOS, TRAER_UNO, LOADING, ERROR, TRAER_PROMOCIONES, ORDENAR_PRODUCTOS, FILTRANDO, LOADING_MAS, TRAER_MAS, TRAER_OFERTAS, APLICAR_FILTRO_CATEGORIA, APLICAR_FILTRO_SUBCATEGORIA, APLICAR_FILTRO_MARCA, APLICAR_FILTRO_BUSCADOR, APLICAR_FILTRO_ORDEN, ELIMINAR_FILTRO_CATEGORIA, ELIMINAR_FILTRO_SUBCATEGORIA, ELIMINAR_FILTRO_MARCA, ELIMINAR_FILTRO_BUSCADOR, ELIMINAR_FILTRO_ORDEN, PRODUCTOS_RESTABLECER_FILTROS, PRODUCTOS_PAGINACION, PRODUCTOS_SIN_RESULTADO } from '../types/productosTypes';\nexport var traerProductos = function traerProductos() {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch, getState) {\n      var _getState$productosRe, filtrando, _getState$productosRe2, categoria, subcategoria, marca, search, orden, _getState$productosRe3, desde, limiteMobile, limiteDesktop, url;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n              _context.prev = 1;\n              //obtengo el estado actualizado de los filtros\n              _getState$productosRe = getState().productosReducer, filtrando = _getState$productosRe.filtrando, _getState$productosRe2 = _getState$productosRe.filtros, categoria = _getState$productosRe2.categoria, subcategoria = _getState$productosRe2.subcategoria, marca = _getState$productosRe2.marca, search = _getState$productosRe2.search, orden = _getState$productosRe2.orden, _getState$productosRe3 = _getState$productosRe.paginacion, desde = _getState$productosRe3.desde, limiteMobile = _getState$productosRe3.limiteMobile, limiteDesktop = _getState$productosRe3.limiteDesktop;\n              url = \"\".concat(API);\n\n              if (!filtrando) {\n                url += \"/producto?desde=\".concat(desde, \"&limite=\").concat(isMobile() ? limiteMobile : limiteDesktop);\n              } else {\n                if (search.trim() !== \"\") {\n                  url += \"/productos/buscar?busqueda=\".concat(search, \"&desde=\").concat(desde, \"&limite=\").concat(isMobile() ? limiteMobile : limiteDesktop);\n                } else {\n                  url += \"/productos/filtro/filtrar?desde=\".concat(desde, \"&limite=\").concat(isMobile() ? limiteMobile : limiteDesktop, \"&\");\n\n                  if (categoria) {\n                    url += \"categoria=\".concat(categoria, \"&\");\n                  }\n\n                  if (subcategoria) {\n                    url += \"subcategoria=\".concat(subcategoria, \"&\");\n                  }\n\n                  if (marca) {\n                    url += \"marca=\".concat(marca);\n                  }\n                }\n              } // console.log(url);\n\n\n              return _context.abrupt(\"return\", fetch(url).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                dispatch({\n                  type: TRAER_TODOS,\n                  payload: data.data\n                });\n              }));\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context.t0\n              });\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 8]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var traerMas = function traerMas() {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch, getState) {\n      var _getState$productosRe4, productos, filtrando, _getState$productosRe5, categoria, subcategoria, marca, search, orden, _getState$productosRe6, desde, limiteMobile, limiteDesktop, url;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dispatch({\n                type: LOADING_MAS\n              });\n              _context2.prev = 1;\n              //obtengo el estado actualizado de los filtros\n              _getState$productosRe4 = getState().productosReducer, productos = _getState$productosRe4.productos, filtrando = _getState$productosRe4.filtrando, _getState$productosRe5 = _getState$productosRe4.filtros, categoria = _getState$productosRe5.categoria, subcategoria = _getState$productosRe5.subcategoria, marca = _getState$productosRe5.marca, search = _getState$productosRe5.search, orden = _getState$productosRe5.orden, _getState$productosRe6 = _getState$productosRe4.paginacion, desde = _getState$productosRe6.desde, limiteMobile = _getState$productosRe6.limiteMobile, limiteDesktop = _getState$productosRe6.limiteDesktop;\n              url = \"\".concat(API);\n\n              if (!filtrando) {\n                url += \"/producto?desde=\".concat(desde, \"&limite=\").concat(isMobile() ? limiteMobile : limiteDesktop);\n              } else {\n                if (search.trim() !== \"\") {\n                  url += \"/buscar?busqueda=\".concat(search);\n                } else {\n                  url += \"/productos/filtro/filtrar?desde=\".concat(desde, \"&limite=\").concat(isMobile() ? limiteMobile : limiteDesktop, \"&\");\n\n                  if (categoria) {\n                    url += \"categoria=\".concat(categoria, \"&\");\n                  }\n\n                  if (subcategoria) {\n                    url += \"subcategoria=\".concat(subcategoria, \"&\");\n                  }\n\n                  if (marca) {\n                    url += \"marca=\".concat(marca);\n                  }\n                }\n              }\n\n              return _context2.abrupt(\"return\", fetch(url).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                if (data.data.length === 0) {\n                  dispatch({\n                    type: PRODUCTOS_SIN_RESULTADO\n                  });\n                  return;\n                }\n\n                var updateproductos = [].concat(_toConsumableArray(productos), _toConsumableArray(data.data));\n                dispatch({\n                  type: TRAER_MAS,\n                  payload: updateproductos\n                });\n              }));\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context2.t0\n              });\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 8]]);\n    }));\n\n    return function (_x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var traerPorId = function traerPorId(id) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n              _context3.prev = 1;\n              return _context3.abrupt(\"return\", fetch(\"\".concat(API, \"/producto/\").concat(id)).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                dispatch({\n                  type: TRAER_UNO,\n                  payload: data\n                });\n              }));\n\n            case 5:\n              _context3.prev = 5;\n              _context3.t0 = _context3[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context3.t0\n              });\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 5]]);\n    }));\n\n    return function (_x5) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};\nexport var traerPromociones = function traerPromociones() {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch) {\n      var url;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n              _context4.prev = 1;\n              url = \"\".concat(API, \"/subproductos/ofertas?desde=0&limite=9\");\n\n              if (isMobile()) {\n                url = \"\".concat(API, \"/subproductos/ofertas?desde=0&limite=6\");\n              }\n\n              return _context4.abrupt(\"return\", fetch(url).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                dispatch({\n                  type: TRAER_OFERTAS,\n                  payload: data.data\n                });\n              }));\n\n            case 7:\n              _context4.prev = 7;\n              _context4.t0 = _context4[\"catch\"](1);\n              dispatch({\n                type: ERROR,\n                payload: _context4.t0.message\n              });\n\n            case 10:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 7]]);\n    }));\n\n    return function (_x6) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};\nexport var ordenarProductos = function ordenarProductos(productosOrdenados) {\n  return /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              dispatch({\n                type: LOADING\n              });\n\n              try {\n                dispatch({\n                  type: ORDENAR_PRODUCTOS,\n                  payload: productosOrdenados\n                });\n              } catch (error) {\n                dispatch({\n                  type: ERROR,\n                  payload: error\n                });\n              }\n\n            case 2:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function (_x7) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n};\nexport var aplicarFiltro = function aplicarFiltro(tipo, valor) {\n  return function (dispatch) {\n    switch (tipo) {\n      case 'categoria':\n        dispatch({\n          type: APLICAR_FILTRO_CATEGORIA,\n          payload: valor\n        });\n        break;\n\n      case 'subcategoria':\n        dispatch({\n          type: APLICAR_FILTRO_SUBCATEGORIA,\n          payload: valor\n        });\n        break;\n\n      case 'marca':\n        dispatch({\n          type: APLICAR_FILTRO_MARCA,\n          payload: valor\n        });\n        break;\n\n      case 'search':\n        dispatch({\n          type: APLICAR_FILTRO_BUSCADOR,\n          payload: valor\n        });\n        break;\n\n      case 'orden':\n        dispatch({\n          type: APLICAR_FILTRO_ORDEN,\n          payload: valor\n        });\n        break;\n\n      default:\n        break;\n    }\n  };\n};\nexport var quitarFiltro = function quitarFiltro(tipo) {\n  return function (dispatch, getState) {\n    var _getState$productosRe7 = getState().productosReducer.filtros,\n        categoria = _getState$productosRe7.categoria,\n        subcategoria = _getState$productosRe7.subcategoria,\n        marca = _getState$productosRe7.marca,\n        search = _getState$productosRe7.search,\n        orden = _getState$productosRe7.orden;\n\n    switch (tipo) {\n      case 'categoria':\n        if (!subcategoria && !marca) {\n          dispatch({\n            type: PRODUCTOS_RESTABLECER_FILTROS\n          });\n        } else {\n          dispatch({\n            type: ELIMINAR_FILTRO_CATEGORIA\n          });\n        }\n\n        break;\n\n      case 'subcategoria':\n        if (!categoria && !marca) {\n          dispatch({\n            type: PRODUCTOS_RESTABLECER_FILTROS\n          });\n        } else {\n          dispatch({\n            type: ELIMINAR_FILTRO_SUBCATEGORIA\n          });\n        }\n\n        break;\n\n      case 'marca':\n        if (!categoria && !subcategoria) {\n          dispatch({\n            type: PRODUCTOS_RESTABLECER_FILTROS\n          });\n        } else {\n          dispatch({\n            type: ELIMINAR_FILTRO_MARCA\n          });\n        }\n\n        break;\n\n      case 'buscador':\n        dispatch({\n          type: ELIMINAR_FILTRO_BUSCADOR\n        });\n        break;\n\n      case 'orden':\n        dispatch({\n          type: ELIMINAR_FILTRO_ORDEN\n        });\n        break;\n\n      default:\n        break;\n    }\n  };\n};\nexport var restablecerFiltros = function restablecerFiltros() {\n  return function (dispatch) {\n    dispatch({\n      type: PRODUCTOS_RESTABLECER_FILTROS\n    });\n  };\n};\nexport var updatePaginacion = function updatePaginacion() {\n  return function (dispatch, getState) {\n    var paginacion = getState().productosReducer.paginacion;\n    var desdeUpdated = isMobile() ? paginacion.desde + paginacion.limiteMobile : paginacion.desde + paginacion.limiteDesktop;\n    dispatch({\n      type: PRODUCTOS_PAGINACION,\n      payload: desdeUpdated\n    });\n  };\n};","map":null,"metadata":{},"sourceType":"module"}