{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[21],{BsWD:function(e,t,r){\"use strict\";r.d(t,\"a\",(function(){return n}));var a=r(\"a3WO\");function n(e,t){if(e){if(\"string\"===typeof e)return Object(a.a)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(a.a)(e,t):void 0}}},a3WO:function(e,t,r){\"use strict\";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}r.d(t,\"a\",(function(){return a}))},aQxn:function(e,t,r){\"use strict\";r.r(t);var a=r(\"o0o1\"),n=r.n(a),o=r(\"HaE+\"),c=r(\"MX0m\"),i=r.n(c),u=r(\"q1tI\"),s=r.n(u),d=r(\"k2JI\"),l=r(\"XOuL\"),p=r(\"/MKj\"),f=r(\"nhAV\"),m=r(\"pzYh\"),v=r(\"rOcY\"),g=r(\"t0wy\"),b=s.a.createElement,w=r(\"PSD3\"),h=function(e){return function(){var t=Object(o.a)(n.a.mark((function t(r){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r({type:m.c}),t.prev=1,e){t.next=4;break}return t.abrupt(\"return\",r({type:m.a,payload:\"Sin datos de env\\xedo\"}));case 4:r({type:m.b,payload:e}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),r({type:m.a,payload:t.t0.message});case 10:case\"end\":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()},x=f.traerProductos,y=function(e){var t=Object(u.useState)(!1),r=t[0],a=t[1],c=Object(u.useState)(!1),p=c[0];c[1];Object(u.useEffect)((function(){f()}),[e.usuarioReducer]);var f=function(){var t=Object(o.a)(n.a.mark((function t(){var r,a,o,c,i,u,s,d,l,p,f,v,g,b,w,h,x;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=JSON.parse(localStorage.getItem(\"dataEnvio\")),e.enviosGuardar(r),e.carritoTraerProductos(),!(e.usuarioReducer.logueado&&e.carritoReducer.productos.length>0&&e.enviosReducer.data)){t.next=13;break}return a=e.usuarioReducer.usuario.idUsuario,o=e.carritoReducer,c=o.subtotal,i=o.porcentaje_descuento,u=o.descuento,s=o.total,d=o.productos,l=o.idMedioPago,p=e.enviosReducer.data,f=p.zona,v=p.tipo,g=new Date,b=g.getMonth()<10?\"0\".concat(g.getMonth()+1):\"\".concat(g.getMonth()),w=g.getDate()<10?\"0\".concat(g.getDate()):\"\".concat(g.getDate()),h=\"\".concat(g.getFullYear(),\"-\").concat(b,\"-\").concat(w),x={envio:{idZona:f,tipo:v},venta:{subtotal:c,porcentaje_descuento:i,descuento:u,total:s,idUsuario:a,productos:d,fecha:h,operacion_id:e.collection_id||null,idMedioPago:l}},t.abrupt(\"return\",m(x));case 13:case\"end\":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=function(){var t=Object(o.a)(n.a.mark((function t(r){var o,c;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(o=new Headers).append(\"token\",e.usuarioReducer.usuario.token),o.append(\"Content-Type\",\"application/json\"),c=r.venta.operacion_id?\"\".concat(v.a,\"/registrarVenta?mercadoPago=true\"):\"\".concat(v.a,\"/registrarVenta?mercadoPago=false\"),t.next=7,fetch(c,{headers:o,method:\"POST\",body:JSON.stringify(r)});case 7:200==t.sent.status?(localStorage.removeItem(\"dataEnvio\"),localStorage.removeItem(\"carrito\"),w.fire(\"Listo\",\"Felicidades, tu compra se registr\\xf3 con \\xe9xito. En breve nos comunicaremos con usted para informarle el estado de su compra v\\xeda email.\",\"success\").then((function(){return window.location.assign(\"/\")}))):a(!0),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),a(t.t0.message);case 14:case\"end\":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}();return b(s.a.Fragment,null,b(d.a,{title:\"Finalizacion de compra\",metadesc:\"\"}),b(\"div\",{className:\"jsx-2063553454 wrapper\"},e.enviosReducer.error||e.carritoReducer.error||r?b(g.a,{message:\"Ha ocurrido un error, intentalo mas tarde\"}):b(s.a.Fragment,null,p?b(\"div\",{className:\"jsx-2063553454 alert alert-success\"},p):b(s.a.Fragment,null,b(l.a,null),b(\"p\",{className:\"jsx-2063553454\"},\"Su compra esta siento procesada, aguarde unos segundos...\")))),b(i.a,{id:\"2063553454\"},[\".wrapper.jsx-2063553454{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:90vh;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\"]))};y.getInitialProps=function(){var e=Object(o.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.query,a=r.collection_id,e.abrupt(\"return\",{collection_id:a});case 3:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var j={enviosGuardar:h,carritoTraerProductos:x};t.default=Object(p.b)((function(e){return{carritoReducer:e.carritoReducer,enviosReducer:e.enviosReducer,usuarioReducer:e.usuarioReducer}}),j)(y)},pg2c:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/procesarVenta/[[...params]]\",function(){return r(\"aQxn\")}])},pzYh:function(e,t,r){\"use strict\";r.d(t,\"c\",(function(){return a})),r.d(t,\"a\",(function(){return n})),r.d(t,\"b\",(function(){return o}));var a=\"envios_loading\",n=\"envios_error\",o=\"envios_guardar\"},t0wy:function(e,t,r){\"use strict\";var a=r(\"q1tI\"),n=r.n(a).a.createElement;t.a=function(e){var t=e.message;return n(\"div\",{className:\"alert alert-warning text-center\"},t)}}},[[\"pg2c\",1,2,0,3,12]]]);","extractedComments":[]}