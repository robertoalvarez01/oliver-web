{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[20],{BsWD:function(t,e,r){\"use strict\";r.d(e,\"a\",(function(){return a}));var n=r(\"a3WO\");function a(t,e){if(t){if(\"string\"===typeof t)return Object(n.a)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===r&&t.constructor&&(r=t.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(t):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n.a)(t,e):void 0}}},KQm4:function(t,e,r){\"use strict\";r.d(e,\"a\",(function(){return o}));var n=r(\"a3WO\");var a=r(\"BsWD\");function o(t){return function(t){if(Array.isArray(t))return Object(n.a)(t)}(t)||function(t){if(\"undefined\"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(a.a)(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}},a3WO:function(t,e,r){\"use strict\";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.d(e,\"a\",(function(){return n}))},aQxn:function(t,e,r){\"use strict\";r.r(e);var n=r(\"o0o1\"),a=r.n(n),o=r(\"HaE+\"),c=r(\"MX0m\"),u=r.n(c),i=r(\"q1tI\"),s=r.n(i),d=r(\"k2JI\"),l=r(\"XOuL\"),p=r(\"/MKj\"),f=r(\"nhAV\"),m=r(\"pzYh\"),g=r(\"rOcY\"),v=r(\"t0wy\"),b=s.a.createElement,y=function(t){return function(){var e=Object(o.a)(a.a.mark((function e(r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r({type:m.c}),e.prev=1,t){e.next=4;break}return e.abrupt(\"return\",r({type:m.a,payload:\"Sin datos de env\\xedo\"}));case 4:r({type:m.b,payload:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),r({type:m.a,payload:e.t0.message});case 10:case\"end\":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},h=f.traerProductos,w=function(t){var e=Object(i.useState)(!1),r=e[0],n=e[1],c=Object(i.useState)(!1),p=c[0],f=c[1];Object(i.useEffect)((function(){m()}),[t.usuarioReducer]);var m=function(){var e=Object(o.a)(a.a.mark((function e(){var r,n,o,c,u,i,s,d,l,p,f,m,g,v,b,h,w;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(localStorage.getItem(\"dataEnvio\")),t.enviosGuardar(r),t.carritoTraerProductos(),!(t.usuarioReducer.logueado&&t.carritoReducer.productos.length>0&&t.enviosReducer.data)){e.next=13;break}return n=t.usuarioReducer.usuario.idUsuario,o=t.carritoReducer,c=o.subtotal,u=o.porcentaje_descuento,i=o.descuento,s=o.total,d=o.productos,l=o.idMedioPago,p=t.enviosReducer.data,f=p.zona,m=p.tipo,g=new Date,v=g.getMonth()<10?\"0\".concat(g.getMonth()+1):\"\".concat(g.getMonth()),b=g.getDate()<10?\"0\".concat(g.getDate()):\"\".concat(g.getDate()),h=\"\".concat(g.getFullYear(),\"-\").concat(v,\"-\").concat(b),w={envio:{idZona:f,tipo:m},venta:{subtotal:c,porcentaje_descuento:u,descuento:i,total:s,idUsuario:n,productos:d,fecha:h,operacion_id:t.collection_id||null,idMedioPago:l}},e.abrupt(\"return\",y(w));case 13:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(o.a)(a.a.mark((function e(r){var o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(o=new Headers).append(\"token\",t.usuarioReducer.usuario.token),o.append(\"Content-Type\",\"application/json\"),c=r.venta.operacion_id?\"\".concat(g.a,\"/registrarVenta?mercadoPago=true\"):\"\".concat(g.a,\"/registrarVenta?mercadoPago=false\"),e.next=7,fetch(c,{headers:o,method:\"POST\",body:JSON.stringify(r)});case 7:200==e.sent.status?(localStorage.removeItem(\"dataEnvio\"),localStorage.removeItem(\"carrito\"),f(\"Felicidades, Tu venta se registr\\xf3 con \\xe9xito. En breve nos comunicaremos con usted para informarle el estado de su compra.\"),setTimeout((function(){window.location.assign(\"/\")}),5e3)):n(!0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),n(e.t0.message);case 14:case\"end\":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return b(s.a.Fragment,null,b(d.a,{title:\"Finalizacion de compra\",metadesc:\"\"}),b(\"div\",{className:\"jsx-2063553454 wrapper\"},!t.usuarioReducer.logueado||t.enviosReducer.error||t.carritoReducer.error||r?b(v.a,{message:\"Ha ocurrido un error, intentalo mas tarde\"}):b(s.a.Fragment,null,p?b(\"div\",{className:\"jsx-2063553454 alert alert-success\"},p):b(s.a.Fragment,null,b(l.a,null),b(\"p\",{className:\"jsx-2063553454\"},\"Su compra esta siento procesada, aguarde unos segundos...\")))),b(u.a,{id:\"2063553454\"},[\".wrapper.jsx-2063553454{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:90vh;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\"]))};w.getInitialProps=function(){var t=Object(o.a)(a.a.mark((function t(e){var r,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.query,n=r.collection_id,t.abrupt(\"return\",{collection_id:n});case 3:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var _={enviosGuardar:y,carritoTraerProductos:h};e.default=Object(p.b)((function(t){return{carritoReducer:t.carritoReducer,enviosReducer:t.enviosReducer,usuarioReducer:t.usuarioReducer}}),_)(w)},k2JI:function(t,e,r){\"use strict\";var n=r(\"q1tI\"),a=r.n(n),o=r(\"8Kt/\"),c=r.n(o),u=r(\"rOcY\"),i=a.a.createElement;e.a=function(t){var e=t.title,r=t.metadesc;return i(c.a,null,i(\"title\",null,e),i(\"meta\",{name:\"theme-color\",content:\"#df8f0e\"}),i(\"link\",{rel:\"icon\",href:\"\".concat(u.d,\"/static/Perro.png\")}),r?i(\"meta\",{name:\"description\",content:r}):null)}},kqUl:function(t,e,r){\"use strict\";r.d(e,\"f\",(function(){return n})),r.d(e,\"a\",(function(){return a})),r.d(e,\"c\",(function(){return o})),r.d(e,\"e\",(function(){return c})),r.d(e,\"d\",(function(){return u})),r.d(e,\"b\",(function(){return i}));var n=\"carrito_traer_todos_carrito\",a=\"carrito_agregar_producto\",o=\"carrito_eliminar_producto\",c=\"carrito_loading\",u=\"carrito_error\",i=\"carrito_cambiar_medio_de_pago\"},nhAV:function(t,e,r){\"use strict\";r.r(e),r.d(e,\"traerProductos\",(function(){return i})),r.d(e,\"agregarProducto\",(function(){return s})),r.d(e,\"eliminarProducto\",(function(){return d})),r.d(e,\"cambiarMedioDePago\",(function(){return l}));var n=r(\"KQm4\"),a=r(\"o0o1\"),o=r.n(a),c=r(\"HaE+\"),u=r(\"kqUl\"),i=function(){return function(){var t=Object(c.a)(o.a.mark((function t(e){var r,n,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e({type:u.e}),t.prev=1,t.next=4,JSON.parse(localStorage.getItem(\"carrito\"));case 4:return r=t.sent,n=0,r.forEach((function(t){n+=parseInt(t.precioUnidad*t.cantidad)})),a={productos:r,subtotal:n},t.abrupt(\"return\",e({type:u.f,payload:a}));case 11:return t.prev=11,t.t0=t.catch(1),t.abrupt(\"return\",e({type:u.d,payload:t.t0}));case 14:case\"end\":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()},s=function(t){return function(){var e=Object(c.a)(o.a.mark((function e(r,a){var c,i,s,d,l,p,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r({type:u.e});try{c=a().carritoReducer.productos,(s=c.filter((function(e){return e.idSubProducto==t.idSubProducto}))).length>0?(s[0].cantidad=s[0].cantidad+t.cantidad,d=c.filter((function(t){return t.idSubProducto!=s[0].idSubProducto})),i=d.length>0?[].concat(Object(n.a)(d),[s[0]]):[s[0]]):i=[].concat(Object(n.a)(c),[t]),localStorage.setItem(\"carrito\",JSON.stringify(i)),l=JSON.parse(localStorage.getItem(\"carrito\")),p=0,l.forEach((function(t){p+=parseInt(t.precioUnidad*t.cantidad)})),f={listProductosUpgrade:i,subtotal:p},setTimeout((function(){r({type:u.a,payload:f})}),1500)}catch(o){r({type:u.d,payload:o})}case 2:case\"end\":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},d=function(t){return function(){var e=Object(c.a)(o.a.mark((function e(r,n){var a,c,i,s,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r({type:u.e});try{a=n().carritoReducer.productos,c=a.filter((function(e){return e.idSubProducto!==t})),localStorage.setItem(\"carrito\",JSON.stringify(c)),i=JSON.parse(localStorage.getItem(\"carrito\")),s=0,i.forEach((function(t){s+=parseInt(t.precioUnidad*t.cantidad)})),d={newProductos:c,subtotal:s},r({type:u.c,payload:d})}catch(o){r({type:u.d,payload:o})}case 2:case\"end\":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},l=function(t){return function(e){return e({type:u.b,payload:t})}}},pg2c:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/procesarVenta/[[...params]]\",function(){return r(\"aQxn\")}])},pzYh:function(t,e,r){\"use strict\";r.d(e,\"c\",(function(){return n})),r.d(e,\"a\",(function(){return a})),r.d(e,\"b\",(function(){return o}));var n=\"envios_loading\",a=\"envios_error\",o=\"envios_guardar\"},t0wy:function(t,e,r){\"use strict\";var n=r(\"q1tI\"),a=r.n(n).a.createElement;e.a=function(t){var e=t.message;return a(\"div\",{className:\"alert alert-warning text-center\"},e)}}},[[\"pg2c\",1,2,0,3]]]);","extractedComments":[]}